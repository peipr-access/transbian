Manuel d'installation pour la distribution Debian GNU/Linux

Copyright © 2004 - 2021 L'équipe de l'installateur Debian

Ce manuel est un logiciel libre ; vous pouvez le distribuer ou le modifier
selon les termes de la Licence publique générale GNU. Veuillez consulter la
licence à l'Annexe F, GNU General Public License.

Numéro de version de ce manuel : 20220129~deb11u1.

Résumé

Ce document contient les instructions d'installation du système Debian GNU/
Linux (nommé « bullseye »), sur l'architecture PC 64 bits (« amd64 »). Des
pointeurs vers d'autres sources d'informations vous permettront de tirer le
meilleur parti de votre nouveau système Debian.

Toutes les remarques sur cette traduction sont à envoyer à l'adresse <
debian-l10n-french@lists.debian.org>. La traduction de la « GNU GPL » est celle
qu'on trouve sur le site de la FSF France.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Table des matières

Installer Debian GNU/Linux 11 sur amd64
1. Bienvenue sur Debian

    1.1. Qu'est-ce que Debian ?
    1.2. Qu'est-ce que GNU/Linux ?
    1.3. Qu'est-ce que Debian GNU/Linux ?
    1.4. Qu'est-ce que l'installateur Debian ?
    1.5. Comment obtenir Debian ?
    1.6. Comment obtenir la plus récente version de ce document ?
    1.7. Organisation de ce document
    1.8. À propos des copyrights et des licences des logiciels

2. Configuration nécessaire

    2.1. Matériel reconnu

        2.1.1. Architectures reconnues
        2.1.2. Microprocesseurs
        2.1.3. Portables
        2.1.4. Processeurs multiples
        2.1.5. Gestion du matériel graphique
        2.1.6. Matériel de connexion réseau
        2.1.7. Les plages Braille
        2.1.8. Synthèse vocale matérielle
        2.1.9. Périphériques et autres matériels

    2.2. Périphériques demandant des microprogrammes (firmware)
    2.3. Acheter du matériel spécialement pour GNU/Linux

        2.3.1. Éviter le matériel propriétaire ou fermé

    2.4. Les supports d'installation

        2.4.1. CD-ROM/DVD-ROM/BD-ROM
        2.4.2. Les clés USB
        2.4.3. Le réseau
        2.4.4. Les disques durs
        2.4.5. Un*x ou système GNU
        2.4.6. Systèmes de stockage reconnus

    2.5. Mémoire et espace disque nécessaires

3. Avant d'installer Debian GNU/Linux

    3.1. Vue générale du processus d'installation
    3.2. Sauvegardez vos données !
    3.3. Informations utiles

        3.3.1. La documentation
        3.3.2. Comment trouver les sources d'informations sur le matériel ?
        3.3.3. Compatibilité matérielle
        3.3.4. Configuration du réseau

    3.4. Matériel minimum
    3.5. Partitionnement préalable d'une machine multisystème
    3.6. Configuration matérielle et système avant l'installation

        3.6.1. Le menu de configuration du BIOS ou de l'UEFI
        3.6.2. Sélection du périphérique d'amorçage
        3.6.3. Systèmes avec un microprogramme UEFI
        3.6.4. Démarrage sécurisé
        3.6.5. Désactiver le démarrage rapide de Windows (« fast boot » ou « 
            fast startup »)
        3.6.6. Problèmes matériels à surveiller

4. Comment obtenir les supports du système d'installation ?

    4.1. images d'installation Debian GNU/Linux officielles
    4.2. Télécharger les fichiers depuis les miroirs Debian

        4.2.1. Où trouver les fichiers d'installation ?

    4.3. Préparation des fichiers pour un amorçage avec une clé USB

        4.3.1. Préparation d'une clé USB utilisant une image hybride de CD ou
            DVD
        4.3.2. Copie des fichiers -- méthode simple
        4.3.3. Copie des fichiers -- méthode détaillée

    4.4. Préparer les fichiers pour amorcer depuis un disque dur

        4.4.1. Démarrage du programme d'installation depuis Linux avec GRUB
        4.4.2. Démarrage du programme d'installation depuis DOS avec loadlin

    4.5. Préparer les fichiers pour amorcer depuis le réseau avec TFTP

        4.5.1. Configurer un serveur DHCP
        4.5.2. Configurer un serveur BOOTP
        4.5.3. Activer le serveur TFTP
        4.5.4. Mettre les images TFTP en place

    4.6. Installation automatisée

        4.6.1. Installation automatisée avec l'installateur Debian

    4.7. Vérifier l'authenticité des fichiers d'installation

5. Démarrer le système d'installation

    5.1. Démarrer l'installateur sur PC 64 bits

        5.1.1. Amorcer sur une clé USB
        5.1.2. Amorcer depuis un disque optique (CD ou DVD)
        5.1.3. Amorcer depuis Windows
        5.1.4. Amorcer depuis DOS avec loadlin
        5.1.5. Amorcer à partir de Linux avec GRUB
        5.1.6. Amorcer avec TFTP
        5.1.7. L'écran d'amorçage
        5.1.8. L'installateur graphique

    5.2. Accessibilité

        5.2.1. Frontaux de l'installateur
        5.2.2. Les plages Braille USB
        5.2.3. Les plages Braille série
        5.2.4. Synthèse vocale logicielle
        5.2.5. Synthèse vocale matérielle
        5.2.6. Cartes fille
        5.2.7. Thème à fort contraste
        5.2.8. Zoom
        5.2.9. Modes d'installation Expert, Rescue et Automated
        5.2.10. Accessibilité du système installé

    5.3. Paramètres d'amorçage

        5.3.1. Console d'amorçage
        5.3.2. Paramètres pour l'installateur Debian
        5.3.3. Répondre à des questions avec les paramètres d'amorçage
        5.3.4. Passer des paramètres aux modules du noyau
        5.3.5. Interdire des modules du noyau

    5.4. Dysfonctionnements pendant la procédure d'installation

        5.4.1. Fiabilité des disques optiques
        5.4.2. Configuration d'amorçage
        5.4.3. Synthèse vocale logicielle
        5.4.4. Problèmes communs sur PC 64 bits
        5.4.5. Comprendre les messages du noyau au démarrage
        5.4.6. Signaler les problèmes
        5.4.7. Faire un rapport de bogue

6. Comment utiliser l'installateur Debian ?

    6.1. Comment fonctionne l'installateur ?

        6.1.1. Utilisation de l'installateur graphique

    6.2. Introduction aux composants
    6.3. Utilisation des composants

        6.3.1. L'installateur Debian et la configuration du matériel
        6.3.2. Création des utilisateurs et des mots de passe
        6.3.3. Configuration de l'horloge et du fuseau horaire
        6.3.4. Partitionnement et points de montage
        6.3.5. L'installation du système de base
        6.3.6. Installation de logiciels supplémentaires
        6.3.7. Rendre le système amorçable
        6.3.8. La fin de l'installation
        6.3.9. Dépannage
        6.3.10. Installation par le réseau avec network-console

    6.4. Télécharger des microprogrammes (firmware) manquants

        6.4.1. Préparer le support
        6.4.2. Microprogrammes et système installé
        6.4.3. Finaliser le système installé

    6.5. Personnalisation

        6.5.1. Installer un système d'initialisation alternatif

7. Démarrer votre nouveau système Debian

    7.1. Le moment de vérité
    7.2. Le montage des volumes chiffrés

        7.2.1. En cas de problèmes

    7.3. Se connecter

8. Les prochaines étapes

    8.1. Arrêter le système
    8.2. S'orienter dans Debian

        8.2.1. Le système des paquets
        8.2.2. Autres logiciels disponibles
        8.2.3. Gestion des versions des applications
        8.2.4. Gestion des tâches récurrentes

    8.3. Pour aller plus loin
    8.4. Configurer le courrier électronique

        8.4.1. Configuration par défaut
        8.4.2. Envoyer des courriels vers l'extérieur
        8.4.3. Configuration de Exim4

    8.5. Compiler un nouveau noyau
    8.6. Réparer un système cassé

A. Guide de l'installation

    A.1. Préliminaires
    A.2. Démarrer l'installateur

        A.2.1. Disque optique
        A.2.2. Clés USB
        A.2.3. Amorcer depuis le réseau
        A.2.4. Amorcer depuis un disque dur

    A.3. Installation
    A.4. Envoyez-nous un rapport d'installation
    A.5. Et ils eurent...

B. Automatisation de l'installation par préconfiguration

    B.1. Introduction

        B.1.1. Les méthodes
        B.1.2. Limitations

    B.2. Utiliser la préconfiguration

        B.2.1. Charger le fichier de préconfiguration
        B.2.2. Utiliser les paramètres d'amorçage pour préconfigurer des
            questions
        B.2.3. Le mode auto
        B.2.4. Alias utiles avec la préconfiguration
        B.2.5. Exemples de préconfiguration de l'invite d'amorçage
        B.2.6. Utiliser un serveur DHCP pour indiquer les fichiers de
            préconfiguration

    B.3. Créer un fichier de préconfiguration
    B.4. Contenu du fichier de préconfiguration (pour bullseye)

        B.4.1. Localisation
        B.4.2. Configuration du réseau
        B.4.3. Console réseau
        B.4.4. Valeurs pour les miroirs
        B.4.5. Configuration des comptes
        B.4.6. Configuration du fuseau horaire
        B.4.7. Partitionnement
        B.4.8. Installation du système de base
        B.4.9. Configuration d'Apt
        B.4.10. Choix des paquets
        B.4.11. Installation du programme d'amorçage
        B.4.12. Pour terminer l'installation
        B.4.13. Les autres questions

    B.5. Options complexes

        B.5.1. Exécuter des commandes pendant l'installation
        B.5.2. Changer les valeurs par défaut avec la préconfiguration
        B.5.3. Chaîner les fichiers de préconfiguration

C. Partitionnement pour Debian

    C.1. Décider des partitions et de leurs tailles
    C.2. L'arborescence des fichiers
    C.3. Schéma de partitionnement recommandé
    C.4. Noms des périphériques sous Linux
    C.5. Programmes de partitionnement

        C.5.1. Partitionnement pour PC 64 bits

D. Informations diverses

    D.1. Périphériques Linux

        D.1.1. Régler la souris

    D.2. Espace disque nécessaire pour les tâches
    D.3. Installer Debian GNU/Linux à partir d'un système Unix/Linux

        D.3.1. Pour commencer
        D.3.2. Installer debootstrap
        D.3.3. Lancer debootstrap
        D.3.4. Configurer le système de base
        D.3.5. Installer un noyau
        D.3.6. Configurer le programme d'amorçage
        D.3.7. Accès distant : installer SSH et configurer l'accès
        D.3.8. Touches finales

    D.4. Installer Debian GNU/Linux grâce au protocole PLIP (IP sur port
        parallèle)

        D.4.1. Prérequis
        D.4.2. Configuration du système source
        D.4.3. Installation du système cible

    D.5. Installer Debian GNU/Linux avec PPP sur Ethernet (PPPoE)

E. Administrivia

    E.1. À propos de ce document
    E.2. Pour contribuer à ce document
    E.3. Principales contributions
    E.4. Marques déposées

F. GNU General Public License

Liste des tableaux

3.1. Informations sur le matériel utiles pour l'installation
3.2. Configuration matérielle minimale recommandée

Installer Debian GNU/Linux 11 sur amd64

Nous sommes enchantés que vous ayez choisi Debian. Nous sommes sûrs que vous
trouverez cette distribution GNU/Linux de Debian remarquable. Debian GNU/Linux
rassemble des logiciels libres de qualité, faits par des gens disséminés aux
quatre coins du monde, et les intègre en un tout cohérent. Nous croyons que
vous trouverez cet ensemble réellement supérieur à la simple somme de ses
parties.

Nous comprenons bien que beaucoup d'entre vous voudront installer Debian sans
lire ce manuel ; la conception de l'installateur le permet. Si vous n'avez pas
le temps de le lire en entier, nous vous recommandons de lire le Guide de
l'installation. Ce guide vous présentera les bases du processus d'installation
et renverra au manuel pour les sujets complexes ou pour des aides en cas de
problèmes. Le guide de l'installation se trouve à l'Annexe A, Guide de
l'installation.

Cela dit, nous espérons que vous aurez le temps de lire la plus grande partie
de ce manuel. Votre installation sera facilitée par la connaissance acquise.

Chapitre 1. Bienvenue sur Debian

Table des matières

1.1. Qu'est-ce que Debian ?
1.2. Qu'est-ce que GNU/Linux ?
1.3. Qu'est-ce que Debian GNU/Linux ?
1.4. Qu'est-ce que l'installateur Debian ?
1.5. Comment obtenir Debian ?
1.6. Comment obtenir la plus récente version de ce document ?
1.7. Organisation de ce document
1.8. À propos des copyrights et des licences des logiciels

Ce chapitre propose un survol du projet Debian GNU/Linux. Si vous connaissez
déjà l'histoire du projet Debian et de la distribution Debian GNU/Linux, vous
pouvez passer au chapitre suivant.

1.1. Qu'est-ce que Debian ?

Debian est une organisation composée uniquement de bénévoles, dont le but est
de développer le logiciel libre et de promouvoir les idéaux de la communauté du
logiciel libre. Le projet Debian a démarré en 1993, quand Ian Murdock invita
tous les développeurs de logiciels à participer à la création d'une
distribution logicielle, complète et cohérente, basée sur le nouveau noyau
Linux. Ce petit groupe d'enthousiastes, d'abord subventionné par la Free
Software Foundation, et influencé par la philosophie GNU, a grandi pour devenir
une organisation composée par environ 1000 développeurs Debian.

Les développeurs Debian s'impliquent dans de multiples activités, par exemple,
l'administration des sites web et FTP, la conception graphique, l'analyse
juridique des licences logicielles, l'écriture de la documentation et, bien
sûr, la maintenance des paquets logiciels.

Pour communiquer notre philosophie et attirer des développeurs qui adhèrent à
nos principes, le projet Debian a publié un certain nombre de documents qui
mettent en évidence nos valeurs et expliquent ce que signifie être un
développeur Debian :

  • Le contrat social Debian est la déclaration des engagements de Debian
    vis-à-vis de la communauté du logiciel libre. Quiconque est d'accord pour
    se conformer à ce contrat social peut devenir un développeur Debian. Tout
    développeur Debian peut introduire de nouveaux logiciels dans Debian, à
    condition que ces paquets se conforment à nos critères de liberté et
    répondent à nos critères de qualité ;

  • Les directives Debian pour le logiciel libre (Debian Free Software
    Guidelines, ou DFSG) sont une déclaration claire et concise des critères
    Debian en matière de logiciel libre. Ce document a une grande influence sur
    le mouvement pour le logiciel libre ; il est à la base de la définition de
    l'Open Source ;

  • La charte Debian est une spécification détaillée des standards de qualité
    du projet Debian.

Les développeurs Debian participent aussi à d'autres projets : certains sont
spécifiques à Debian, d'autres concernent tout ou partie de la communauté
Linux. Voici quelques exemples :

  • Le standard pour l'organisation des systèmes de fichiers (FHS) est un
    effort pour standardiser l'organisation du système de fichiers Linux. Le
    FHS permettra aux développeurs de logiciels de se concentrer sur la
    conception de programmes, sans avoir à se préoccuper de la façon dont le
    paquet sera installé dans les différentes distributions GNU/Linux ;

  • Debian Jr. est un projet interne dont le but est de s'assurer que Debian a
    quelque chose à offrir à nos utilisateurs les plus jeunes.

Pour des informations plus générales sur Debian, voir la FAQ Debian.

1.2. Qu'est-ce que GNU/Linux ?

GNU/Linux est un système d'exploitation, c'est-à-dire, un ensemble de
programmes qui permet d'agir sur la machine et de lancer d'autres programmes.

Un système d'exploitation comprend les programmes fondamentaux dont votre
ordinateur a besoin pour échanger des instructions avec les utilisateurs : lire
et écrire des données sur disque dur, sur bandes ou vers des imprimantes,
contrôler l'utilisation de la mémoire, faire tourner d'autres programmes, etc.
La partie la plus importante d'un système d'exploitation est le noyau. Dans un
système GNU/Linux, c'est le noyau Linux. Le reste du système comprend d'autres
programmes, dont beaucoup ont été écrits par, ou pour, le projet GNU. Comme le
noyau Linux seul ne forme pas un système d'exploitation fonctionnel, nous
préférons, pour nous référer au système que beaucoup de gens appellent de façon
insouciante « Linux », utiliser le terme « GNU/Linux ».

GNU/Linux est fondé sur le système d'exploitation Unix. Dès le début, il fut
conçu comme un système multitâche et multiutilisateur. Ces caractéristiques
suffisent à distinguer GNU/Linux d'autres systèmes bien connus. Cependant, GNU/
Linux est encore plus différent que vous ne pouvez l'imaginer. Personne ne
possède GNU/Linux, contrairement à d'autres systèmes. L'essentiel de son
développement est fait par des volontaires non payés.

Le développement de ce qui fut appelé plus tard GNU/Linux commença en 1984,
quand la « Free Software Foundation » entreprit le développement d'un système
libre de type Unix, appelé GNU.

Le projet GNU a développé un ensemble complet d'outils libres destinés à Unix
(tm) et aux systèmes d'exploitation de type Unix, tel que GNU/Linux. Ces outils
permettent aux utilisateurs d'accomplir aussi bien les tâches les plus simples
(copier ou effacer un fichier) que les plus complexes (écrire et compiler des
programmes, éditer de façon sophistiquée dans un grand nombre de formats).

Beaucoup de groupes et d'individus ont contribué à GNU/Linux mais le plus
important d'entre eux est la « Free Software Foundation » qui a non seulement
créé la plupart des outils utilisés par GNU/Linux mais aussi la philosophie et
la communauté qui ont rendu GNU/Linux possible.

Le noyau Linux est apparu pour la première fois en 1991, quand un étudiant en
informatique finlandais du nom de Linus Torvalds annonça une version de
remplacement du noyau Minix dans le groupe de discussion Usenet comp.os.minix.
Consultez la page d'histoire de Linux sur Linux International.

Linus Torvalds continue à coordonner le travail de centaines de développeurs,
aidé par des responsables de sous-systèmes. Il existe un site officiel pour le
noyau Linux. Des informations sur la liste de diffusion linux-kernel se
trouvent sur la FAQ de la liste de diffusion de linux-kernel.

Les utilisateurs de GNU/Linux n'ont que l'embarras du choix pour les logiciels.
Ils peuvent par exemple hésiter entre une douzaine d'interpréteurs de
commandes, plusieurs interfaces graphiques. Cette possibilité de choix étonne
souvent les utilisateurs d'autres systèmes d'exploitation, qui ne sont pas
habitués à penser qu'ils peuvent changer leur interpréteur de commandes ou leur
interface graphique.

GNU/Linux « plante » moins, peut plus facilement exécuter plus d'un programme à
la fois, est plus sûr que beaucoup de systèmes d'exploitation. Ces avantages
font de Linux le système d'exploitation dont la demande a la plus forte
croissance sur le marché des serveurs. Plus récemment, Linux a aussi commencé à
gagner en popularité parmi les utilisateurs, qu'ils soient en entreprise ou
chez eux.

1.3. Qu'est-ce que Debian GNU/Linux ?

La philosophie et la méthodologie Debian combinées avec les outils GNU, le
noyau Linux et certains logiciels libres importants, forment une distribution
logicielle unique appelée Debian GNU/Linux. Cette distribution est faite d'un
grand nombre de paquets logiciels. Chaque paquet de la distribution contient
des exécutables, des scripts, de la documentation, des informations de
configuration ; il possède un responsable dont la principale charge est de
tenir le paquet à jour, de suivre les rapports de bogues et de rester en
communication avec les auteurs amont du paquet. Grâce à notre très grande base
d'utilisateurs et à notre système de suivi des bogues, les problèmes sont
détectés et résolus très rapidement.

Le souci du détail nous permet de donner une distribution paramétrable, stable
et de grande qualité. On peut facilement programmer le système d'installation
pour qu'il installe aussi bien un simple pare-feu qu'un poste de travail
scientifique ou un serveur réseau.

Debian est particulièrement appréciée des utilisateurs avertis pour son
excellence technique et pour son souci constant des besoins et des attentes de
la communauté Linux. Ainsi Debian a inventé beaucoup de fonctionnalités qui
sont maintenant des standards sous Linux.

Par exemple, Debian fut la première distribution Linux à proposer un système de
gestion des paquets qui facilitait l'installation et la suppression des
logiciels. De même, ce fut la première distribution qu'on pouvait mettre à jour
sans avoir besoin d'une réinstallation.

Debian continue d'animer le développement de Linux. Son modèle de développement
est exemplaire de l'excellence du modèle Open source, jusque dans les tâches
très complexes de construction et de maintenance d'un système d'exploitation
complet.

La fonctionnalité qui distingue le plus Debian des autres distributions Linux
est son système de gestion des paquets. Ces outils donnent à l'administrateur
d'un système Debian un contrôle complet sur les paquets installés sur le
système ; c'est, par exemple, la possibilité d'installer un seul paquet ou
celle de mettre à jour l'ensemble du système. Certains paquets peuvent aussi
être protégés contre une mise à jour. Vous pouvez même dire au système quels
paquets vous avez compilés vous-mêmes et quelles dépendances ils nécessitent.

Pour protéger votre système contre les « chevaux de Troie » et les logiciels
malveillants, Debian vérifie que les paquets proviennent de leur responsable
Debian officiel. Ceux-ci prennent un grand soin à configurer les paquets d'une
manière sûre. Si des problèmes de sécurité apparaissent dans les paquets
livrés, des corrections sont en général rapidement disponibles. Grâce à la
possibilité de mise à jour simple, offerte par Debian, vous pouvez récupérer
sur Internet et installer automatiquement les corrections concernant la
sécurité.

La première et la meilleure méthode pour obtenir de l'aide pour votre système
Debian GNU/Linux, et pour communiquer avec les développeurs Debian, est
d'utiliser les nombreuses listes de diffusion gérées par le projet Debian (il y
en a plus de 322 à ce jour). La façon la plus simple de s'abonner à une liste
est de visiter la page d'abonnement aux listes de diffusion Debian et de
compléter le formulaire qui s'y trouve.

1.4. Qu'est-ce que l'installateur Debian ?

L'installateur Debian, aussi appelé « d-i », est le logiciel qui permet
d'installer un système Debian basique et fonctionnel. Une large gamme de
matériel est prise en charge, comme les périphériques embarqués, les
ordinateurs portables, de bureau et les serveurs. Enfin, le système offre un
grand choix de logiciels libres pour diverses applications.

L'installation s'effectue en répondant à une série de questions simples. Un
mode « expert » est disponible, pour contrôler finement chaque détail de
l'installation, et une fonctionnalité avancée permet même de réaliser
l'installation automatiquement. Le système ainsi installé peut être utilisé tel
quel, ou personnalisé par la suite. L'installation peut être réalisée à partir
d'un grand choix de support : clé USB, CD, DVD ou Blu-Ray, ou même par le
réseau. L'installateur est capable d'installer un système localisé (traduit
dans votre langue et avec des paramètres régionaux adaptés), avec un choix de
plus de 80 langues.

L'installateur prend ses origines dans le projet « boot-floppies », et a été
mentionné la première fois par Joey Hess en 2000. Depuis, l'installateur a été
développé en permanence par des volontaires pour l'améliorer et lui ajouter
toujours plus de fonctionnalités.

Pour plus d'information, veuillez consulter la page de l'installateur Debian,
le wiki et la liste de diffusion debian-boot.

1.5. Comment obtenir Debian ?

Pour plus d'informations sur la façon de télécharger Debian GNU/Linux depuis
Internet, ou sur la façon de se procurer les supports d'installation officiels
de Debian, voyez la page web sur les façons d'obtenir Debian. La liste des
miroirs Debian répertorie tous les miroirs officiels Debian.

Après l'installation, Debian peut être facilement mis à jour. La procédure
d'installation vous aidera à configurer le système de façon à ce que vous
puissiez faire ces mises à jour une fois le système installé.

1.6. Comment obtenir la plus récente version de ce document ?

Ce document est continuellement révisé. N'oubliez pas de vérifier les
informations de dernière minute sur la page de la version 11. Des versions à
jour de ce manuel sont également disponibles sur les pages officielles du
manuel d'installation.

1.7. Organisation de ce document

Ce document est destiné aux personnes qui utilisent Debian pour la première
fois. Il tente de faire aussi peu appel que possible à des connaissances
spéciales de la part du lecteur. Cependant, il suppose une compréhension
élémentaire du fonctionnement de son matériel.

Les utilisateurs expérimentés pourront aussi trouver dans ce document des
informations de référence, comme la place minimale nécessaire à une
installation, des précisions au sujet du matériel reconnu par le système
d'installation de Debian, etc. Nous encourageons les utilisateurs expérimentés
à naviguer dans ce document.

Ce document, organisé de façon linéaire, guide l'utilisateur à travers le
processus d'installation. Voici les différentes étapes de l'installation de
Debian GNU/Linux, et les sections de ce document qui s'y rapportent :

 1. Comment déterminer si votre matériel possède la configuration minimale
    nécessaire au système d'installation est expliqué dans le Chapitre 2, 
    Configuration nécessaire ;

 2. Comment faire une sauvegarde de votre système, préparer et configurer le
    matériel avant d'installer Debian, est expliqué dans le Chapitre 3, Avant
    d'installer Debian GNU/Linux. Si vous prévoyez de pouvoir démarrer
    plusieurs systèmes, vous aurez besoin de partitionner votre disque dur ;

 3. Dans le Chapitre 4, Comment obtenir les supports du système
    d'installation ?, vous trouverez les fichiers nécessaires pour la méthode
    d'installation que vous avez choisie ;

 4. Le Chapitre 5, Démarrer le système d'installation décrit comment amorcer le
    système d'installation ; ce chapitre contient aussi des procédures de
    dépannage en cas de problèmes lors du démarrage ;

 5. L'installation réelle est détaillée dans le Chapitre 6, Comment utiliser
    l'installateur Debian ?. Elle comprend le choix d'une langue, la
    configuration des modules pour les pilotes de périphériques, la
    configuration de la connexion réseau -- ainsi, quand on ne fait pas
    l'installation à partir d'un jeu d'images de CD ou DVD, les autres fichiers
    d'installation pourront être récupérés directement sur un serveur Debian
    --, le partitionnement des disques durs, l'installation du système de base
    et la sélection et l'installation des tâches ; certains éléments concernant
    la manière de créer des partitions pour un système Debian sont donnés dans
    l'Annexe C, Partitionnement pour Debian.

 6. Comment amorcer le système de base installé est expliqué dans le
    Chapitre 7, Démarrer votre nouveau système Debian ;

Une fois que vous avez installé votre système, vous pouvez lire le Chapitre 8, 
Les prochaines étapes. Ce chapitre explique où trouver plus d'informations sur
Unix et Debian et comment remplacer votre noyau.

Enfin, vous trouverez des informations sur ce document et sur la manière d'y
contribuer dans l'Annexe E, Administrivia.

1.8. À propos des copyrights et des licences des logiciels

Vous avez probablement lu les licences fournies avec les logiciels
commerciaux : elles disent que vous ne pouvez utiliser qu'une seule copie du
logiciel et sur un seul ordinateur. La licence du système Debian GNU/Linux est
totalement différente. Nous vous encourageons à copier le système Debian GNU/
Linux sur tous les ordinateurs de votre école ou de votre entreprise. Passez-le
à vos amis et aidez-les à l'installer sur leur ordinateur. Vous pouvez même
faire des milliers de copies et les vendre -- avec quelques restrictions
cependant. La distribution Debian est en effet fondée sur le logiciel libre.

Qu'un logiciel soit libre ne veut pas dire qu'il est dépourvu de copyright et
ne signifie pas que les supports d'installation qui contiennent ce logiciel
doivent être distribués gratuitement. Cela signifie d'une part que les licences
des programmes individuels ne vous obligent pas à payer pour avoir le droit
d'utiliser ou de distribuer ces programmes. Et cela signifie d'autre part que
non seulement on peut étendre, adapter ou modifier un programme, mais qu'on
peut aussi distribuer le résultat de ce travail.

Note

Le projet Debian met à disposition beaucoup de paquets qui ne satisfont pas à
nos critères de liberté -- c'est une concession pragmatique à nos utilisateurs.
Ces paquets ne font pas partie de la distribution officielle, et ils sont
distribués dans les parties contrib et non-free des miroirs Debian, ou bien sur
des cédéroms vendus par des tiers ; voyez la FAQ Debian, dans les « archives
FTP Debian », pour plus d'informations sur l'organisation et le contenu des
archives.

Beaucoup de programmes dans le système Debian sont distribués selon les termes
de la licence GNU General Public License, souvent simplement appelée la « GPL »
. La licence GPL oblige à donner le code source du programme lorsque vous
distribuez une copie binaire de ce programme ; cet article assure que tout
utilisateur pourra modifier le programme. Et c'est pourquoi nous avons inclus
le code source ^[1] de tous les programmes présents dans le système Debian.

D'autres formes de copyright et de licence sont utilisées dans le système
Debian. Vous pourrez trouver les copyrights et les licences de chaque programme
dans le répertoire /usr/share/doc/nom-du-paquet/copyright une fois le paquet
installé.

Pour en savoir plus sur les licences et comment Debian décide de ce qui est
suffisamment libre pour être inclus dans la distribution principale, consultez
les Principes du logiciel libre selon Debian.

Légalement, l'avertissement le plus important est que ce logiciel est fourni 
sans aucune garantie. Les programmeurs qui ont créé ce logiciel l'ont fait pour
le bénéfice de la communauté. Il n'est donné aucune garantie quant à la
pertinence du logiciel pour un quelconque usage. Cependant, puisque ce logiciel
est libre, vous pouvez le modifier autant que vous le désirez -- et vous pouvez
ainsi profiter du travail de ceux qui ont amélioré le logiciel.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[1] Pour savoir où trouver et comment décompresser et construire les paquets
source Debian, voyez la FAQ Debian, sous le titre « Les bases du système de
gestion des paquets Debian ».

Chapitre 2. Configuration nécessaire

Table des matières

2.1. Matériel reconnu

    2.1.1. Architectures reconnues
    2.1.2. Microprocesseurs
    2.1.3. Portables
    2.1.4. Processeurs multiples
    2.1.5. Gestion du matériel graphique
    2.1.6. Matériel de connexion réseau
    2.1.7. Les plages Braille
    2.1.8. Synthèse vocale matérielle
    2.1.9. Périphériques et autres matériels

2.2. Périphériques demandant des microprogrammes (firmware)
2.3. Acheter du matériel spécialement pour GNU/Linux

    2.3.1. Éviter le matériel propriétaire ou fermé

2.4. Les supports d'installation

    2.4.1. CD-ROM/DVD-ROM/BD-ROM
    2.4.2. Les clés USB
    2.4.3. Le réseau
    2.4.4. Les disques durs
    2.4.5. Un*x ou système GNU
    2.4.6. Systèmes de stockage reconnus

2.5. Mémoire et espace disque nécessaires

Cette section contient des informations sur le matériel dont vous avez besoin
pour commencer avec Debian. Vous trouverez aussi des liens vers des
informations supplémentaires concernant le matériel reconnu par GNU et Linux.

2.1. Matériel reconnu

En ce qui concerne le matériel, Debian n'a pas plus d'exigences que le noyau
Linux ou kFreeBSD et les outils GNU. Par conséquent, toute architecture ou
plate-forme sur laquelle le noyau Linux ou kFreeBSD, la libc, le compilateur
gcc, etc., ont été portés, et pour laquelle un portage de Debian existe, peut
faire fonctionner Debian. Reportez-vous aux pages sur les portages https://
www.debian.org/ports/amd64/ pour plus de précisions concernant les systèmes
d'architecture PC 64 bits qui ont été testés avec Debian GNU/Linux.

Plutôt que d'essayer de décrire les différentes configurations matérielles
acceptées par PC 64 bits , cette section contient des informations générales et
des liens vers des informations complémentaires.

2.1.1. Architectures reconnues

Debian GNU/Linux 11 fonctionne sur 9 architectures principales et sur de
nombreuses variantes de celles-ci, appelées « saveurs ».

┌───────────────┬─────────┬────────────────────────────────────────┬──────────┐
│ Architecture  │Étiquette│           Sous-Architecture            │  Saveur  │
│               │ Debian  │                                        │          │
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│AMD64 & Intel  │amd64    │                                        │          │
│64             │         │                                        │          │
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│               │         │systèmes x86                            │variante  │
│Intel x86-based│i386     │                                        │par défaut│
│               │         ├────────────────────────────────────────┼──────────┤
│               │         │domaines Xen PV uniquement              │xen       │
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│ARM            │armel    │Marvell Kirkwood et Orion               │marvell   │
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│ARM avec       │armhf    │multiplate-forme                        │armmp     │
│matériel FPU   │         │                                        │          │
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│ARM 64 bits    │arm64    │                                        │          │
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│               │         │MIPS Malta                              │5kc-malta │
│MIPS 64 bits   │         ├────────────────────────────────────────┼──────────┤
│(petit-boutien)│mips64el │Cavium Octeon                           │octeon    │
│               │         ├────────────────────────────────────────┼──────────┤
│               │         │Loongson 3                              │loongson-3│
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│               │         │MIPS Malta                              │4kc-malta │
│MIPS 32 bits   │         ├────────────────────────────────────────┼──────────┤
│(petit-boutien)│mipsel   │Cavium Octeon                           │octeon    │
│               │         ├────────────────────────────────────────┼──────────┤
│               │         │Loongson 3                              │loongson-3│
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│Power Systems  │ppc64el  │Machines IBM POWER8 ou plus récentes    │          │
├───────────────┼─────────┼────────────────────────────────────────┼──────────┤
│IBM S/390      │         │IPL avec lecteur de machine virtuelle   │          │
│64 bits        │s390x    │(VM-reader) et accès direct au          │generic   │
│               │         │périphérique de stockage (DASD)         │          │
└───────────────┴─────────┴────────────────────────────────────────┴──────────┘

Ce document décrit l'installation pour l'architecture PC 64 bits avec le noyau 
Linux. Des versions pour les autres architectures disponibles existent sur les
pages Debian-Ports.

2.1.2. Microprocesseurs

Les processeurs AMD64 et Intel 64 sont reconnus.

2.1.3. Portables

D'un point de vue technique, les ordinateurs portables fonctionnent comme les
autres PC et les informations concernant les PC s'appliquent aussi aux
portables. L'installation de Debian sur un portable se passe très bien. Des
fonctionnalités comme la suspension automatique du système à la fermeture du
couvercle ou la reconnaissance de boutons spécifiques aux portables comme celui
pour désactiver l'interface wifi (mode « airplane ») sont correctement
installées. Cependant quelques constructeurs utilisent du matériel propriétaire
pour certaines fonctions, matériel qui n'est pas toujours reconnu. Pour
vérifier que votre portable fonctionne bien avec GNU/Linux, consultez les pages
sur les portables sous Linux.

2.1.4. Processeurs multiples

Cette architecture accepte les systèmes à plusieurs processeurs (« symmetric
multiprocessing » ou SMP). L'image standard du noyau Debian 11 a été compilée
avec l'option SMP-alternatives. Le noyau détectera si votre système possède
plusieurs processeurs et désactivera automatiquement la gestion SMP sur les
systèmes avec un seul processeur.

À l'origine, sur certains serveurs haut de gamme, un système à multiples
processeurs pouvait provoquer des problèmes. Aujourd'hui, un simple ordinateur
de bureau ou un portable possède plusieurs processeurs sous la forme d'un
processeur multicœur, une puce contenant deux processeurs ou plus, appelés
cœurs.

2.1.5. Gestion du matériel graphique

Debian reconnaît les interfaces graphiques dans la mesure où elles sont
reconnues par le système X11 de X.Org et par le noyau. Le noyau fournit le
tampon vidéo (framebuffer), tandis que les environnements de bureau utilisent
X11. Certaines fonctionnalités avancées des cartes graphiques, comme
l'accélération 3D ou l'accélération matérielle (hardware-accelerated video),
dépendent parfois de la carte graphique installée et demandent l'installation
de microprogrammes supplémentaires, consultez la Section 2.2, « Périphériques
demandant des microprogrammes (firmware) ».

Sur les PC récents, l'affichage graphique fonctionne généralement du premier
coup, et pour un grand nombre de matériels l'accélération 3D fonctionne aussi
très bien. Mais certains matériels nécessitent toujours des microprogrammes
supplémentaires pour fonctionner correctement. Il arrive aussi que certaines
cartes graphiques nécessitent un microprogramme même pour une prise en charge
basique de l'affichage.

Des précisions sur les matériels graphiques acceptés et les dispositifs de
pointage sont disponibles sur https://wiki.freedesktop.org/xorg/. Debian 11
propose la version 7.7 de X.Org.

2.1.6. Matériel de connexion réseau

Toute carte réseau (NIC, network interface card) reconnue par le noyau Linux
devrait aussi être reconnue par l'installateur. Les pilotes devraient être
chargés de manière automatique. La plupart des cartes PCI/PCI-Express sont
reconnues ainsi que les cartes PCMCIA/Express pour les portables.

Le RNIS ne peut pas être utilisé pour l'installation.

2.1.6.1. Cartes réseau sans fil

Les cartes réseau sans fil sont en général reconnues et le noyau Linux officiel
reconnaît un nombre croissant d'adaptateurs. Cependant beaucoup d'entre eux
demandent le chargement d'un microprogramme.

Quand un microprogramme est nécessaire, l'installateur vous demandera de le
télécharger. Consultez la Section 6.4, « Télécharger des microprogrammes (
firmware) manquants » pour des informations détaillées sur la manière de
charger un microprogramme pendant l'installation.

On peut faire fonctionner des cartes non reconnues par le noyau Linux officiel
avec Debian GNU/Linux, mais elles ne sont pas gérées pendant l'installation.

Si vous ne pouvez pas utiliser d'autre carte pour l'installation, vous pouvez
toujours installer Debian GNU/Linux avec un CD ou un DVD. Choisissez l'option
de ne pas configurer le réseau et utilisez seulement les paquets qui se
trouvent sur le CD. Une fois l'installation terminée (après le réamorçage),
vous pourrez charger le pilote et le microprogramme dont vous avez besoin et
configurer le réseau.

Parfois, le pilote nécessaire n'est pas disponible sous forme de paquet Debian.
Il faudra chercher le code source sur internet et le compiler vous-même.
Comment procéder dépasse le cadre de ce manuel. S'il n'existe pas de pilote
pour Linux, vous pouvez toujours utiliser le paquet ndiswrapper qui permet
d'installer un pilote Windows.

2.1.7. Les plages Braille

La gestion des plages Braille dépend de brltty. La plupart des plages
fonctionnent avec brltty, connecté par un port série, un port USB ou un port
bluetooth. Des précisions sur les plages fonctionnelles se trouvent sur le site
de brltty. Debian GNU/Linux 11 propose la version 6.3 de brltty.

2.1.8. Synthèse vocale matérielle

La synthèse vocale matérielle est prise en charge par speakup. Speakup
n'accepte que les cartes intégrées et les périphériques externes connectés par
un port série, (pas d'adaptateurs USB, serial-to-USB ou PCI). On peut trouver
des précisions sur la synthèse vocale matérielle sur le site de speakup. Debian
GNU/Linux 11 propose la version 3.1.6 de speakup.

2.1.9. Périphériques et autres matériels

Linux reconnaît une large gamme de périphériques comme les souris, les
imprimantes, les scanners, les périphériques PCMCIA/CardBus/ExpressCard et USB.
Cependant, aucun de ces périphériques n'est requis lors de l'installation du
système.

Le matériel USB fonctionne correctement. Pour quelques très anciens PC, les
claviers USB peuvent nécessiter une configuration supplémentaire (voyez la
Section 3.6.6, « Problèmes matériels à surveiller »). Sur les ordinateurs
modernes, claviers et souris USB ne demandent aucune configuration
particulière.

2.2. Périphériques demandant des microprogrammes (firmware)

Outre la disponibilité d'un pilote, certains périphériques exigent le
chargement d'un microprogramme pour fonctionner. C'est le cas pour les cartes
réseau (particulièrement les cartes réseau sans fil), mais certains
périphériques USB ou certains contrôleurs de disque dur demandent des
microprogrammes.

Pour les cartes graphiques, les fonctionnalités de base ne demandent pas de
microprogramme supplémentaire, contrairement aux fonctionnalités avancées qui
demandent l'installation sur le système d'un microprogramme spécifique. Dans
certains cas, une installation, même réussie, peut aboutir à un écran noir ou
un affichage défectueux lors du redémarrage. Si cela arrivait, il est possible
d'essayer quelques contournements pour se connecter tout de même (consultez la
Section 6.4.3, « Finaliser le système installé »).

Pour beaucoup de périphériques anciens, le microprogramme était placé par le
fabricant sur le périphérique lui-même, sur une puce EEPROM/Flash. Aujourd'hui,
les périphériques n'embarquent plus de microprogramme de cette façon. Le
microprogramme doit être chargé sur le périphérique par le système
d'exploitation à chaque démarrage.

Dans la plupart des cas, le microprogramme n'est pas libre selon les critères
du projet Debian et ne peut donc être inclus dans la section main de l'archive
ou dans le système d'installation. Si le pilote lui-même est inclus dans la
distribution et si le projet Debian peut distribuer légalement le
microprogramme, il sera disponible sous forme de paquet dans la section 
non-free de l'archive.

Cependant, cela ne signifie pas que ce type de matériel ne puisse pas être
utilisé pendant l'installation. À partir de Debian GNU/Linux 5.0,
l'installateur sait charger des microprogrammes sous forme de simple fichier ou
sous forme de paquet sur des supports amovibles comme une clé USB. Consultez la
Section 6.4, « Télécharger des microprogrammes (firmware) manquants » pour des
précisions sur la manière de télécharger des microprogrammes pendant
l'installation.

Si l'installateur Debian demande un microprogramme qui n'est pas disponible ou
que vous ne voulez pas installer un microprogramme non libre, vous pouvez
continuer l'installation sans télécharger le microprogramme. Certains pilotes
demandent des microprogrammes supplémentaires parce qu'ils sont nécessaires
dans certaines circonstances, mais le périphérique fonctionnera sans sur la
plupart des systèmes. Ainsi, cela arrive avec des cartes réseau utilisant le
pilote tg3.

2.3. Acheter du matériel spécialement pour GNU/Linux

Il existe des vendeurs qui livrent des systèmes en pré-installant Debian ou
d'autres distributions de GNU/Linux. Vous paierez peut-être plus cher pour
avoir ce privilège, mais vous achetez ainsi un peu de tranquillité d'esprit,
puisque vous serez certain que le matériel est bien reconnu par GNU/Linux.

Si vous devez acheter un ordinateur fourni avec Windows, lisez attentivement la
licence logicielle accompagnant Windows ; vous pourrez peut-être rejeter la
licence et obtenir un rabais de votre vendeur. Une recherche sur internet avec
la chaîne « remboursement Windows » peut vous donner des pistes.

Que vous achetiez ou non un système livré avec Linux, ou même un système
d'occasion, il est important de vérifier que votre matériel est reconnu par le
noyau Linux. Vérifiez si votre matériel est listé dans les références
ci-dessus. Indiquez à votre revendeur que vous recherchez un système Linux.
Soutenez les revendeurs de matériel amis de Linux.

2.3.1. Éviter le matériel propriétaire ou fermé

Certains constructeurs refusent simplement de fournir les informations qui
permettraient d'écrire des pilotes pour leur matériel. D'autres n'autorisent
pas l'accès à la documentation sans accord de confidentialité, ce qui nous
empêche de distribuer le code source qui est l'élément essentiel du logiciel
libre. Sans accès à une documentation utilisable, ces pilotes ne peuvent pas
fonctionner sous Linux.

Le plus souvent il existe des normes (au moins, de facto) qui décrivent comment
communiquent un système d'exploitation et ses pilotes de périphériques avec les
différentes classes de périphériques. Tous les périphériques qui satisfont
cette norme de facto peuvent fonctionner avec un pilote générique. Certains
périphériques USB, clavier, souris, disque flash, lecteur de carte mémoire,
fonctionnent ainsi très bien et pratiquement tous les modèles sur le marché se
conforment à la norme.

Mais dans certains domaines, par exemple celui des imprimantes, ce n'est pas le
cas. Beaucoup d'imprimantes peuvent certes être contrôlées par des langages
standardisés et peuvent donc fonctionner sans problème sur tout système
d'exploitation. Cependant, quelques imprimantes ne comprennent que des
commandes spéciales pour lesquelles aucune documentation n'est disponible.
Elles ne peuvent donc pas fonctionner sur un système d'exploitation libre sans
un pilote propriétaire fourni par le constructeur.

Même s'il existe un tel pilote propriétaire, sa disponibilité limite la durée
de vie du périphérique. De nos jours, les cycles de vie des produits se
raccourcissent et il n'est pas inhabituel de constater l'absence de mise à jour
du pilote quand la production du périphérique a cessé. Si l'ancien pilote ne
fonctionne plus après une mise à jour du système, un périphérique en parfait
état devient inutilisable. On ne peut rien faire ! Vous devriez donc éviter
d'acheter du matériel propriétaire, quel que soit le système d'exploitation que
vous utilisez.

Vous pouvez changer cette situation en encourageant les constructeurs de
matériel propriétaire à publier les documentations et tout autre moyen
nécessaire à la programmation de pilotes libres pour leur matériel.

2.4. Les supports d'installation

Cette section précise les différents supports utilisables pour installer
Debian. Un chapitre entier est consacré aux supports, le Chapitre 4, Comment
obtenir les supports du système d'installation ? ; il indique les avantages et
les désavantages de chaque support. Quand vous aurez atteint ce chapitre, vous
pourrez vous reporter à cette page.

2.4.1. CD-ROM/DVD-ROM/BD-ROM

L'installation à partir d'un disque optique est aussi possible avec la plupart
des architectures.

Sur les PC, les ports SATA et IDE/ATAPI, ainsi que les lecteurs de disques
optiques USB et SCSI sont reconnus, comme le sont les périphériques FireWire
reconnus par les pilotes ohci1394 et sbp2.

2.4.2. Les clés USB

Les disques flash USB (clés USB) sont des périphériques de stockage bon marché
et très utilisés. La plupart des systèmes modernes permettent d'amorcer
l'installateur Debian à partir d'une clé USB. Ainsi, pour ceux qui ne possèdent
pas de lecteur de disque optique, comme les netbooks ou les ultraportables,
l'installation d'un nouveau système peut se faire par une clé USB.

2.4.3. Le réseau

Pendant l'installation, le téléchargement des fichiers nécessaires peut se
faire par le réseau. Selon le type d'installation que vous avez choisi et les
réponses que vous donnez à certaines questions, le réseau est utilisé ou non.
Le système d'installation accepte la plupart des modes de connexion (PPPoE, par
exemple, mais pas ISDN ou PPP), par HTTP ou FTP. Une fois l'installation
terminée, vous pouvez configurer les modes ISDN ou PPP.

Vous pouvez aussi amorcer le système d'installation sur le réseau, sans CD ni
clé USB. Si vous avez l'infrastructure nécessaire -- votre réseau fait
fonctionner des services DHCP et TFTP --, il est très facile et rapide de
déployer un grand nombre de machines. Mettre en œuvre une telle infrastructure
exige cependant une certaine expérience technique qui n'est pas à la portée des
débutants.

L'installation sans disque, en utilisant le démarrage par réseau et le montage
par NFS de tous les systèmes de fichiers locaux, est une autre possibilité.

2.4.4. Les disques durs

L'installation à partir d'un disque local est aussi possible sur beaucoup
d'architectures. Cela demande qu'un autre système d'exploitation charge
l'installateur sur le disque dur. Cette méthode n'est recommandée que pour des
cas spéciaux, quand aucune autre méthode n'est disponible.

2.4.5. Un*x ou système GNU

Si vous utilisez un système de type Unix, vous pouvez installer Debian GNU/
Linux sans utiliser l'installateur qui est décrit dans la suite de ce manuel.
Cette manière de faire peut servir à des utilisateurs qui possèdent un matériel
non reconnu ou qui sont sur des machines qui ne peuvent se permettre un temps
d'arrêt. Si cette technique vous intéresse, reportez-vous à la Section D.3,
« Installer Debian GNU/Linux à partir d'un système Unix/Linux ». Cette méthode
n'est recommandée que pour les experts, quand aucune autre méthode n'est
disponible.

2.4.6. Systèmes de stockage reconnus

L'installateur Debian contient un noyau construit pour permettre de faire
tourner un maximum de systèmes.

Le système d'installation Debian reconnaît les disques IDE (PATA), les
contrôleurs et disques SATA et SCSI, les périphériques USB et FireWire. Les
systèmes de fichiers reconnus comprennent FAT, les extensions FAT Win-32 (VFAT)
et NTFS.

2.5. Mémoire et espace disque nécessaires

Vous devez posséder au moins 780 Mo de mémoire vive et 920 Mo d'espace disque.
Ce sont vraiment des valeurs minimales. Pour une estimation plus réaliste,
voyez la Section 3.4, « Matériel minimum ».

En temps normal, l'installateur active automatiquement une fonction de
sauvegarde de mémoire pour fonctionner sur des systèmes qui en possèdent peu.
Mais sur certaines architectures moins bien testées, cela pourrait faire
défaut. Cependant, cette fonctionnalité peut être activée manuellement en
ajoutant le paramètre d'amorçage lowmem=1, ou même lowmem=2 (consultez aussi la
Section 6.3.1.1, « Vérification de la mémoire disponible et le mode peu de
mémoire » et la Section 5.3.2, « Paramètres pour l'installateur Debian »).

Installation on systems with less memory^[2] or disk space available may be
possible but is only advised for experienced users.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[2] Installation images that support the graphical installer require more
memory than images that support only the text-based installer and should not be
used on systems with less than 780 Mo of memory. If there is a choice between
booting the text-based and the graphical installer, the former should be
selected on such systems.

Chapitre 3. Avant d'installer Debian GNU/Linux

Table des matières

3.1. Vue générale du processus d'installation
3.2. Sauvegardez vos données !
3.3. Informations utiles

    3.3.1. La documentation
    3.3.2. Comment trouver les sources d'informations sur le matériel ?
    3.3.3. Compatibilité matérielle
    3.3.4. Configuration du réseau

3.4. Matériel minimum
3.5. Partitionnement préalable d'une machine multisystème
3.6. Configuration matérielle et système avant l'installation

    3.6.1. Le menu de configuration du BIOS ou de l'UEFI
    3.6.2. Sélection du périphérique d'amorçage
    3.6.3. Systèmes avec un microprogramme UEFI
    3.6.4. Démarrage sécurisé
    3.6.5. Désactiver le démarrage rapide de Windows (« fast boot » ou « fast
        startup »)
    3.6.6. Problèmes matériels à surveiller

Ce chapitre traite de la préparation nécessaire à l'installation d'un système
Debian, avant même tout amorçage de l'installateur. Cela concerne la sauvegarde
des données, la connaissance de votre matériel et des informations nécessaires.

3.1. Vue générale du processus d'installation

D'abord, une note au sujet des réinstallations. Avec Debian, il est très rare
d'avoir à réinstaller complètement son système. La cause la plus commune d'une
réinstallation est sans doute une défaillance mécanique du disque dur.

Beaucoup de systèmes d'exploitation nécessitent une installation complète quand
des erreurs critiques se produisent ou lors d'une mise à jour du système. Et
même s'il n'est pas nécessaire de refaire entièrement une installation, les
programmes que vous utilisez doivent être réinstallés pour fonctionner
correctement.

Avec Debian GNU/Linux, quand les choses tournent mal, vous devrez sans doute
réparer le système, mais pas le remplacer entièrement. Les mises à jour
n'exigent jamais une installation complète ; vous pouvez toujours les faire à
partir du système existant. Les programmes sont presque toujours compatibles
avec les versions successives du système. Quand la nouvelle version d'un
programme exige d'autres logiciels, le système de gestion des paquets fait en
sorte que tous les logiciels nécessaires soient listés et installés. Beaucoup
d'efforts ont été déployés pour éviter le besoin d'une réinstallation : c'est
la dernière option ! Et l'installateur n'est pas conçu pour procéder à une
installation sur un système existant.

Voici les étapes qui composent le processus d'installation :

 1. sauvegarder toutes les données du disque dur sur lequel l'installation sera
    faite ;

 2. rassembler les informations concernant l'ordinateur, ainsi que la
    documentation nécessaire ;

 3. télécharger l'installateur et tous les pilotes et microprogrammes
    nécessaires ;

 4. préparer les périphériques d'amorçage, CD, DVD, clé USB, ou préparer un
    système d'amorçage par le réseau pour amorcer l'installateur ;

 5. amorcer l'installateur ;

 6. choisir une langue ;

 7. si nécessaire, mettre en place la connexion réseau par ethernet ;

 8. si nécessaire, redimensionner les partitions du disque dur pour faire de la
    place pour l'installation ;

 9. créer et monter les partitions sur lesquelles Debian sera installée ;

10. attendre la fin du processus automatique de téléchargement/installation/
    configuration du système de base ;

11. sélectionner et installer des logiciels supplémentaires ;

12. installer un programme d'amorçage qui puisse démarrer Debian GNU/Linux ou
    un autre système ;

13. charger le nouveau système pour la première fois.

Sur PC 64 bits il est possible d'utiliser la version graphique du système
d'installation. Pour d'autres informations sur cette méthode d'installation,
voyez la Section 5.1.8, « L'installateur graphique ».

Connaître les paquets qui sont impliqués dans chaque étape peut aider à la
résolution des problèmes qui peuvent se produire durant l'installation. Voici
les principaux acteurs de cette pièce :

L'installateur Debian est le sujet principal de ce manuel. Il détecte le
matériel et charge les pilotes nécessaires, il met en place la connexion au
réseau avec dhcp-client, il installe les paquets du système de base avec
debootstrap et il lance tasksel pour vous permettre d'installer d'autres
logiciels. Il y a bien d'autres acteurs mineurs, mais l'installateur Debian a
terminé sa tâche quand vous démarrez pour la première fois le nouveau système.

Pour installer ce dont vous avez besoin, vous disposez du programme tasksel qui
peut installer des ensembles thématiques de paquets, comme par exemple un
serveur web ou un environnement de bureau.

Une option importante lors de l'installation est d'installer ou non un
environnement de bureau avec le système X Window. Si vous n'avez pas choisi la
tâche « Desktop environment », vous aurez un système minimal avec ligne de
commande. L'installation d'un environnement de bureau est facultative car cela
demande beaucoup plus d'espace disque que l'installation en mode texte. D'autre
part, beaucoup de systèmes Debian sont des serveurs qui n'ont pas vraiment
besoin d'une interface graphique pour être opérationnels.

Notez que l'installateur et le système X Window sont distincts. Les problèmes
liés à ce dernier ne sont pas du ressort de ce manuel.

3.2. Sauvegardez vos données !

Avant de commencer, assurez-vous d'avoir effectué une sauvegarde de tous les
fichiers qui se trouvent sur votre système. Si c'est la première fois que vous
installez un autre système d'exploitation sur votre machine, il est probable
que vous devrez repartitionner votre disque dur afin de faire de la place pour
Debian GNU/Linux. À chaque partitionnement, il y a un risque de perdre toutes
les données du disque, quel que soit le programme utilisé pour cette opération.
Les programmes utilisés pour l'installation de Debian GNU/Linux sont assez
fiables et la plupart ont été utilisés pendant des années, mais ils sont très
puissants et un faux mouvement peut vous coûter cher. Même après la sauvegarde,
soyez attentif et réfléchissez à vos réponses. Deux minutes de réflexion
peuvent vous épargner des heures de travail.

Si vous voulez pouvoir amorcer plusieurs systèmes, assurez-vous de disposer du
support de distribution des autres systèmes d'exploitation présents. Dans
quelques rares situations, vous pouvez être amené à réinstaller le programme
d'amorçage de votre système d'exploitation, ou même, à réinstaller complètement
le système d'exploitation et restaurer vos données à partir de la sauvegarde
que vous avez effectuée.

3.3. Informations utiles

3.3.1. La documentation

3.3.1.1. Le manuel d'installation

Le document que vous lisez, au format texte, HTML ou PDF.

  • install.fr.txt

  • install.fr.html

  • install.fr.pdf

3.3.1.2. La documentation du matériel

Elle contient souvent des informations utiles pour l'utilisation et la
configuration de votre matériel.

  • La page « Matériel » sur le wiki Debian"

3.3.2. Comment trouver les sources d'informations sur le matériel ?

La plupart du temps, l'installateur détectera automatiquement votre matériel.
Mais nous vous conseillons de bien connaître votre matériel avant de commencer
l'installation.

On peut trouver des informations sur plusieurs sources :

  • les manuels accompagnant chaque élément ;

  • les écrans de configuration du BIOS ou de l'UEFI de votre ordinateur. Vous
    pouvez accéder à ces écrans pendant le démarrage de l'ordinateur en
    appuyant sur une combinaison de touches. Consultez votre manuel pour
    connaître cette combinaison. Il s'agit souvent de la touche Suppr ou de la
    touche F2. Cependant, certains fabricants peuvent utiliser d'autres
    touches. Le plus souvent, au démarrage de l'ordinateur, un message indique
    la touche à utiliser ;

  • les boîtes et cartons de chaque élément ;

  • la fenêtre « Système » dans le panneau de configuration de Windows ;

  • les commandes système ou les outils d'un autre système d'exploitation,
    incluant les affichages d'un gestionnaire de fichiers. Cette source est
    particulièrement utile pour trouver des informations sur la mémoire vive et
    les disques durs ;

  • votre administrateur système ou votre fournisseur d'accès à Internet. Ces
    sources peuvent vous indiquer les réglages nécessaires à la configuration
    du réseau et du courrier électronique.

Tableau 3.1. Informations sur le matériel utiles pour l'installation

┌─────────────────┬─────────────────────────────────────────────────────────┐
│    Matériel     │       Informations dont vous pouvez avoir besoin        │
├─────────────────┼─────────────────────────────────────────────────────────┤
│                 │Leur nombre                                              │
│                 ├─────────────────────────────────────────────────────────┤
│                 │Leur ordre dans le système                               │
│                 ├─────────────────────────────────────────────────────────┤
│                 │S'ils sont de type IDE (PATA), SATA ou SCSI              │
│Disques durs     ├─────────────────────────────────────────────────────────┤
│                 │L'espace disponible                                      │
│                 ├─────────────────────────────────────────────────────────┤
│                 │Les partitions                                           │
│                 ├─────────────────────────────────────────────────────────┤
│                 │Les partitions contenant d'autres systèmes d'exploitation│
├─────────────────┼─────────────────────────────────────────────────────────┤
│Interfaces réseau│Type/modèle des interfaces réseau disponibles            │
├─────────────────┼─────────────────────────────────────────────────────────┤
│Imprimante       │Le modèle et la marque                                   │
├─────────────────┼─────────────────────────────────────────────────────────┤
│Carte vidéo      │Le modèle et la marque                                   │
└─────────────────┴─────────────────────────────────────────────────────────┘


3.3.3. Compatibilité matérielle

Beaucoup de produits fonctionnent sans problème sous Linux. La gestion des
matériels est améliorée chaque jour. Cependant, Linux ne peut pas utiliser
autant de matériels que d'autres systèmes d'exploitation.

Les pilotes pour Linux ne sont pas écrits pour tel ou tel produit de tel ou tel
constructeur mais pour tel matériel (puce). Beaucoup de produits apparemment
différents sont basés sur le même matériel. Il n'est pas inhabituel que des
constructeurs de puces fournissent de prétendues « conceptions de référence »
pour des produits basés sur leurs puces qui sont ensuite utilisées par
plusieurs constructeurs différents et vendues sous différentes marques.

Cette situation comporte des avantages et des inconvénients. Un avantage est
qu'un pilote de puce fonctionne pour différents produits de différents
constructeurs. Le problème est qu'il n'est pas toujours facile de savoir quelle
puce est réellement utilisée par tel produit. Parfois les constructeurs
modifient le matériel d'un produit sans changer ni le nom ni la version de ce
produit. Ainsi, deux exemplaires d'un même produit, achetés à différents
moments, peuvent être basés sur deux puces différentes et donc utiliser deux
pilotes différents. Il se peut alors qu'aucun pilote ne soit disponible pour
l'une des deux puces.

Pour les périphériques USB et PCI/PCI-Express/ExpressCard, un bon moyen de
connaître la puce utilisée est de chercher les identifiants du périphérique. La
combinaison de ces identifiants nommés « vendor » et « product » est
habituellement la même pour tout produit basé sur la même puce.

Sur un système Linux, ces identifiants peuvent être lus par la commande lsusb
pour les périphériques USB et par la commande lspci -nn pour les périphériques
PCI/PCI-Express/ExpressCard. Ils sont généralement donnés sous la forme de deux
nombres hexadécimaux, séparés par un deux-points, « 1d6b:0001 » par exemple.

Résultat de la commande lsusb : "Bus 001 Device 001: ID 1d6b:0002 Linux
Foundation 2.0 root hub", où 1d6b est l'identifiant « vendor » et 0002
l'identifiant « product ».

Résultat de la commande lspci -nn pour une carte ethernet : "03:00.0 Ethernet
controller [0200]: Realtek Semiconductor Co., Ltd. RTL8111/8168B PCI Express
Gigabit Ethernet controller [10ec:8168] (rev 06)". Les identifiants sont donnés
dans les crochets les plus à droite, 10ec le « vendor » et 8168 le « product ».

Un exemple pour une carte graphique : "04:00.0 VGA compatible controller
[0300]: Advanced Micro Devices [AMD] nee ATI RV710 [Radeon HD 4350] [1002:954f]
".

Sur les systèmes Windows, les identifiants d'un périphérique peuvent être
trouvés dans le gestionnaire de périphériques, onglet « details ».
L'identifiant « vendor » est préfixé par VEN_ et « product » par DEV_. Sur les
systèmes Windows 7, vous devez sélectionner la propriété « Hardware IDs » dans
l'onglet « details » du gestionnaire de périphériques car ils ne sont pas
visibles par défaut.

Une recherche sur Internet avec ces identifiants, Linux et « driver » donne
souvent des informations sur le pilote nécessaire à telle puce. Si ce n'est pas
le cas, une recherche peut être effectuée avec les noms des puces, donnés aussi
par les commandes lsusb et lspci, "RTL8111"/"RTL8168B" pour la carte réseau et
"RV710" pour la carte graphique des précédents exemples.

3.3.3.1. Tester le matériel avec un système autonome

Debian GNU/Linux est disponible sous forme de système autonome pour quelques
architectures. Un système autonome est un système dans un format compressé,
préconfiguré et utilisable immédiatement, qui peut être amorcé depuis un
support en lecture seule comme un CD ou un DVD. Son utilisation ne modifie pas
de façon permanente votre ordinateur. Vous pouvez modifier des paramètres,
installer des programmes, etc., tout cela se passe dans la mémoire vive de
l'ordinateur. Si vous éteignez l'ordinateur et relancez le système autonome,
tout est remis en l'état par défaut. Exécuter un système autonome est le moyen
le plus simple de savoir si votre matériel est reconnu par Debian GNU/Linux.

Un système autonome impose quelques limitations. La première est que toutes les
modifications que vous apportez doivent être contenues dans la mémoire vive de
l'ordinateur. Il faut donc assez de mémoire et l'installation de certains
logiciels peut échouer à cause du manque de mémoire. Une autre limitation est
que le système autonome officiel de Debian GNU/Linux ne contient que des
éléments libres. Des microprogrammes non libres peuvent bien sûr être
installés, mais aucune détection automatique n'est effectuée comme celle
effectuée par l'installateur Debian. Vous devrez donc installer vous-même les
composants non libres.

Des informations sur les variantes disponibles des images autonomes de Debian
se trouvent sur le site web Debian Live Images.

3.3.4. Configuration du réseau

Si votre machine est connectée à un réseau -- avec une connexion ethernet ou
équivalente (pas une connexion PPP) --, vous devriez demander à votre
administrateur système les éléments suivants :

  • le nom de votre machine (à choisir vous-même, si vous en avez le droit) ;

  • le nom de votre domaine ;

  • l'adresse IP de votre machine ;

  • le masque réseau à utiliser ;

  • l'adresse IP de la passerelle qui sert de routeur, si votre réseau possède
    une passerelle ;

  • la machine de votre réseau qui servira de serveur DNS (Domain Name
    Service).

Quand un serveur DHCP est disponible sur votre réseau, vous n'avez pas besoin
de toutes ces informations. Le serveur DHCP les fournira directement pendant le
processus d'installation.

Si votre accès à Internet se fait par DSL ou par un modem câble (par un réseau
TV câblé), et si vous avez un routeur, souvent préconfiguré par le fournisseur
d'accès, un serveur DHCP est habituellement disponible.

En règle générale : si vous n'avez pas eu à paramétrer le réseau pour un
système Windows, la connexion au réseau pour Debian GNU/Linux sera aussi
automatiquement configurée.

Pour un réseau WLAN/WiFi, vous aurez besoin des informations suivantes :

  • l'ESSID (nom) du réseau sans fil ;

  • la clé WEP ou WPA/WPA2 pour accéder au réseau (si nécessaire).

3.4. Matériel minimum

Une fois rassemblées les informations sur votre matériel, vérifiez que vous
pouvez faire le type d'installation souhaité.

Selon vos besoins, vous pouvez continuer avec du matériel moins performant que
celui recommandé dans le tableau ci-dessous. Cependant, la plupart des
utilisateurs seront frustrés s'ils ignorent ces suggestions.

Un Pentium 4, 1 GHz, est la configuration minimale recommandée pour une machine
de bureau.

Tableau 3.2. Configuration matérielle minimale recommandée

┌───────────────────┬──────────────┬─────────────────┬─────────────┐
│Type d'installation│RAM (minimum) │RAM (recommandée)│ Disque dur  │
├───────────────────┼──────────────┼─────────────────┼─────────────┤
│Sans bureau        │256 mégaoctets│512 mégaoctets   │2 gigaoctets │
├───────────────────┼──────────────┼─────────────────┼─────────────┤
│Avec bureau        │1 gigaoctet   │2 gigaoctets     │10 gigaoctets│
└───────────────────┴──────────────┴─────────────────┴─────────────┘


The minimum values assumes that swap will be enabled and a non-liveCD image is
used. The « No desktop » value assumes that the non-graphical (text-based)
installer is used.

La quantité de mémoire minimale réellement nécessaire est inférieure à celle
donnée dans le tableau. Avec la partition d'échange « swap » activée, il est
possible d'installer Debian avec 350 Mo. Il en va de même pour l'espace disque,
surtout si vous choisissez une à une les applications à installer. Voyez la
Section D.2, « Espace disque nécessaire pour les tâches » pour vous faire une
idée de l'espace disque nécessaire.

Il est possible de faire fonctionner un environnement de bureau sur de vieilles
machines ou des machines bas de gamme mais il est alors recommandé d'installer
un gestionnaire graphique moins gourmand en ressources que les environnements
de bureau de GNOME et KDE Plasma. Par exemple, xfce4, icewm et wmaker, mais il
en existe d'autres.

Il n'est pas possible d'indiquer des valeurs minimales concernant la mémoire et
l'espace disque nécessaires à un serveur. Tout dépend de l'utilisation qui en
sera faite.

Il faut remarquer que ces mesures ne comptabilisent pas tous les fichiers,
comme les fichiers des utilisateurs, la messagerie et les données. Il vaut
toujours mieux prévoir large quand il s'agit de ses propres fichiers et
données.

L'espace disque nécessaire au bon fonctionnement du système Debian GNU/Linux
est pris en compte dans ces valeurs recommandées. En particulier, la partition
/var dans Debian contient beaucoup d'informations sur l'état du système. Les
fichiers de dpkg (contenant des informations sur tous les paquets installés)
peuvent facilement atteindre 40 Mo ; apt y met les paquets téléchargés avant de
les installer. Au moins 200 Mo devraient être attribués à /var et beaucoup plus
si vous installez un environnement de bureau.

3.5. Partitionnement préalable d'une machine multisystème

Partitionner votre disque dur est simplement le fait de le diviser en plusieurs
sections. Chaque section est alors indépendante des autres. C'est en gros
équivalent à ajouter des cloisons dans une maison : ajouter des meubles dans
une pièce n'affecte pas les autres pièces.

Si vous avez déjà un système d'exploitation sur votre machine (Windows 9x,
Windows NT/2000/XP/2003/Vista/7, OS/2, MacOS, Solaris, FreeBSD...) qui utilise
tout le disque sur lequel vous désirez placer Debian, vous devrez
repartitionner ce disque. Le système Debian a besoin de partitions spécifiques.
Il ne peut pas être installé sur des partitions Windows ou Mac OS X. Il peut
partager des partitions avec d'autres systèmes Unix, mais ce point n'est pas
abordé ici. Vous devez attribuer au moins une partition à la racine du système
Debian.

Vous pouvez trouver des informations sur le partitionnement actuel en utilisant
un outil approprié pour votre système d'exploitation, tel que fdisk pour DOS ou
le gestionnaire de disque intégré pour Windows. Les outils de partitionnement
permettent toujours de montrer l'état actuel sans rien modifier.

Modifier une partition contenant déjà un système de fichiers détruit ces
fichiers. Vous devriez donc toujours faire des sauvegardes avant tout
partitionnement. En continuant l'analogie avec la maison, avant d'abattre une
cloison, vous déplaceriez certainement les meubles afin de ne pas les
endommager.

Plusieurs systèmes d'exploitation modernes offrent la possibilité de déplacer
et redimensionner des partitions existantes sans perdre leurs données. De la
place est ainsi créée pour ajouter des partitions. Même si cela fonctionne très
bien dans la plupart des cas, modifier les partitions d'un disque est une
opération fondamentalement dangereuse. Avant toute modification, une sauvegarde
des données doit être effectuée. Pour les partitions de type FAT/FAT32 et NTFS
sur les systèmes DOS et Windows, l'installateur Debian et le gestionnaire de
disque intégré de Windows 7 permettent de modifier les partitions.

Pour redimensionner une partition FAT ou NTFS avec l'installateur Debian, il
faut aller à l'étape du partitionnement, sélectionner l'option du
partitionnement manuel, choisir une partition à redimensionner et simplement
indiquer sa nouvelle dimension.

Créer ou supprimer des partitions peut se faire avec l'installateur Debian ou
avec le système d'exploitation existant. En règle générale, il vaut mieux
utiliser le système d'exploitation auquel sont destinées les partitions. Ainsi,
les partitions pour Debian GNU/Linux seront créées avec l'installateur Debian
et les partitions pour un autre système seront créées avec cet autre système.
L'installateur Debian peut créer sans problème particulier des partitions pour
d'autres systèmes d'exploitation mais il existe quelques rares cas où cela peut
poser des problèmes. Il est donc plus sûr de créer les partitions d'un système
avec les outils de partitionnement de ce système.

Si vous installez plusieurs systèmes d'exploitation sur la même machine, vous
devriez commencer par les autres systèmes avant d'installer Debian. Windows
ainsi que d'autres installateurs de système d'exploitation peuvent vous
empêcher de démarrer Debian, ou vous encourager à reformater les partitions non
reconnues.

Vous pouvez annuler ces actions ou les éviter, mais installer en premier le
système natif vous épargnera des problèmes.

3.6. Configuration matérielle et système avant l'installation

Cette section passe en revue les réglages matériels que vous devrez peut-être
effectuer avant d'installer Debian. En général, cela implique de vérifier, et
parfois de modifier, les réglages du microprogramme système (BIOS,UEFI, etc.)
sur votre machine. Le « BIOS », « UEFI » ou « microprogramme système » est le
logiciel de base utilisé par le matériel ; il est plus spécifiquement exécuté
pendant le processus d'amorçage (après la mise sous tension).

3.6.1. Le menu de configuration du BIOS ou de l'UEFI

Le BIOS, comme l'UEFI, fournit les fonctions de base nécessaires à l'amorçage
de votre machine pour permettre au système d'exploitation d'accéder au
matériel. Le système fournit un menu destiné à la configuration du BIOS ou de
l'UEFI. Vous pouvez accéder à ce menu en appuyant sur une touche ou sur une
combinaison de touches. Il s'agit souvent de la touche Suppr ou de la touche F2
. Certains constructeurs utilisent d'autres touches. Au démarrage de
l'ordinateur, un message indique généralement la touche à utiliser.

3.6.2. Sélection du périphérique d'amorçage

À l'intérieur du menu de configuration du BIOS ou de l'UEFI vous pouvez choisir
les périphériques utilisables pour l'amorçage du système et leur ordre. Peuvent
être sélectionnés des disques durs internes, un lecteur de CD/DVD ou des
périphériques de stockage USB comme des clés ou des disques externes. Sur des
systèmes modernes, il existe aussi la possibilité d'amorcer par le réseau
(PXE).

Selon le support d'installation choisi (CD/DVD, clé USB, amorçage par le
réseau), vous devez activer, s'il ne l'est pas déjà, le périphérique d'amorçage
approprié.

La plupart des BIOS et des UEFI permettent d'appeler un menu au démarrage du
système dans lequel vous sélectionnez le périphérique d'amorçage pour la
session actuelle. Si cette option est disponible, le BIOS ou l'UEFI affiche un
court message, « press F12 for boot menu » par exemple. La touche peut être
différente selon les systèmes, F12, F11 ou F8. Choisir un périphérique dans ce
menu ne change pas l'ordre d'amorçage par défaut du BIOS ou de l'UEFI. Ainsi,
vous pouvez amorcer à partir d'une clé USB alors que le disque dur interne
reste le périphérique d'amorçage prioritaire.

Si le BIOS ni l'UEFI ne vous donne cette possibilité, vous devez modifier sa
configuration et indiquer comme prioritaire le périphérique qui contient
l'installateur Debian

Quelques ordinateurs contiennent malheureusement des versions du BIOS ou de
l'UEFI défectueuses. Il est parfois impossible d'amorcer l'installateur Debian
à partir d'une clé USB même si l'option appropriée existe dans le menu de
configuration et la clé est choisie comme périphérique d'amorçage prioritaire.
Sur certains systèmes, on peut forcer l'amorçage en changeant le type de
périphérique, de « USB harddisk » ou « USB stick » à « USB ZIP » ou « USB CDROM
 ». En particulier, si vous utilisez une image d'installation hybride (« 
isohybrid ») sur une clé USB (voyez la Section 4.3.1, « Préparation d'une clé
USB utilisant une image hybride de CD ou DVD »), modifier le type de
périphérique en « USB CDROM » peut servir pour les BIOS ou les UEFI qui ne
permettent pas l'amorçage sur une clé en mode « USB harddisk ». Vous devrez
peut-être configurer votre BIOS ou UEFI pour activer le « USB legacy support »
(prise en charge de l'USB traditionnel).

Si vous ne pouvez pas régler le BIOS ou l'UEFI pour permettre l'amorçage à
partir d'une clé USB, vous pouvez toujours copier une image ISO sur la clé.
Amorcez l'installateur Debian (consultez la Section 4.4, « Préparer les
fichiers pour amorcer depuis un disque dur ») et, lors de la recherche d'une
image ISO sur les disques, choisissez la clé USB et l'image d'installation.

3.6.3. Systèmes avec un microprogramme UEFI

UEFI (« Interface micrologicielle extensible unifiée » ou « Unified Extensible
Firmware Interface ») est un nouveau type de microprogramme utilisé sur de
nombreux systèmes récents et est prévu, entre autre, pour remplacer le BIOS
classique des PC.

Actuellement, la majorité des systèmes PC qui utilisent l'UEFI intègrent aussi
un module de compatibilité (« Compatibility Support Module » (CSM)) dans le
microprogramme, qui procure les mêmes interfaces que le BIOS au système
d'exploitation. Ainsi, les logiciels écrits pour le BIOS classique peuvent être
utilisés sans changement. Malgré cela, l'UEFI est prévu pour remplacer
complètement les anciens BIOS sans être totalement rétrocompatible, et il
existe déjà certains systèmes avec UEFI mais sans CSM.

Sur les systèmes avec UEFI, il y a certains détails à prendre en compte
lorsqu'on installe un système d'exploitation. La façon dont le microprogramme
charge le système d'exploitation est très différente entre le BIOS classique
(ou l'UEFI avec CSM) et l'UEFI natif. Une des principales différences est la
façon d'enregistrer les partitions sur le disque dur. Alors que le BIOS et
l'UEFI avec CSM utilisent une table de partitionnement DOS, l'UEFI utilise un
schéma de partition différent appelé « GUID Partition Table » (GPT). Sur un
seul disque, une seule façon peut être utilisée, et dans le cas d'une
installation multi-boot avec différents systèmes d'exploitation sur le même
disque, tous doivent utiliser le même type de table de partitions. Amorcer
depuis un disque avec GPT n'est possible qu'en mode UEFI natif, mais utiliser
GPT devient de plus en plus commun à mesure que les disques grossissent, car la
table de partitionnement DOS classique ne peut pas adresser des disques de plus
de 2 Téraoctets alors que GPT le permet. L'autre principale différence entre le
BIOS (ou l'UEFI avec CSM) et l'UEFI natif réside dans la localisation et le
format du code d'amorçage. Ainsi, des chargeurs d'amorçage (« bootloaders »)
différents sont utilisés pour chaque système.

Ce dernier point devient important au démarrage de l'installateur Debian sur un
système UEFI avec CSM parce que l'installateur vérifie s'il a été démarré sur
un système BIOS ou UEFI natif, et installe le chargeur d'amorçage
correspondant. Habituellement, cela fonctionne sans problème, mais peut en
poser dans les environnements multi-boot. Sur certains systèmes UEFI avec CSM,
le mode d'amorçage par défaut des périphériques amovibles peut être différent
de celui utilisé à l'amorçage depuis le disque dur. Ainsi, à l'amorçage de
l'installateur Debian depuis une clé USB dans un mode différent de celui
utilisé lors de l'amorçage du système d'exploitation déjà installé sur le
disque dur, le mauvais chargeur d'amorçage peut être installé et le système
devient impossible à démarrer après l'installation. Au moment de choisir le
périphérique d'amorçage depuis le menu du microprogramme, certains systèmes
offrent deux choix pour chaque périphérique, ainsi l'utilisateur peut choisir
si l'amorçage doit se faire avec CSM ou en mode UEFI natif.

3.6.4. Démarrage sécurisé

Un autre sujet relatif à l'UEFI est le mécanisme appelé « secure boot »
(démarrage sécurisé). Le démarrage sécurisé correspond à une fonction de l'UEFI
qui autorise le microprogramme à charger et exécuter uniquement du code signé
par cryptographie avec certaines clés et ainsi bloquer tout code d'amorçage
(potentiellement dangereux) signé avec une clé inconnue ou pas signé du tout.
En pratique, la seule clé acceptée par défaut sur la plupart des systèmes UEFI
avec démarrage sécurisé est une clé de Microsoft utilisée pour signer le
chargeur d'amorçage de Windows. Debian contient un chargeur d'amorçage
d'adaptation (« shim ») signé par Microsoft, ce qui devrait fonctionner
correctement sur les systèmes où le démarrage sécurisé est activé.

3.6.5. Désactiver le démarrage rapide de Windows (« fast boot » ou « fast
startup »)

Windows offre une fonctionnalité appelée démarrage rapide (« fast boot » dans
Windows 8, « fast startup » dans Windows 10) pour réduire le temps de
démarrage. Techniquement, lorsque cette fonction est activée, Windows ne
s'arrête pas vraiment pour redémarrer « à froid », mais effectue quelque chose
qui ressemble plutôt à une hibernation partielle pour réduire le temps de
« démarrage ». Tant que Windows est le seul système d'exploitation sur la
machine, cela ne pose pas de problème, mais peut conduire à des pertes de
données et d'autres inconvénients lorsque vous avez une configuration en « dual
boot » dans laquelle un autre système d'exploitation accède au même système de
fichiers que Windows. Dans ce cas, le système de fichiers peut être dans un
état différent de ce qu'attend Windows après le « démarrage », et peut
provoquer une corruption du système de fichiers lors des nouveaux accès en
écriture sur ce même système de fichiers. Pour cela, dans une configuration en 
« dual boot », pour éviter la corruption du système de fichiers, la
fonctionnalité « fast boot » ou « fast startup » doit être désactivée depuis
Windows.

De plus, le mécanisme de Windows Update peut (parfois) réactiver cette
fonctionnalité après avoir été précédemment désactivée. Il est suggéré de
vérifier régulièrement ce paramètre.

Il peut aussi être nécessaire de désactiver la fonction « fast boot » pour
permettre l'accès à la configuration UEFI et choisir d'amorcer un autre système
d'exploitation ou l'installateur Debian. Sur certains systèmes UEFI, le
microcode peut réduire la durée du « boot » en n'initialisant pas le contrôleur
de clavier ou le matériel USB. Dans ce cas, il est nécessaire de démarrer
Windows pour désactiver cette fonctionnalité et autoriser un changement de
l'ordre d'amorçage.

3.6.6. Problèmes matériels à surveiller

BIOS et claviers USB. Si vous n'avez pas de clavier de type PS/2, mais
seulement un modèle USB, vous devrez peut-être activer, sur quelques vieux
systèmes, l'émulation clavier dans la configuration du BIOS pour pouvoir
utiliser votre clavier dans le menu du programme d'amorçage. Sur les systèmes
modernes, il n'y a pas de problème. Si votre clavier ne répond pas dans le menu
du programme d'amorçage, consultez le manuel de votre carte mère et cherchez
dans le BIOS une option « Legacy keyboard emulation » ou « USB keyboard
support ».

Chapitre 4. Comment obtenir les supports du système d'installation ?

Table des matières

4.1. images d'installation Debian GNU/Linux officielles
4.2. Télécharger les fichiers depuis les miroirs Debian

    4.2.1. Où trouver les fichiers d'installation ?

4.3. Préparation des fichiers pour un amorçage avec une clé USB

    4.3.1. Préparation d'une clé USB utilisant une image hybride de CD ou DVD
    4.3.2. Copie des fichiers -- méthode simple
    4.3.3. Copie des fichiers -- méthode détaillée

4.4. Préparer les fichiers pour amorcer depuis un disque dur

    4.4.1. Démarrage du programme d'installation depuis Linux avec GRUB
    4.4.2. Démarrage du programme d'installation depuis DOS avec loadlin

4.5. Préparer les fichiers pour amorcer depuis le réseau avec TFTP

    4.5.1. Configurer un serveur DHCP
    4.5.2. Configurer un serveur BOOTP
    4.5.3. Activer le serveur TFTP
    4.5.4. Mettre les images TFTP en place

4.6. Installation automatisée

    4.6.1. Installation automatisée avec l'installateur Debian

4.7. Vérifier l'authenticité des fichiers d'installation

4.1. images d'installation Debian GNU/Linux officielles

La méthode la plus facile pour installer Debian GNU/Linux est sûrement celle
utilisant les images officielles. Consultez la page des vendeurs de CD pour les
acheter. Vous pouvez aussi télécharger les images ISO à partir d'un miroir
Debian et fabriquer vos propres CD ou DVD, si vous avez une connexion rapide et
un graveur (cf. la page Debian sur CD et DVD et la FAQ Debian CD pour des
instructions détaillées). Si vous possédez un jeu de disques optiques et si
votre machine peut s'amorcer à partir de l'un d'eux, ce qui est le cas sur les
PC modernes, vous pouvez aller directement au Chapitre 5, Démarrer le système
d'installation ; un effort particulier a été fait pour s'assurer que les
fichiers les plus communément demandés soient présents sur les images des
premiers CD et DVD et qu'une installation élémentaire d'un bureau graphique
soit possible avec l’image du premier DVD, ou même du premier CD.

Les CD ayant une capacité de stockage limitée, tous les environnements
graphiques de bureau ne sont pas disponibles sur le premier CD. Certains
environnements demandent soit une connexion à internet pendant l'installation,
soit des CD supplémentaires.

De plus, gardez à l'esprit que si le support d'installation que vous utilisez
ne contient pas certains paquets, vous pourrez toujours les installer après, à
partir de votre nouveau système Debian fraîchement installé. Si vous cherchez
sur quelle image se trouve un paquet, vous pouvez utiliser https://
cdimage-search.debian.org/.

Si vous disposez d'un jeu de CD ou DVD alors que votre machine ne sait pas
amorcer à partir d'un disque optique (certains PC très anciens), vous pouvez
utiliser une autre stratégie, par exemple un disque dur, une clé USB, un
démarrage par le réseau, ou bien encore, le chargement du noyau à partir du
disque pour lancer l'installateur. Les fichiers requis pour ces différents
amorçages sont aussi sur le disque ; l'archive réseau de Debian et
l'organisation des répertoires du disque sont identiques. Ainsi, lorsqu'un
chemin d'archive est demandé pour un fichier particulier requis pour amorcer,
cherchez ce fichier dans le même répertoire ou sous-répertoire de votre support
d'installation.

Une fois l'installateur amorcé, il est capable d'obtenir tous les autres
fichiers nécessaires à partir du disque.

Si vous n'avez pas de support d'installation, il sera nécessaire de télécharger
les fichiers du système d'installation et de les placer sur un disque dur, une
clé USB ou un ordinateur connecté que vous pourrez utiliser pour amorcer
l'installateur.

4.2. Télécharger les fichiers depuis les miroirs Debian

Pour trouver le miroir le plus proche (et sans doute le plus rapide), voyez la
liste des miroirs Debian.

4.2.1. Où trouver les fichiers d'installation ?

Sur tous les miroirs Debian, les fichiers pour l'installation sont situés dans
le répertoire debian/dists/bullseye/main/installer-amd64/current/images/ -- le
fichier MANIFEST liste toutes les images.

4.3. Préparation des fichiers pour un amorçage avec une clé USB

To prepare the USB stick, we recommend to use a system where GNU/Linux is
already running and where USB is supported. With current GNU/Linux systems the
USB stick should be automatically recognized when you insert it. If it is not
you should check that the usb-storage kernel module is loaded. When the USB
stick is inserted, it will be mapped to a device named /dev/sdX, where the « X
 » is a letter in the range a-z. You should be able to see to which device the
USB stick was mapped by running the command lsblk before and after inserting
it. (The output of dmesg (as root) is another possible method for that.) To
write to your stick, you may have to turn off its write protection switch.

Avertissement

The procedures described in this section will destroy anything already on the
device! Make very sure that you use the correct device name for your USB stick.
If you use the wrong device the result could be that all information on, for
example, a hard disk is lost.

4.3.1. Préparation d'une clé USB utilisant une image hybride de CD ou DVD

Debian installation images for this architecture are created using the 
isohybrid technology; that means they can be written directly to a USB stick,
which is a very easy way to make an installation media. Simply choose an image
(such as the netinst, CD or DVD-1) that will fit on your USB stick. See
Section 4.1, « images d'installation Debian GNU/Linux officielles » to get an
installation image.

Pour les clés de très petite taille (quelques mégaoctets), vous pouvez
télécharger l'image mini.iso qui se trouve dans le répertoire netboot (son
adresse précise est mentionnée dans la Section 4.2.1, « Où trouver les fichiers
d'installation ? »)

L'image d'installation que vous avez choisie peut être transférée directement
sur la clé. Toutes les données existantes sont détruites. Par exemple, avec un
système GNU/Linux, après avoir vérifié que la clé n'est pas montée, vous pouvez
copier l'image de cette manière :

# cp debian.iso /dev/sdX
# sync

Des informations sur la méthode à utiliser avec d'autres systèmes
d'exploitation sont disponibles à la page de la FAQ de Debian CD.

Important

L'image doit être copiée sur le disque complet, et pas sur une partition. Par
exemple /dev/sdb et non pas /dev/sdb1. N'utilisez pas d'outils qui modifient
l'image, tels que unetbootin.

Important

Cette façon de faire devrait convenir à la plupart des utilisateurs. Les
méthodes qui suivent sont plus complexes et sont destinées à des utilisateurs
aux besoins spécifiques.

L'image hybride n'occupe pas toute la place sur la clé. Si vous n'avez qu'une
seule clé ou si vous souhaitez mettre tout ce qui vous est nécessaire sur un
seul périphérique, il peut être intéressant d'utiliser l'espace libre pour
stocker d'autres fichiers, microprogrammes, paquets, etc.

To do so, use cfdisk or any other partitioning tool to create an additional
partition on the stick. Then create a (FAT) filesystem on the partition, mount
it and copy or unpack the firmware onto it, for example with:

# mkdosfs -n FIRMWARE /dev/sdX3
# mount /dev/sdX3 /mnt
# cd /mnt
# tar zxvf /path/to/firmware.tar.gz
# cd /
# umount /mnt

Take care that you use the correct device name for your USB stick. The mkdosfs
command is contained in the dosfstools Debian package.

Note

If you have chosen the mini.iso to be written to the USB stick, the second
partition doesn't have to be created, as - very nicely - it will already be
present. Unplugging and replugging the USB stick should make the two partitions
visible.

4.3.2. Copie des fichiers -- méthode simple

Prior to isohybrid technology being used for Debian installation images, the
methods documented in the chapters below were used to prepare media for booting
from USB devices. These have been superseded by the technique in Section 4.3.1,
« Préparation d'une clé USB utilisant une image hybride de CD ou DVD », but
have been left here for educational and historical purposes and in case they
are useful to some user.

An alternative to the method described in Section 4.3.1, « Préparation d'une
clé USB utilisant une image hybride de CD ou DVD » is to manually copy the
installer files, and also an installation image to the stick. Note that the USB
stick should be at least 1 GB in size (smaller setups are possible using the
files from netboot, following Section 4.3.3, « Copie des fichiers -- méthode
détaillée »).

There is an all-in-one file hd-media/boot.img.gz which contains all the
installer files (including the kernel) as well as syslinux and its
configuration file.

Note

Bien que pratique, cette méthode possède un inconvénient majeur : la taille
logique du périphérique est limitée à 1 Go, même si la capacité de la clé est
supérieure. Pour retrouver la taille réelle, il vous faudra repartitionner la
clé et créer un nouveau système de fichiers.

Simply extract this image directly to your USB stick:

# zcat boot.img.gz > /dev/sdX

After that, mount the USB memory stick (mount /dev/sdX /mnt), which will now
have a FAT filesystem on it, and copy a Debian ISO image (netinst or full CD;
see Section 4.1, « images d'installation Debian GNU/Linux officielles ») to it.
Unmount the stick (umount /mnt) and you are done.

4.3.3. Copie des fichiers -- méthode détaillée

Si vous aimez la souplesse d'utilisation ou si vous voulez simplement savoir ce
qui se passe, vous pouvez utiliser la méthode suivante pour placer les fichiers
sur la clé. L'un des avantages de cette méthode est que, si la capacité de la
clé est suffisante, vous pouvez copier n'importe quelle image ISO (même d'un
DVD).

4.3.3.1. Partitioning and adding a boot loader

Nous montrerons comment utiliser seulement la première partition, au lieu de
tout le périphérique.

Pour pouvoir lancer le noyau après l'amorçage sur la clé, nous y installons un
programme d'amorçage. Tous les programmes d'amorçage fonctionnent, mais
syslinux est préférable car il utilise une partition FAT16 et peut être
reconfiguré en modifiant un simple fichier texte. On peut modifier la
configuration du programme d'amorçage avec tous les systèmes d'exploitation qui
acceptent le système de fichiers FAT.

First, you need to install the syslinux and mtools packages on your system.

Note

Since most USB sticks come pre-configured with a single FAT16 partition, you
probably won't have to repartition or reformat the stick. If you have to do
that anyway, use cfdisk or any other partitioning tool to create a FAT16
partition now^[3], and then install an MBR using:

# cat /usr/lib/syslinux/mbr/mbr.bin
>/dev/sdX

Now create the filesystem using:

# mkdosfs /dev/sdX1

Take care that you use the correct device name for your USB stick. The mkdosfs
command is contained in the dosfstools Debian package.

Having a correctly partitioned USB stick (now), you need to put syslinux on the
FAT16 partition with:

# syslinux /dev/sdX1

Again, take care that you use the correct device name. The partition must not
be mounted when starting syslinux. This procedure writes a boot sector to the
partition and creates the file ldlinux.sys which contains the boot loader code.

4.3.3.2. Adding the installer files

There are two different installation variants to choose here: The hd-media
variant needs an installation ISO file on the stick, to load installer modules
and the base system from. The netboot installer however will load all that from
a Debian mirror.

According to your choice, you have to download some installer files from the
hd-media or netboot subdirectory of debian/dists/bullseye/main/installer-amd64/
current/images/ on any Debian mirror:

  • vmlinuz or linux (kernel binary)

  • initrd.gz (initial ramdisk image)

You can choose between either the text-based version of the installer (the
files can be found directly in hd-media or netboot) or the graphical version
(look in the respective gtk subdirectories).

Then mount the partition (mount /dev/sdX1 /mnt) and copy the downloaded files
to the root directory of the stick.

Next you should create a text file named syslinux.cfg in the root directory of
the stick as configuration file for syslinux, which at a bare minimum should
contain the following line:

default vmlinuz initrd=initrd.gz

Change the name of the kernel binary to « linux » if you used files from
netboot.

For the graphical installer (from gtk) you should add vga=788 at the end of the
line. Other parameters can be appended as desired.

Pour que l'invite d'amorçage permette l'ajout de paramètres, créez une ligne
prompt 1.

If you used files from hd-media, you should now copy the ISO file of a Debian
installation image onto the stick. (For the netboot variant this is not
needed.)

You can use either a netinst or a full CD/DVD image (see Section 4.1, « images
d'installation Debian GNU/Linux officielles »). Be sure to select one that fits
on your stick. Note that the « netboot mini.iso » image is not usable for this
purpose.

When you are done, unmount the USB memory stick (umount /mnt).

4.4. Préparer les fichiers pour amorcer depuis un disque dur

L'installateur peut être amorcé avec les fichiers d'amorçage placés sur une
partition existante du disque dur ; il peut être aussi lancé depuis un autre
système d'exploitation ou en invoquant un programme d'amorçage depuis le BIOS.
Sur les systèmes récents avec UEFI, le noyau peut être amorcé directement
depuis la partition UEFI, sans nécessiter de programme d'amorçage.

Cette technique permet une installation complète à travers le réseau. Cela
évite toutes les manipulations pénibles des supports amovibles, comme de
trouver puis de graver des images de CD ou DVD.

4.4.1. Démarrage du programme d'installation depuis Linux avec GRUB

Cette section explique comment ajouter ou remplacer une partition Linux
existante en utilisant GRUB.

Lors du démarrage, GRUB permet de charger en mémoire non seulement le noyau,
mais également une image de disque. Cette image en mémoire peut être utilisée
en tant que système de fichiers racine par le noyau.

Copiez les fichiers suivants de l'archive Debian sur votre disque dur, par
exemple dans /boot/newinstall/.

  • vmlinuz (noyau binaire)

  • initrd.gz (disque virtuel initial)

Si vous voulez utiliser le disque seulement pour l'amorçage et ensuite utiliser
le réseau pour télécharger tous les paquets, vous devez récupérer le fichier
netboot/debian-installer/amd64/initrd.gz et le noyau qui lui correspond,
netboot/debian-installer/amd64/linux. Vous pourrez ainsi repartitionner le
disque sur lequel se trouve l'installateur. Toutefois cette opération demande
la plus grande prudence.

Si vous voulez préserver une partition de ce disque, vous pouvez télécharger le
fichier hd-media/initrd.gz et le noyau correspondant hd-media/vmlinuz ; copiez
aussi une image d'installation sur le disque dur (assurez-vous que le nom de
cette image se termine par .iso). L'installateur peut alors se lancer à partir
du disque dur et s'installer à partir de cette image, sans avoir besoin du
réseau.

Et pour configurer le programme d'amorçage, continuez avec la Section 5.1.5,
« Amorcer à partir de Linux avec GRUB ».

4.4.2. Démarrage du programme d'installation depuis DOS avec loadlin

Voici comment préparer le disque dur pour démarrer l'installateur à partir de
DOS avec loadlin.

Copiez les fichiers suivants d'une image d'installation de Debian dans c:\.

  • /install.amd (noyau et disque mémoire)

  • /tools (loadlin)

4.5. Préparer les fichiers pour amorcer depuis le réseau avec TFTP

Si votre machine est connectée à un réseau local, vous pouvez l'amorcer
directement à partir d'une autre machine de ce réseau en utilisant TFTP. Pour
cela, les fichiers d'amorçage doivent être placés à un endroit spécifique de
cette machine et celle-ci doit savoir amorcer votre machine.

Vous devez configurer un serveur TFTP et, pour beaucoup de machines, un serveur
DHCP ou un serveur BOOTP.

BOOTP est un protocole IP qui indique à un ordinateur quelle est son adresse IP
et lui dit où obtenir sur le réseau une image d'amorçage. Le protocole DHCP
(« Dynamic Host Configuration Protocole », Protocole de configuration dynamique
des hôtes) est une extension bien plus flexible de BOOTP (et respectant la
rétrocompatibilité). Certains systèmes ne peuvent être configurés que par DHCP.

Le protocole trivial de transfert de fichiers (Trivial File Transfert Protocol,
TFTP) est utilisé pour transférer l'image d'amorçage au client. Théoriquement,
tout serveur sur les plates-formes qui implémentent ces protocoles peut être
utilisé. Dans les exemples qui vont suivre, on donnera les commandes pour
SunOS 4.x, SunOS 5.x (mieux connu sous le nom de Solaris) et GNU/Linux.

Note

Pour un serveur Debian nous recommandons tftpd-hpa. C'est un logiciel écrit par
l'auteur du programme syslinux, ce qui est un gage de qualité. Une autre
possibilité est le programme atftpd.

4.5.1. Configurer un serveur DHCP

Il existe un serveur DHCP libre, dhcpd ISC. Pour Debian GNU/Linux, le paquet
isc-dhcp-server est recommandé. Voici un exemple de fichier de configuration
(habituellement /etc/dhcp/dhcpd.conf) :

option domain-name "example.com";
option domain-name-servers ns1.example.com;
option subnet-mask 255.255.255.0;
default-lease-time 600;
max-lease-time 7200;
server-name "servername";

subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.200 192.168.1.253;
  option routers 192.168.1.1;
}

host clientname {
  filename "/tftpboot.img";
  server-name "servername";
  next-server servername;
  hardware ethernet 01:23:45:67:89:AB;
  fixed-address 192.168.1.90;
}

Dans cet exemple, le serveur servername joue le rôle de serveur DHCP, serveur
TFTP et passerelle réseau. Vous devrez certainement changer les options
concernant le nom de domaine ainsi que le nom du serveur et l'adresse
matérielle du client. L'option filename devrait être le nom du fichier extrait
par TFTP.

Après avoir modifié le fichier de configuration de dhcpd, relancez dhcpd avec /
etc/init.d/isc-dhcp-server restart.

4.5.1.1. Amorçage PXE et configuration de DHCP

Voici un autre exemple de fichier dhcp.conf utilisant la méthode de chargement
du système d'exploitation par le réseau gérée par le matériel (« Pre-boot
Execution Environment » ou PXE) de TFTP :

option domain-name "example.com";

default-lease-time 600;
max-lease-time 7200;

allow booting;
allow bootp;

# Le paragraphe suivant doit être modifié pour correspondre à votre système
subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.200 192.168.1.253;
  option broadcast-address 192.168.1.255;
# L'adresse de la passerelle peut être différente
# (accès à internet par exemple)
  option routers 192.168.1.1;
# Indiquez le DNS que vous voulez utiliser
  option domain-name-servers 192.168.1.3;
}

group {
  next-server 192.168.1.3;
  host tftpclient {
# Adresse matérielle du client TFTP
  hardware ethernet  00:10:DC:27:6C:15;
  filename "pxelinux.0";
 }
}

Pour un démarrage PXE, le fichier du client pxelinux.0 est un programme
d'amorçage et non une image du noyau (voir la Section 4.5.4, « Mettre les
images TFTP en place » ci-dessous).

Si votre machine utilise UEFI pour démarrer, vous devrez spécifier un
gestionnaire d'amorçage adapté à l'UEFI, par exemple :

group {
  next-server 192.168.1.3;
  host tftpclient {
# Adresse matérielle du client TFTP
  hardware ethernet  00:10:DC:27:6C:15;
  filename "debian-installer/amd64/bootnetx64.efi";
 }
}

4.5.2. Configurer un serveur BOOTP

Il existe deux serveurs BOOTP pour GNU/Linux, bootpd CMU et dhcpd ISC ; le
second est en fait un serveur DHCP. On peut trouver ces serveurs dans les
paquets bootp et isc-dhcp-server de Debian GNU/Linux.

Pour utiliser bootpd CMU, vous devez commencer par décommenter (ou ajouter) la
ligne adéquate dans /etc/inetd.conf. Dans Debian GNU/Linux, vous pouvez tout
simplement lancer update-inetd --enable bootps suivi de /etc/init.d/inetd
reload pour le faire. Au cas où le serveur BOOTP ne fonctionnerait pas sous
Debian, la ligne en question devrait ressembler à :

bootps  dgram  udp  wait  root  /usr/sbin/bootpd  bootpd -i -t 120

Maintenant, vous devez créer le fichier /etc/bootptab qui utilise le même genre
de format familier et cryptique que les bons vieux fichiers BSD printcap,
termcap et disktab. Voyez la page de manuel de bootptab pour d'autres
informations. Pour bootpd CMU, il sera nécessaire d'obtenir l'adresse
matérielle (MAC) du client. Voici un exemple du fichier /etc/bootptab :

client:\
  hd=/tftpboot:\
  bf=tftpboot.img:\
  ip=192.168.1.90:\
  sm=255.255.255.0:\
  sa=192.168.1.1:\
  ha=0123456789AB:

Vous devrez changer au moins l'option « ha » qui spécifie l'adresse matérielle
du client. L'option « bf » spécifie le fichier que le client devra récupérer
par TFTP ; cf. Section 4.5.4, « Mettre les images TFTP en place » pour plus de
précisions.

En comparaison, configurer BOOTP avec dhcpd ISC est très facile parce qu'il
traite les clients BOOTP comme des clients DHCP légèrement spéciaux. Certaines
architectures requièrent une configuration complexe pour amorcer les clients
par BOOTP. Si la vôtre en fait partie, lisez la Section 4.5.1, « Configurer un
serveur DHCP ». Sinon, il suffit simplement de modifier le fichier /etc/dhcp/
dhcpd.conf et d'ajouter la directive allow bootp au bloc de configuration pour
le sous-réseau contenant le client, puis de redémarrer dhcpd avec /etc/init.d/
isc-dhcp-server restart.

4.5.3. Activer le serveur TFTP

Pour faire fonctionner le serveur TFTP, vous devez vous assurer au préalable
que tftpd est activé.

Pour tftpd-hpa, il y a deux façons de lancer le service. Il peut être activé à
la demande par le démon inetd du système, ou bien il peut être exécuté en tant
que démon indépendant. Le choix de la méthode se fait à l'installation du
paquet et peut être modifié en le reconfigurant.

Note

Les serveurs TFTP utilisaient habituellement le répertoire /tftpboot pour
stocker les images. Cependant les paquets Debian GNU/Linux se servent d'autres
répertoires pour obéir au standard sur l'organisation des fichiers. Par
exemple, tftpd-hpa utilise par défaut /srv/tftp. Vous aurez à modifier les
exemples de cette section.

Toutes les alternatives à in.tftpd disponibles dans Debian doivent enregistrer
les requêtes TFTP dans le journal du système. Quelques unes acceptent une
option -v qui augmente la quantité d'informations enregistrées. En cas d'erreur
d'amorçage, il est recommandé de consulter ces enregistrements pour rechercher
les causes des erreurs.

4.5.4. Mettre les images TFTP en place

Ensuite, placez les images TFTP dont vous avez besoin (décrites dans la
Section 4.2.1, « Où trouver les fichiers d'installation ? ») dans le répertoire
des images d'amorçage de tftpd. Généralement, ce répertoire s'appelle /
tftpboot. Vous aurez à faire un lien depuis ce fichier vers le fichier que 
tftpd utilisera pour amorcer le client. Malheureusement, le nom du fichier est
déterminé par le client TFTP et il n'y a pas vraiment de standard.

Pour le démarrage PXE, tout ce dont vous avez besoin est dans l'archive netboot
/netboot.tar.gz. Extrayez les fichiers dans le répertoire des images de tftpd.
Assurez-vous que le serveur DHCP donnera bien le fichier pxelinux.0 comme
fichier d'amorçage à tftpd. Pour les machines avec UEFI, vous devrez vous
assurer de donner un nom adapté à l'image (par exemple /debian-installer/amd64/
bootnetx64.efi).

4.6. Installation automatisée

Pour installer Debian sur de nombreux ordinateurs, il est possible
d'automatiser complètement l'installation en utilisant les paquets Debian
suivants : fai-quickstart (qui utilise un serveur d'installation), et
l'installateur Debian lui-même. Consultez la page de FAI pour d'autres
informations.

4.6.1. Installation automatisée avec l'installateur Debian

L'installateur Debian peut automatiser des installations grâce à des fichiers
de préconfiguration. Un fichier de préconfiguration peut se trouver sur le
réseau ou sur un support amovible. Il sert à répondre aux questions qui seront
posées pendant l'installation.

Une bonne documentation, avec un fichier d'exemple que l'on peut modifier, se
trouve dans l'Annexe B, Automatisation de l'installation par préconfiguration.

4.7. Vérifier l'authenticité des fichiers d'installation

L'authenticité des fichiers d'installation peut être vérifiée grâce aux sommes
de contrôle inscrites dans les fichiers SHA256SUMS ou SHA512SUMS des miroirs
Debian. Ces fichiers sont dans les mêmes répertoires que les images
d'installation, aux adresses suivantes :

  • images de CD et leurs sommes de contrôle ;

  • images de DVD et leurs sommes de contrôle ;

  • images de disques Blu-ray et leurs sommes de contrôle ;

  • autres fichiers d'installation et leurs sommes de contrôle.

Pour vérifier les sommes de contrôle d'un fichier téléchargé, la sortie de la
commande

sha256sum fichier.iso

ou

sha512sum fichier.iso

doit être comparée à la valeur correspondante du fichier SHA256SUMS ou
SHA512SUMS.

La foire aux questions de Debian CD contient plus d'informations sur ce sujet
(en particulier le script check_debian_iso qui automatise partiellement la
procédure décrite ci-dessus), ainsi que des instructions pour vérifier
l'authenticité des fichiers de sommes de contrôle eux-mêmes.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[3] Don't forget to activate the « bootable » flag.

Chapitre 5. Démarrer le système d'installation

Table des matières

5.1. Démarrer l'installateur sur PC 64 bits

    5.1.1. Amorcer sur une clé USB
    5.1.2. Amorcer depuis un disque optique (CD ou DVD)
    5.1.3. Amorcer depuis Windows
    5.1.4. Amorcer depuis DOS avec loadlin
    5.1.5. Amorcer à partir de Linux avec GRUB
    5.1.6. Amorcer avec TFTP
    5.1.7. L'écran d'amorçage
    5.1.8. L'installateur graphique

5.2. Accessibilité

    5.2.1. Frontaux de l'installateur
    5.2.2. Les plages Braille USB
    5.2.3. Les plages Braille série
    5.2.4. Synthèse vocale logicielle
    5.2.5. Synthèse vocale matérielle
    5.2.6. Cartes fille
    5.2.7. Thème à fort contraste
    5.2.8. Zoom
    5.2.9. Modes d'installation Expert, Rescue et Automated
    5.2.10. Accessibilité du système installé

5.3. Paramètres d'amorçage

    5.3.1. Console d'amorçage
    5.3.2. Paramètres pour l'installateur Debian
    5.3.3. Répondre à des questions avec les paramètres d'amorçage
    5.3.4. Passer des paramètres aux modules du noyau
    5.3.5. Interdire des modules du noyau

5.4. Dysfonctionnements pendant la procédure d'installation

    5.4.1. Fiabilité des disques optiques
    5.4.2. Configuration d'amorçage
    5.4.3. Synthèse vocale logicielle
    5.4.4. Problèmes communs sur PC 64 bits
    5.4.5. Comprendre les messages du noyau au démarrage
    5.4.6. Signaler les problèmes
    5.4.7. Faire un rapport de bogue

5.1. Démarrer l'installateur sur PC 64 bits

Avertissement

Si vous voulez conserver les autres systèmes d'exploitation existants sur votre
machine, vous devez les éteindre avant de lancer l'installateur. L'installation
d'un système alors qu'un autre système a été mis en veille peut endommager ou
détruire l'état du système mis en veille.

Note

Voyez la Section 5.1.8, « L'installateur graphique » pour savoir comment
amorcer l'installateur graphique.

5.1.1. Amorcer sur une clé USB

Si votre machine peut amorcer depuis l'USB, cela sera la méthode la plus
simple. Supposons que tout a été préparé comme l'expliquent la Section 3.6.2,
« Sélection du périphérique d'amorçage » et la Section 4.3, « Préparation des
fichiers pour un amorçage avec une clé USB ». Branchez maintenant votre clé USB
dans un port libre et relancez la machine. Le système devrait se lancer et,
sauf si vous avez utilisé la méthode flexible pour créer la clé et que vous ne
l'avez pas activée, un menu d'amorçage devrait apparaître (sur les matériels
pris en charge). Maintenant, vous pouvez choisir différentes options de
l'installateur, ou simplement appuyer sur la touche Entrée.

5.1.2. Amorcer depuis un disque optique (CD ou DVD)

La manière la plus simple est d'utiliser les disques optiques Debian. Si vous
en avez un jeu et si votre machine peut s'amorcer depuis ces disques, c'est
parfait ! Il suffit de configurer votre système pour amorcer depuis un disque
optique (voyez la Section 3.6.2, « Sélection du périphérique d'amorçage »), de
placer votre disque et de réamorcer. Vous pouvez continuer avec le chapitre
suivant.

Notez que certains lecteurs de disques optiques peuvent nécessiter des pilotes
particuliers et sont donc inaccessibles au tout début de l'installation. Si
cette façon d'installer échoue, veuillez lire dans ce chapitre les paragraphes
sur les autres noyaux et sur les autres méthodes d'installation possibles.

Même si vous ne pouvez pas amorcer depuis un disque optique, vous pourrez
probablement installer les composants du système ou les paquets que vous voulez
à partir de ce disque. Amorcez simplement à partir d'un autre support.
Lorsqu'arrivera le moment d'installer le système d'exploitation, le système de
base et les paquets, faites pointer le système d'installation sur le lecteur
optique.

Si vous avez des problèmes lors de l'amorçage, voyez la Section 5.4,
« Dysfonctionnements pendant la procédure d'installation ».

5.1.3. Amorcer depuis Windows

Pour lancer l'installateur à partir de Windows, vous devez

  • disposer d'un support d'installation, comme décrit dans la Section 4.1,
    « images d'installation Debian GNU/Linux officielles » ou la Section 4.3,
    « Préparation des fichiers pour un amorçage avec une clé USB ».

  • ou télécharger un exécutable Windows autonome, disponible dans le fichier
    tools/win32-loader/stable/win32-loader.exe sur les miroirs Debian.

Quand vous insérez le disque, un programme de pré-installation doit normalement
être lancé. Si Windows ne l'exécute pas ou si vous utilisez une clé USB, vous
pouvez le lancer vous-même en exécutant la commande setup.exe sur le
périphérique.

Ce programme pose quelques questions préliminaires et prépare le système pour
le lancement de l'installateur Debian GNU/Linux.

5.1.4. Amorcer depuis DOS avec loadlin

Démarrez sur MS-DOS (pas sur Windows). Vous pouvez par exemple démarrer sur un
disque de dépannage ou de diagnostic.

Si vous pouvez accéder au CD d'installation, modifiez le lecteur courant pour
le lecteur de CD, par exemple :

d:

Sinon, modifiez le lecteur courant pour le disque dur que vous avez
préalablement préparé selon la méthode expliquée dans la Section 4.4.2,
« Démarrage du programme d'installation depuis DOS avec loadlin ».

Allez dans le répertoire de la variante choisie, par exemple :

cd \install.amd

Si vous préférez le mode graphique de l'installateur, allez dans le
sous-répertoire gtk :

cd gtk

Puis lancez la commande install.bat. Le noyau sera chargé et l'installateur
lancé.

5.1.5. Amorcer à partir de Linux avec GRUB

Pour amorcer l'installateur sur un disque dur, vous devez d'abord télécharger
les fichiers et les installer comme l'explique la Section 4.4, « Préparer les
fichiers pour amorcer depuis un disque dur ».

Il y a deux paramètres essentiels à configurer pour GRUB2 dans le fichier /boot
/grub/grub.cfg :

  • le chargement du initrd.gz de l'installateur à l'amorçage ;

  • l'utilisation d'un disque virtuel comme partition racine par vmlinuz du
    noyau.

Une entrée pour l'installateur ressemblerait à :

menuentry 'New Install' {
insmod part_msdos
insmod ext2
set root='(hd0,msdos1)'
linux /boot/newinstall/vmlinuz
initrd /boot/newinstall/initrd.gz
}

5.1.6. Amorcer avec TFTP

Pour amorcer depuis le réseau, il vous faut une connexion au réseau et un
serveur TFTP (et aussi, sûrement, un serveur DHCP, RARP ou BOOTP pour la
configuration automatique du réseau).

L'installation côté serveur pour l'amorçage depuis le réseau est décrite dans
la Section 4.5, « Préparer les fichiers pour amorcer depuis le réseau avec
TFTP ».

Il y a plusieurs façons d'amorcer avec TFTP sur une machine i386.

5.1.6.1. Carte réseau ou carte mère avec PXE

Il est possible que votre interface réseau ou votre carte mère permette
l'amorçage PXE. C'est une réimplémentation de l'amorçage TFTP par Intel (tm).
Dans ce cas, vous pourrez configurer votre BIOS ou l'UEFI pour qu'il s'amorce
sur le réseau.

5.1.6.2. Carte réseau avec ROM de démarrage réseau

Une carte d'interface réseau peut offrir la possibilité de démarrer par TFTP.

5.1.6.3. Etherboot

Le projet etherboot offre des disquettes d'amorçage et même des ROM qui
permettent l'amorçage par TFTP.

5.1.7. L'écran d'amorçage

Lorsque l'installateur démarre, vous devriez voir un sympathique écran qui
montre le logo Debian et un menu :

Debian GNU/Linux installer boot menu

Graphical install
Install
Advanced options                            >
Accessible dark contrast installer menu     >
Help
Install with speech synthesis

Note

Cet écran sera différent selon le mode d'amorçage de votre système (BIOS ou
UEFI) mais les mêmes options vous seront présentées.

En fonction de la méthode d'installation, l'option « Graphical install »
(installateur graphique) pourrait ne pas être disponible. Les images
multiarchitectures ont aussi une variante 64 bits pour chaque option
d'installation, ce qui double presque le nombre d'options.

Pour une installation normale, sélectionnez l'entrée « Graphical install » ou
l'entrée « Install » en utilisant les touches avec flèche du clavier ou en
tapant la première lettre en surbrillance. L'entrée « Install » est
pré-sélectionnée. Vous pouvez maintenant appuyer sur la touche Entrée pour
lancer l'installateur.

L'entrée « Advanced options » donne accès à un second menu qui permet d'amorcer
l'installateur en mode « expert » ou mode « rescue ». Il est aussi utilisé pour
les installations automatisées.

Si vous voulez ajouter des paramètres d'amorçage pour l'installateur ou pour le
noyau, appuyez sur la touche Tab (amorçage BIOS) ou e puis flèche du bas trois
fois, puis Fin (amorçage UEFI). La commande d'amorçage pour l'entrée du menu
choisie est affichée et il est permis d’ajouter des options. Veuillez noter
qu'à ce moment, le clavier est toujours en configuration QWERTY. Les écrans
d'aide listent les principales options possibles. Appuyez sur la touche Entrée
(BIOS) ou F10 (UEFI) pour lancer l'installateur avec vos options. Pour revenir
au menu et annuler toutes vos saisies, appuyez sur la touche Esc.

Quand vous sélectionnez l'entrée « Help », un premier écran présente tous les
écrans d'aide disponibles. Une fois dans l'aide, pour revenir au menu
d'amorçage, saisissez « menu » à l'invite d'amorçage et validez avec la touche 
Entrée. Tous les écrans d'aide ont une invite permettant de saisir une
commande :

Press F1 for the help index, or ENTER to boot:

Vous pouvez alors appuyer sur la touche Entrée pour amorcer l'installateur avec
les options par défaut ou bien saisir une commande particulière avec les
paramètres d'amorçage nécessaires. Les écrans d'aide listent certains
paramètres utiles. Si vous ajoutez des paramètres à la ligne de commande,
n'oubliez pas d'indiquer la méthode d'amorçage (la valeur par défaut est
install) et un espace avant le premier paramètre (par exemple, install fb=false
).

Note

Le clavier à cet instant est supposé être un clavier de type « American English
 ». Si votre carte clavier est agencée autrement, les caractères affichés sur
l'écran seront parfois différents de ceux que vous saisissez. Il existe sur
Wikipedia un schéma de la carte clavier US qui peut vous aider à saisir les
bons caractères.

Note

Si le BIOS du système est configuré pour utiliser une console série, il se peut
que l'écran graphique initial ne s'affiche pas au moment de l'amorçage de
l'installateur, ni le menu d'amorçage. Cela peut aussi arriver si vous
installez le système depuis une machine distante qui offre une interface texte
à la console VGA, par exemple la console texte « integrated Lights Out » (iLO)
de Compaq ou la « Integrated Remote Assistant » (IRA) de HP.

Pour sauter l'écran d'amorçage graphique, vous pouvez appuyer sur la touche Esc
pour obtenir l'invite d'amorçage en mode texte, ou appuyer sur la touche « H »
puis sur la touche Entrée pour sélectionner l'option « Help » décrite plus
haut. Toute saisie sera alors affichée sur la ligne d'invite. Pour empêcher
l'installateur d'utiliser le tampon vidéo dans la suite de l'installation, vous
pouvez ajouter le paramètre vga=normal fb=false à l'invite d'amorçage.

5.1.8. L'installateur graphique

La version graphique de l'installateur n'est disponible que sur certaines
architectures, dont PC 64 bits . Les fonctionnalités de l'installateur
graphique sont essentiellement les mêmes que celles de l'installateur en mode
texte. Ils utilisent les mêmes programmes mais l'interface est différente.

Malgré cette similitude, l'installateur graphique possède quelques avantages.
Le principal est qu'il reconnaît plus de langues, notamment celles qui
utilisent des jeux de caractères impossibles à afficher avec l'interface « newt
 ». Un autre avantage est la possibilité d'utiliser une souris. De même,
plusieurs questions peuvent être réunies dans un seul écran.

L'installateur graphique est disponible avec toutes les images CD ou DVD et
avec la méthode d'installation « hd-media ». Il peut être amorcé avec l'option
existante dans le menu d'amorçage. Dans le menu « Advanced options », on peut
choisir les modes expert et rescue. Les méthodes précédentes, installgui,
expertgui et rescuegui sont toujours disponibles au moment de l'amorçage si
l'on sélectionne l'option « Help ».

Il est aussi possible d'amorcer sur le réseau une image de l'installateur
graphique. Et il existe une image ISO spéciale ^[4], qui est utile surtout pour
les tests.

Comme pour l'installateur texte, il est possible d'ajouter des paramètres
d'amorçage au lancement de l'installateur graphique.

Note

L'installateur graphique exige beaucoup plus de mémoire que l'installateur
texte : 810 Mo. S'il n'y a pas assez de mémoire, l'installateur reviendra à
l'interface « newt ».

Si la quantité de mémoire du système est inférieure à 780 Mo, il se peut que
l'installateur graphique ne fonctionne plus mais que l'installateur texte
fonctionne encore. Pour des systèmes avec peu de mémoire, il est recommandé
d'utiliser l'installateur texte.

5.2. Accessibilité

Certaines personnes ont besoin d'une aide spéciale, par exemple à cause d'une
déficience visuelle. Les plages Braille USB sont détectées automatiquement
(sauf les plages série connectées grâce à un convertisseur série vers USB),
mais la plupart des autres fonctionnalités doivent être activées explicitement.
Sur certaines machines, le menu d'amorçage sonne quand la frappe des touches
est possible. Il émet un bip sur les systèmes avec BIOS, et deux bips sur les
systèmes avec UEFI. Des paramètres d'amorçage peuvent alors être ajoutés pour
activer les fonctions d'accessibilité (voir aussi la Section 5.1.7, « L'écran
d'amorçage »). Remarquez que, sur la plupart des architectures, le programme
d'amorçage considère le clavier comme un clavier QWERTY.

5.2.1. Frontaux de l'installateur

L'installateur prend en charge différents frontaux pour poser des questions :
en particulier text utilise le texte brut alors que newt utilise des boîtes de
dialogues basées sur du texte. Le choix peut être fait à l’invite du démarrage.
Veuillez consulter la documentation de DEBIAN_FRONTEND dans la Section 5.3.2,
« Paramètres pour l'installateur Debian ».

With the newt front-end (used mostly with braille), one mostly just selects
answers with arrow keys and presses Entrée to validate the choice. Pressing Tab
or Shift - Tab allows to switch between dialog elements, and notably to access
the Go Back button, which brings back again to previous questions. Some dialogs
contain check boxes, which can be ticked on and off by pressing Space.

With the text front-end (used mostly with speech), one mostly selects answers
by typing their number followed by pressing Entrée. One can also not type
anything and just press Entrée to simply accept the default value. Typing < and
pressing Entrée brings back again to previous questions. When a selection of
choices has to be made (e.g. during task selection), one can type ! to express
an empty selection.

5.2.2. Les plages Braille USB

Les plages Braille USB sont détectées automatiquement. Une version en mode
texte de l'installateur est automatiquement sélectionnée et la table Braille
sera automatiquement installée sur le système cible. Il suffit de presser la
touche Entrée au menu d'amorçage. Une fois brltty lancé, vous pouvez choisir
une table Braille en entrant dans le menu des préférences. Sur le site web de
brltty, on peut trouver une documentation sur l'affectation des touches.

5.2.3. Les plages Braille série

Les plages Braille série ne peuvent pas être détectées automatiquement et de
manière sûre car la détection peut les endommager. Vous devez donc ajouter le
paramètre d'amorçage brltty=pilote,port pour indiquer à brltty le pilote et le
port à utiliser. pilote doit être remplacé par le code à deux lettres de votre
terminal. Consultez le manuel de BRLTTY. port doit être remplacé par le nom du
port série auquel est connecté le périphérique. ttyS0 est le port par défaut et
ttyUSB0 peut être utilisé pour un convertisseur série vers USB. Un troisième
paramètre peut être fourni pour choisir le nom de la table Braille à utiliser.
Consultez le manuel de BRLTTY. La table anglaise est choisie par défaut. Mais
vous pouvez la changer en entrant dans le menu des préférences. Certains
modèles nécessitent de passer un quatrième paramètre au pilote, par exemple
protocol=toto. Sur le site web de brltty on peut trouver une documentation sur
l'affectation des touches.

5.2.4. Synthèse vocale logicielle

La synthèse vocale logicielle est disponible sur toutes les images
d'installation qui contiennent l'installateur graphique, à savoir, les images
CD, DVD, netinst et la variante netbook gtk. Il est possible de l'activer en la
sélectionnant dans le menu d'amorçage par s, puis touche Entrée. La version
texte de l'installateur sera automatiquement choisie et la synthèse vocale
logicielle installée sur le système cible.

Si plusieurs cartes son sont détectées, il vous sera demandé de la sélectionner
en appuyant sur Entrée lorsque vous entendrez la voix par la carte voulue.

La première question (sur la langue) est dite en anglais. La suite de
l'installation se passe dans la langue choisie, si elle est disponible dans
espeak.

Par défaut, la vitesse de la voix est très faible. Pour l'accélérer, appuyez
sur les touches CapsLock+6. Pour la ralentir, CapsLock+5. Le volume est moyen.
Pour l'augmenter, appuyez sur les touches CapsLock+2. Pour le baisser, CapsLock
+1. Consultez le Speakup guide pour des précisions sur les raccourcis
disponibles. Pour accepter la réponse par défaut à une question, appuyez
simplement sur Entrée. Pour fournir une réponse vide à une question, saisissez
! à l'invite. Pour retourner à la question précédente, saisissez < à l'invite.

5.2.5. Synthèse vocale matérielle

La synthèse vocale matérielle est disponible sur toutes les images
d'installation qui contiennent l'installateur graphique, à savoir, les images
CD, DVD, netinst et la variante netbook gtk. Vous devez donc choisir une entrée
« Graphical install » dans le menu d'amorçage.

Les périphériques de synthèse vocale ne sont pas automatiquement détectés. Vous
devez donc ajouter le paramètre d'amorçage speakup.synth=driver pour indiquer à
speakup le pilote à utiliser. driver doit être remplacé par le code du pilote
de votre périphérique. Consultez la liste des codes de pilotes. La version en
mode texte de l'installateur est automatiquement sélectionnée et la gestion du
périphérique de synthèse vocale sera automatiquement activée sur le système
cible.

5.2.6. Cartes fille

Certains périphériques sont en fait des cartes fille qui sont enfichées dans la
machine et qui lisent le texte directement dans la mémoire vidéo. Pour les
faire fonctionner, la gestion du tampon vidéo doit être désactivée avec le
paramètre vga=normal fb=false. Mais cela réduit le nombre de langues
disponibles.

Il est possible d'activer une version texte du programme d'amorçage avant
d'ajouter le paramètre d'amorçage en saisissant h puis la touche Entrée.

5.2.7. Thème à fort contraste

Pour les utilisateurs ayant une vue basse, l'installateur propose un thème avec
des couleurs très contrastées qui le rend plus lisible. Pour l'activer,
utilisez l'entrée « Accessible high contrast » du menu d'amorçage, à laquelle
correspond le raccourci d, ou ajoutez le paramètre theme=dark.

5.2.8. Zoom

Pour les utilisateurs qui ont une mauvaise vue, l'installateur graphique
possède une fonction basique de zoom : les raccourcis Control++ et Control+-
augmentent ou réduisent la taille de police.

5.2.9. Modes d'installation Expert, Rescue et Automated

Les modes d'installation Expert, Rescue (récupération) et Automated
(automatisé) sont aussi disponibles avec les options d'accessibilité. Pour y
accéder, il faut d'abord choisir le sous-menu « Advanced options » du menu
d'amorçage en saisissant a. Dans le cas d'un système sous BIOS (le menu
d'amorçage n'aura émis qu'un seul bip), il faut aussi appuyer sur la touche 
Entrée ; avec un système UEFI (le menu d'amorçage aura émis deux bips) cela
n'est pas nécessaire. Ensuite, en appuyant sur la touche s (suivie de Entrée
sur les systèmes sous BIOS mais pas sous UEFI), la synthèse vocale est activée.
À partir de ce moment, plusieurs raccourcis peuvent être utilisés : x pour une
installation en mode expert, r pour le mode de récupération, et a pour
l'installation automatisée. Si un système sous BIOS est utilisé, chaque
raccourci doit être suivi de la touche Entrée.

Debian peut être aussi installée de façon automatique en utilisant la
préconfiguration. Cette préconfiguration peut être chargée après la sélection
des options d'accessibilité. Une documentation est disponible dans l'Annexe B, 
Automatisation de l'installation par préconfiguration.

5.2.10. Accessibilité du système installé

Une documentation sur l'accessibilité est disponible sur la page du wiki Debian
Accessibility.

5.3. Paramètres d'amorçage

Les paramètres d'amorçage sont des paramètres passés au noyau Linux pour
s'assurer que les périphériques seront correctement pris en compte. Dans la
plupart des cas le noyau détecte les périphériques, mais parfois vous devez
l'aider un peu.

Si c'est la première fois que vous démarrez le système, essayez les paramètres
par défaut ; autrement dit, ne donnez pas de paramètre et vérifiez que cela
fonctionne correctement. Ce devrait être le cas. Sinon, vous pouvez redémarrer
et donner les paramètres nécessaires à votre matériel.

Toutes les informations nécessaires sur les paramètres d'amorçage sont
disponibles dans le HOWTO Linux BootPrompt ; la présente section contient
seulement un résumé des paramètres les plus utilisés. Certains trucs sont
donnés dans la Section 5.4, « Dysfonctionnements pendant la procédure
d'installation ».

5.3.1. Console d'amorçage

Si vous démarrez avec la console série, le noyau la détecte automatiquement. Si
une carte vidéo (« framebuffer ») et un clavier sont également connectés à
l'ordinateur que vous voulez démarrer à l'aide de la console série, vous devrez
peut-être passer l'option console=device au noyau, où device est l'interface
série de la cible, c'est-à-dire quelque chose comme ttyS0.

Vous pouvez avoir besoin de spécifier certains paramètres du port série, par
exemple la vitesse ou la parité, console=ttyS0,9600n8 ; la valeur pour la
vitesse peut être aussi 57600 ou 115200. Assurez vous de spécifier cette option
après « --- » pour qu'elle soit copiée dans le gestionnaire d'amorçage du
système installé (si cela est pris en charge par l'installateur pour ce
gestionnaire d'amorçage).

Il est possible d'ajouter le paramètre TERM=type pour s'assurer que le type de
terminal utilisé par l'installateur corresponde à votre terminal.
L'installateur reconnaît les types de terminal suivants : linux, bterm, ansi,
vt102 et dumb. Pour la console série, le type utilisé est vt102. Si vous
utilisez une console IPMI ou un outil de virtualisation qui ne propose pas de
conversion pour ces types de terminal (comme QEMU/KVM), vous pouvez le lancer
dans une session screen. Cela effectuera une conversion vers le type de
terminal screen, qui est très proche du type vt102.

5.3.2. Paramètres pour l'installateur Debian

Le système d'installation accepte des paramètres d'amorçage^[5].

Certains paramètres possèdent une « forme courte » qui permet d'éviter les
limitations concernant les options du noyau données sur la ligne de commande.
La saisie en est aussi facilitée. Quand il existe une forme courte, elle sera
donnée entre parenthèses, après la forme longue. Les exemples de ce manuel
utilisent la forme courte des paramètres.

debconf/priority (priority)

    Ce paramètre sert à déclarer le niveau de la priorité à partir de laquelle
    les messages sont affichés.

    Dans l'installation par défaut, ce paramètre est égal à priority=high. Cela
    signifie que les messages avec des priorités « high » et « critical »
    seront affichés, mais non les messages avec des priorités « medium » et « 
    low ». Si des problèmes apparaissent, l'installateur fixe la priorité comme
    il est nécessaire.

    Si vous ajoutez le paramètre priority=medium au démarrage, vous obtiendrez
    le menu d'installation et un contrôle plus fin du processus d'installation.
    Si vous ajoutez priority=low, tous les messages seront affichés ; c'est
    l'équivalent de la méthode de démarrage expert. Si vous utilisez priority=
    critical, seuls les messages critiques seront affichés et l'installateur
    fera ce qu'il faut pour tout faire correctement.

DEBIAN_FRONTEND

    Ce paramètre contrôle le type d'interface qu'utilisera l'installateur.
    Voici les valeurs possibles actuellement :

      □ DEBIAN_FRONTEND=noninteractive

      □ DEBIAN_FRONTEND=text

      □ DEBIAN_FRONTEND=newt

      □ DEBIAN_FRONTEND=gtk

    L'interface par défaut est DEBIAN_FRONTEND=newt. DEBIAN_FRONTEND=text est
    préférable pour les installations avec une console série. Certains supports
    d'installation spécialisés n'offrent pas toutes les interfaces possibles
    mais les interfaces newt et text sont disponibles sur la plupart des
    supports d'installation. Sur certaines architectures, l'installateur
    graphique utilise l'interface gtk.

BOOT_DEBUG

    Si l'on donne la valeur 2 à ce paramètre, le processus d'amorçage de
    l'installateur sera enregistré avec beaucoup de détails dans les journaux
    du démarrage. Si l'on donne la valeur 3, des interpréteurs seront
    disponibles à des endroits stratégiques du processus d'amorçage. Il faut
    quitter (exit) les interpréteurs pour revenir au processus d'amorçage.

    BOOT_DEBUG=0

        valeur par défaut.

    BOOT_DEBUG=1

        Un peu plus bavard qu'habituellement.

    BOOT_DEBUG=2

        Beaucoup d'informations.

    BOOT_DEBUG=3

        À certains moments du processus de démarrage, un interpréteur de
        commande est exécuté pour permettre un débogage approfondi. Quittez
        l’interpréteur pour revenir au processus de démarrage.

log_host, log_port

    Avec ces paramètres, l'installateur peut envoyer des messages à un syslog
    distant, sur un hôte et un port spécifiés, aussi bien que dans un fichier
    local. Si le port n'est pas indiqué, l'installateur utilise le port
    standard de syslog, 514.

lowmem

    Ce paramètre permet de forcer un niveau de mémoire à utiliser autre que
    celui basé sur la mémoire disponible. Les valeurs possibles sont 1 ou 2.
    Voyez la Section 6.3.1.1, « Vérification de la mémoire disponible et le
    mode peu de mémoire ».

noshell

    Ce paramètre interdit l'utilisation d’interpréteur de commande interactif
    sur les consoles tty2 et tty3. C'est utile pour des installations
    automatisées où la sécurité est limitée.

debian-installer/framebuffer (fb)

    Certaines architectures utilisent le tampon vidéo du noyau framebuffer afin
    d'offrir l'installation en plusieurs langues. Si le tampon vidéo pose des
    problèmes sur votre système, vous pouvez utiliser le paramètre vga=normal
    fb=false, pour le désactiver. Les symptômes de ce problème sont des
    messages d'erreur au sujet de bterm ou bogl, un écran noir, ou un blocage
    quelques minutes après le début de l'installation.

debian-installer/theme (theme)

    L'apparence (couleurs, icônes, etc.) de l'interface de l'installateur est
    déterminée par un thème. Les thèmes diffèrent selon les interfaces. Pour
    l'instant, il n'existe qu'un seul thème, « dark », à destination des
    déficients visuels. Proposé par les interfaces newt et gtk, il peut être
    activé avec le paramètre theme=dark, ou avec le raccourci d dans le menu
    d'amorçage.

netcfg/disable_autoconfig

    L'installateur Debian recherche automatiquement la configuration du réseau
    par autoconfiguration IPv6 et DHCP. Si la recherche réussit, vous n'aurez
    plus la possibilité de vérifier et de modifier les valeurs obtenues. Vous
    ne pouvez configurer vous-même le réseau que si la recherche automatique a
    échoué.

    S'il existe un routeur IPv6 ou un serveur DHCP sur votre réseau local et si
    vous voulez les ignorer parce qu'ils donnent, par exemple, des valeurs
    fausses, vous pouvez utiliser le paramètre netcfg/disable_autoconfig=true
    pour empêcher toute configuration automatique (ni v4 ni v6) et indiquer
    vous-même les paramètres du réseau.

hw-detect/start_pcmcia

    Fixez ce paramètre à false pour empêcher le démarrage des services PCMCIA.
    Certains ordinateurs portables connaissent des problèmes avec les PCMCIA.

disk-detect/dmraid/enable (dmraid)

    Fixez ce paramètre à true pour permettre la reconnaissance des disques
    Serial ATA RAID (ATA RAID, BIOS RAID ou fake RAID). Notez que la gestion de
    ces disques n'est qu'en phase d'expérimentation. On peut trouver d'autres
    informations sur le wiki de l'installateur Debian.

preseed/url (url)

    Ce paramètre indique l'URL d'un fichier de préconfiguration à télécharger
    pour automatiser l'installation. Voyez la Section 4.6, « Installation
    automatisée ».

preseed/file (file)

    Ce paramètre indique le chemin d'un fichier de préconfiguration à utiliser
    pour automatiser l'installation. Voyez la Section 4.6, « Installation
    automatisée ».

preseed/interactive

    Avec la valeur true, les questions seront affichées même si elles ont été
    préconfigurées. Cela peut être utile pour tester le fichier de
    préconfiguration. Il faut noter que cela n'aura aucun effet sur les
    paramètres passés comme paramètres d'amorçage. Pour ces paramètres, on peut
    utiliser une syntaxe spéciale. Consultez la Section B.5.2, « Changer les
    valeurs par défaut avec la préconfiguration » pour des précisions.

auto-install/enable (auto)

    Ce paramètre retarde certaines questions normalement posées avant
    l'installation du réseau. Ainsi la préconfiguration devient possible. Voyez
    la Section B.2.3, « Le mode auto » pour des précisions.

finish-install/keep-consoles

    Lors d'une installation à partir d'une console série, les consoles
    virtuelles (VT1-VT6) sont désactivées dans /etc/inittab. Pour empêcher
    cette désactivation, mettez ce paramètre à true.

cdrom-detect/eject

    Avant de réamorcer, l'installateur éjecte automatiquement le support
    optique utilisé pendant l'installation. Cela peut être inutile si le
    système ne s'amorce pas automatiquement à partir de ce disque. Parfois ce
    n'est pas souhaitable si, par exemple, le lecteur optique ne peut pas
    réinsérer le support lui-même et si l'utilisateur n'est pas là pour le
    faire. Certains types de lecteur ne peuvent pas recharger automatiquement
    le support.

    Il suffit de mettre ce paramètre à false pour désactiver l'éjection
    automatique. Mais il faut vous assurer que le système ne s'amorcera pas à
    partir du lecteur après l'installation.

base-installer/install-recommends (recommends)

    En mettant cette option à false, le système de gestion des paquets
    n'installera pas automatiquement les paquets « Recommends », ni pendant
    l'installation ni ensuite dans le système installé. Consultez la
    Section 6.3.5, « L'installation du système de base ».

    Cette option permet d'obtenir un système plus petit. Elle peut conduire
    aussi à l'absence de fonctionnalités qu'on peut normalement s'attendre à
    trouver. Il vous faudra installer vous-mêmes les paquets recommandés pour
    retrouver ces fonctionnalités. Seuls des utilisateurs très expérimentés
    devraient se servir de cette option.

debian-installer/allow_unauthenticated

    Par défaut, l'installateur demande que les dépôts soient authentifiés par
    une clé gpg connue. On peut mettre ce paramètre à true pour désactiver
    cette authentification. Attention : commande non sécurisée et non
    recommandée.

rescue/enable

    Mettez ce paramètre à true pour entrer dans le mode de secours au lieu de
    faire une installation normale. Voyez la Section 8.6, « Réparer un système
    cassé ».

5.3.3. Répondre à des questions avec les paramètres d'amorçage

À quelques exceptions près, toute question posée pendant l'installation peut
recevoir une réponse définie au moment de l'invite d'amorçage. Ce n'est
vraiment utile que pour certains cas particuliers. Une présentation générale se
trouve dans la Section B.2.2, « Utiliser les paramètres d'amorçage pour
préconfigurer des questions ». Voici quelques exemples.

debian-installer/language (langue), debian-installer/country (pays), 
    debian-installer/locale (locale)

    La langue, le pays et la locale, utilisés pour l'installation et dans le
    système installé, peuvent être indiqués de deux manières.

    La méthode la plus facile est de passer simplement le paramètre locale. La
    langue et le pays seront déduits de cette valeur. Par exemple, locale=de_CH
    sélectionne l'allemand comme langue et la Suisse comme pays. La locale
    de_CH.UTF-8 sera la locale par défaut sur le système installé. Le défaut de
    cette méthode est qu'elle ne permet pas de choisir toutes les combinaisons
    possibles de langue, pays et locale.

    La deuxième méthode, plus souple, permet d'indiquer séparément language et
    country. Dans ce cas, il est aussi possible d'indiquer une locale
    particulière pour le système installé. Par exemple : language=en country=DE
    locale=en_GB.UTF-8.

anna/choose_modules (modules)

    Ce paramètre permet de charger automatiquement des composants de
    l'installateur qui ne sont pas chargés par défaut. Voici des exemples de
    composants qui peuvent être utiles : openssh-client-udeb (pour pouvoir
    utiliser scp pendant l'installation) et ppp-udeb (consultez la Section D.5,
    « Installer Debian GNU/Linux avec PPP sur Ethernet (PPPoE) »).

netcfg/disable_autoconfig

    Ce paramètre peut être mis à true pour désactiver la configuration
    automatique IPv6 et DHCP et forcer une configuration manuelle du réseau.

mirror/protocol (protocole)

    L'installateur utilise normalement le protocole HTTP pour télécharger les
    fichiers sur les miroirs Debian. Il n'est pas possible de passer à FTP
    pendant les installations faites avec la priorité normale. En mettant ce
    paramètre à ftp, vous pouvez forcer l'installateur à utiliser ce protocole.
    Notez que vous ne pouvez pas sélectionner un miroir FTP dans une liste,
    vous devrez saisir son nom.

tasksel:tasksel/first (tâches)

    Ce paramètre permet la sélection de tâches qui ne sont pas disponibles dans
    la liste interactive, comme par exemple la tâche kde-desktop. Voyez la
    Section 6.3.6.2, « Sélection et installation des paquets » pour des
    précisions.

5.3.4. Passer des paramètres aux modules du noyau

Selon la documentation du noyau Linux, il est possible de passer des paramètres
aux pilotes de périphériques compilés dans le noyau. Cependant, il existe une
différence entre la façon de charger un module pendant l'installation et la
façon de le charger sur un système installé. Aussi, quand les pilotes sont
compilés en modules, il n'est pas possible de leur passer des paramètres de la
manière habituelle. Une syntaxe spéciale est nécessaire. L'installateur fera en
sorte que les paramètres soient dans les bons fichiers de configuration quand
les modules seront réellement chargés. Les paramètres seront aussi propagés
automatiquement dans la configuration du système installé.

Il est aujourd'hui très rare d'avoir à passer des paramètres aux modules. Dans
la plupart des cas, le noyau sait tester le matériel présent sur une machine et
donne de bons paramètres par défaut. Parfois, cependant, il sera nécessaire de
passer soi-même des paramètres.

Voici la syntaxe à utiliser :

module.paramètre=valeur

Si vous devez passer plusieurs paramètres, pour un module ou pour plusieurs
modules, il suffit de répéter la formule. Ainsi, pour faire qu'une vieille
carte 3com utilise le connecteur BNC (connexion par câble coaxial) et
l'IRQ 10 :

3c509.xcvr=3 3c509.irq=10

5.3.5. Interdire des modules du noyau

Il est parfois nécessaire de mettre un module dans une liste noire pour
empêcher son chargement automatique par le noyau et udev. Il se peut par
exemple que tel module pose des problèmes à tel matériel. Le noyau peut aussi
lister deux pilotes différents pour le même périphérique. Si les pilotes
s'excluent ou si le mauvais pilote est chargé en premier, le périphérique ne
fonctionnera pas correctement.

Voici comment créer cette liste noire : module_name.blacklist=yes. Le module
sera listé dans le fichier /etc/modprobe.d/blacklist.local et sera interdit à
la fois pendant l'installation et pour le système installé.

Il faut noter que le système d'installation peut toujours charger le module.
Vous pouvez l'empêcher en faisant une installation en mode expert et en
désélectionnant le module dans la liste des modules qui est affiché pendant la
phase de détection du matériel.

5.4. Dysfonctionnements pendant la procédure d'installation

5.4.1. Fiabilité des disques optiques

Parfois, particulièrement avec d'anciens lecteurs, l'installateur ne peut
s'amorcer à partir d'un disque optique. Il arrive aussi, même après un amorçage
réussi, que l'installateur ne reconnaisse pas le disque ou bien signale des
erreurs de lecture pendant l'installation.

Plusieurs causes sont possibles. Voici une liste de problèmes connus,
accompagnés de suggestions sur la manière de les traiter.

On peut tout d'abord essayer deux choses très simples :

  • Si le disque ne s'amorce pas, il faut vérifier qu'il est correctement
    inséré et qu'il n'est pas sale.

  • Si l'installateur ne reconnaît pas le disque, on peut lancer une deuxième
    fois l'option Détecter et monter un support d'installation. Certains
    problèmes de DMA avec les très anciens lecteurs sont résolus de cette
    façon.

Si rien ne fonctionne, essayez les suggestions qui suivent. La plupart, mais
pas toutes, concernent les CD et les DVD.

Si vous ne pouvez faire l'installation à partir d'un disque optique, vous
pouvez essayer l'une des autres méthodes disponibles.

5.4.1.1. Problèmes communs

  • Certains lecteurs anciens ne peuvent lire des disques gravés à grande
    vitesse sur les lecteurs modernes.

  • Certains lecteurs très anciens ne fonctionnent pas correctement si le DMA (
    direct memory access) est activé.

5.4.1.2. Comment résoudre ces problèmes ?

Si le disque optique ne peut amorcer l'installateur, voici une liste de
suggestions :

  • Vérifiez que le BIOS ou l'UEFI est réellement capable de gérer l'amorçage à
    partir d'un disque optique, certains très anciens systèmes ne le permettent
    pas, et que le lecteur est bien le périphérique d'amorçage.

  • Si vous avez téléchargé une image ISO, vérifiez que la somme MD5 de cette
    image correspond à celle associée dans le fichier MD5SUMS. Ce fichier se
    trouve normalement là où vous avez téléchargé l'image.

    $ md5sum debian-testing-i386-netinst.iso
    a20391b12f7ff22ef705cee4059c6b92  debian-testing-i386-netinst.iso

    Vérifiez ensuite que la somme MD5 du disque gravé correspond aussi. La
    commande suivante devrait fonctionner. Elle utilise la taille de l'image
    pour lire le nombre d'octets sur le disque.

    $ dd if=/dev/cdrom | \
    > head -c `stat --format=%s debian-testing-i386-netinst.iso` | \
    > md5sum
    a20391b12f7ff22ef705cee4059c6b92  -
    262668+0 records in
    262668+0 records out
    134486016 bytes (134 MB) copied, 97.474 seconds, 1.4 MB/s

Quand le disque optique n'est pas reconnu même après un amorçage réussi, il
suffit souvent de recommencer pour résoudre le problème. Si vous possédez
plusieurs lecteurs, mettez le disque dans l'autre lecteur. Si rien ne
fonctionne ou si des erreurs de lecture sont signalées, essayez les suggestions
listées ci-dessous. Une connaissance élémentaire de Linux est nécessaire. Pour
exécuter ces commandes, il faut passer sur la deuxième console virtuelle (VT2)
et lancer un interpréteur de commandes.

  • Passez sur VT4 et consultez le fichier /var/log/syslog (avec l'éditeur nano
    ) en recherchant des messages d'erreur spécifiques. Vérifiez ensuite la
    sortie de dmesg.

  • Si votre lecteur a été reconnu, vérifiez la sortie de dmesg. Vous devriez
    voir des lignes de ce type (elles ne se suivent pas nécessairement) :

    ata1.00: ATAPI: MATSHITADVD-RAM UJ-822S, 1.61, max UDMA/33
    ata1.00: configured for UDMA/33
    scsi 0:0:0:0: CD-ROM            MATSHITA DVD-RAM UJ-822S  1.61 PQ: 0 ANSI: 5
    sr0: scsi3-mmc drive: 24x/24x writer dvd-ram cd/rw xa/form2 cdda tray
    cdrom: Uniform CD-ROM driver Revision: 3.20

    Si vous ne voyez rien de tel, il est probable que le contrôleur du lecteur
    n'a pas été reconnu ou qu'il n'est pas du tout géré. Si vous connaissez le
    pilote nécessaire à ce contrôleur, vous pouvez le charger vous-même avec 
    modprobe.

  • Vérifiez que le lecteur est bien listé dans le répertoire /dev/. Pour
    l'exemple ci-dessus, ce serait /dev/sr0. Il doit exister aussi un fichier /
    dev/cdrom.

  • Vérifiez avec la commande mount que le disque optique est déjà monté. Si
    non, montez-le vous-même :

    $ mount /dev/hdc /cdrom

    Vérifiez si cette commande a provoqué des messages d'erreur.

  • Vérifiez si le DMA est activé :

    $ cd /proc/ide/hdc
    $ grep using_dma settings
    using_dma      1       0       1       rw

    Un « 1 » dans la première colonne après using_dma signifie qu'il est
    activé. Dans ce cas, désactivez-le :

    $ echo -n "using_dma:0" >settings

    Assurez-vous que vous êtes bien dans le répertoire du périphérique qui
    correspond au lecteur optique.

  • Si vous rencontrez des problèmes pendant l'installation, vérifiez
    l'intégrité du support d'installation avec l'option qui se trouve en fin du
    menu principal de l'installateur. Cette option peut aussi servir de test
    quand le disque est lu correctement.

5.4.2. Configuration d'amorçage

Si le noyau se bloque pendant la phase d'amorçage, s'il ne reconnaît pas vos
périphériques ou bien si les disques ne sont pas identifiés correctement, la
première chose à faire est de vérifier les paramètres d'amorçage, ainsi qu'il a
été discuté dans la Section 5.3, « Paramètres d'amorçage ».

Parfois, les dysfonctionnements proviennent de microprogrammes manquants, voyez
la Section 2.2, « Périphériques demandant des microprogrammes (firmware) » et
la Section 6.4, « Télécharger des microprogrammes (firmware) manquants ».

5.4.3. Synthèse vocale logicielle

Quand la synthèse vocale logicielle ne fonctionne pas, le problème vient
souvent de la carte son. Soit le pilote de cette carte n'est pas connu de
l'installateur, soit il utilise des canaux de mixage inhabituels qui sont muets
(muted) par défaut. Vous pouvez envoyer un rapport de bogue qui comprenne la
sortie des commandes suivantes, exécutées sur la même machine, à partir d'un
système Linux sur lequel le son fonctionne correctement, par exemple un CD
live.

  • dmesg

  • lspci

  • lsmod

  • amixer

5.4.4. Problèmes communs sur PC 64 bits

Certains problèmes d'installation peuvent être résolus ou évités en passant des
paramètres d'amorçage à l'installateur.

Si votre écran commence à afficher une image bizarre lors des démarrages du
noyau, par exemple, un écran entièrement blanc, noir ou un écran contenant un
mélange de couleurs, alors très certainement la carte vidéo du système ne
parvient pas à passer en mode framebuffer correctement. Dans ce cas, essayez de
passer le paramètre d'amorçage fb=false pour désactiver la console framebuffer.
Seules quelques langues seront utilisables pour l'installation, à cause des
caractéristiques limitées de la console. Référez-vous à la Section 5.3,
« Paramètres d'amorçage » pour plus de précisions.

5.4.4.1. Le système bloque lors de la configuration des services PCMCIA

Quelques très anciens ordinateurs portables fabriqués par Dell s'arrêtent
fréquemment de fonctionner lorsque la détection des périphériques essaie
d'accéder à certaines adresses matérielles. D'autres portables connaissent
aussi des problèmes semblables. Si vous rencontrez un tel problème et si vous
n'avez pas besoin de services PCMCIA pendant l'installation, vous pouvez
désactiver cette option avec le paramètre hw-detect/start_pcmcia=false. Vous
pourrez configurer les services PCMCIA après l'installation et éviter le
problème des adresses des ressources.

Vous pouvez aussi démarrer l'installateur en mode expert. Vous pourrez ainsi
indiquer les options pour les adresses des ressources de votre matériel. Par
exemple, si votre ordinateur est un des portables Dell mentionnés plus haut,
vous pouvez indiquer exclude port 0x800-0x8ff. Il existe une liste de ces
options communes dans la section sur les ressources système du HOWTO PCMCIA.
Notez qu'il faut supprimer les virgules quand vous passez ces valeurs à
l'installateur.

5.4.5. Comprendre les messages du noyau au démarrage

Durant la séquence de démarrage, vous pouvez voir beaucoup de messages du genre
can't find something, ou something not present, can't initialize something ou
même this driver release depends on something . La plupart de ces messages sont
sans conséquence. Vous les voyez parce que le noyau du système d'installation
est conçu pour tourner sur des ordinateurs avec des périphériques très
différents. Évidemment, aucun ordinateur ne possède tous les périphériques
possibles, et le système d'exploitation recherche un périphérique que vous ne
possédez pas. Vous pourriez également voir le système s'arrêter pendant un
moment. Cela arrive quand il attend la réponse d'un périphérique qui n'est pas
présent sur votre système. Si vous trouvez le temps de démarrage du système
exagérément long, vous pouvez créer un noyau personnalisé (voyez la
Section 8.5, « Compiler un nouveau noyau »).

5.4.6. Signaler les problèmes

Si vous parvenez à la fin de la phase d'amorçage mais que vous ne parveniez pas
à terminer l'installation, le choix Sauvegarder les journaux de débogage du
menu peut vous aider. Vous pouvez copier sur un support externe, les journaux
contenant les erreurs système et des informations sur la configuration ou vous
pouvez les consulter avec un navigateur web. Toutes ces informations peuvent
donner des indications sur ce qui s'est mal passé et sur la manière de le
corriger. Si vous envoyez un rapport de bogue, vous pouvez attacher cette
information au rapport.

Pendant l'installation, d'autres messages intéressants se trouvent dans le
fichier /target/var/log/debian-installer/, et, quand l'ordinateur a démarré le
nouveau système installé, ces messages se trouvent dans le fichier /var/log/
installer/.

5.4.7. Faire un rapport de bogue

Si vous avez toujours des ennuis, faites un rapport de bogue. Nous vous
demandons aussi d'envoyer des rapports sur les installations réussies, car nous
cherchons des informations sur toutes les configurations matérielles possibles.

Notez que votre rapport d'installation sera publié dans le système de suivi des
bogues, Bug Tracking System (BTS), de Debian et envoyé sur une liste de
diffusion publique. Votre adresse de courrier sera aussi rendue publique.

Si vous utilisez déjà un système Debian, vous pouvez installer les paquets
installation-report et reportbug (apt install installation-report reportbug).
Configurez reportbug en suivant les explications données dans la Section 8.4.2,
« Envoyer des courriels vers l'extérieur », puis exécutez la commande reportbug
installation-reports.

Vous pouvez aussi utiliser le modèle suivant. Envoyez-le comme un rapport de
bogue pour le paquet installation-reports, à l'adresse <submit@bugs.debian.org
>.

Package: installation-reports

Boot method: <Comment avez-vous amorcé l'installateur ? CD ou DVD ? clé USB ? réseau ?>
Image version: <URL complète de l'image téléchargée>
Date: <Date et heure de l'installation>

Machine: <Description de la machine (p. ex. IBM Thinkpad R32)>
Processor:
Memory:
Partitions: <df -Tl ; mais nous préférons la table des partitions>

Résultat de lspci -knn (ou lspci -nn) :

Installation du système de base :
[O] = OK, [E] = Error (développez plus bas s'il vous plait), [ ] = non essayé

Initial boot:           [ ]
Detect network card:    [ ]
Configure network:      [ ]
Detect media:           [ ]
Load installer modules: [ ]
Detect hard drives:     [ ]
Partition hard drives:  [ ]
Install base system:    [ ]
Clock/timezone setup:   [ ]
User/password setup:    [ ]
Install tasks:          [ ]
Install boot loader:    [ ]
Overall install:        [ ]

Comments/Problems:

<Décrivez l'installation, les pensées, commentaires ou idées de propositions
que vous avez eus pendant cette installation.>

Dans le rapport de bogue, décrivez le problème en incluant les derniers
messages visibles du noyau dans le cas d'un plantage du noyau. Décrivez les
étapes que vous avez effectuées pour arriver là.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[4] L'image ISO mini peut être téléchargée sur un miroir Debian, voyez la
Section 4.2, « Télécharger les fichiers depuis les miroirs Debian ». Cherchez
netboot/gtk/mini.iso.

^[5] À partir des noyaux de la série 2.6.9, on peut utiliser 32 options sur la
ligne de commande et 32 options d'environnement. En cas de dépassement, le
noyau panique. Il y a aussi une limite à 255 caractères pour la totalité de la
ligne de commande. Tout ce qui dépasse cette limite pourra être silencieusement
ignoré.

Chapitre 6. Comment utiliser l'installateur Debian ?

Table des matières

6.1. Comment fonctionne l'installateur ?

    6.1.1. Utilisation de l'installateur graphique

6.2. Introduction aux composants
6.3. Utilisation des composants

    6.3.1. L'installateur Debian et la configuration du matériel
    6.3.2. Création des utilisateurs et des mots de passe
    6.3.3. Configuration de l'horloge et du fuseau horaire
    6.3.4. Partitionnement et points de montage
    6.3.5. L'installation du système de base
    6.3.6. Installation de logiciels supplémentaires
    6.3.7. Rendre le système amorçable
    6.3.8. La fin de l'installation
    6.3.9. Dépannage
    6.3.10. Installation par le réseau avec network-console

6.4. Télécharger des microprogrammes (firmware) manquants

    6.4.1. Préparer le support
    6.4.2. Microprogrammes et système installé
    6.4.3. Finaliser le système installé

6.5. Personnalisation

    6.5.1. Installer un système d'initialisation alternatif

6.1. Comment fonctionne l'installateur ?

For this architecture the installateur Debian supports two different user
interfaces: a graphical one and a text-based one. The graphical interface is
used by default unless you select an « Install » option in the boot menu. For
more information about booting the graphical installer, please refer to
Section 5.1.8, « L'installateur graphique ».

L'installateur Debian comprend plusieurs composants qui ont chacun une tâche
précise à accomplir. Chaque composant pose à l'utilisateur les questions
nécessaires à l'exécution de sa tâche. Chaque question possède une priorité et
cette priorité est déclarée au démarrage de l'installateur.

Pour une installation standard, seules les questions essentielles (priorité 
high) sont posées. Ainsi, l'installation est grandement automatisée, avec peu
d'interventions de l'utilisateur. Les composants sont choisis et exécutés
automatiquement selon le matériel et selon le type d'installation demandée.
L'installateur utilise des valeurs par défaut pour les questions qui ne sont
pas posées.

Quand survient un problème, l'utilisateur voit un message d'erreur et le menu
de l'installateur peut s'afficher pour permettre le choix d'une autre action.
Quand il n'y a pas de problème, l'utilisateur ne voit jamais le menu de
l'installateur. Il répond simplement aux questions qui lui sont posées par
chaque composant. Les messages concernant des erreurs sérieuses ont une
priorité critical afin que l'utilisateur les reçoive toujours.

On peut modifier les valeurs par défaut utilisées par l'installateur en passant
des paramètres d'amorçage au démarrage de l'installateur. Si, par exemple, vous
préférez configurer vous-même le réseau -- la configuration automatique d’IPv6
et DHCP sont utilisés quand c'est possible --, vous pouvez ajouter le paramètre
d'amorçage netcfg/disable_autoconfig=true. Les paramètres disponibles sont
donnés dans la Section 5.3.2, « Paramètres pour l'installateur Debian ».

Certains utilisateurs préfèrent une interface dotée d'un menu ; ils veulent
contrôler chaque étape et ne pas laisser l'installateur agir automatiquement.
Pour utiliser l'installateur dans ce mode manuel, il faut ajouter le paramètre
de démarrage priority=medium.

Si, quand ils sont installés, vous devez passer des paramètres aux modules du
noyau, vous devrez exécuter l'installateur en mode expert. Vous pouvez le faire
en utilisant la commande expert au démarrage de l'installateur, ou en ajoutant
le paramètre d'amorçage priority=low. Le mode expert permet de contrôler
complètement l'installateur.

In the text-based environment the use of a mouse is not supported. Here are the
keys you can use to navigate within the various dialogs. The Tab or right arrow
keys move « forward », and the Shift+Tab or left arrow keys move « backward »
between displayed buttons and selections. The up and down arrow select
different items within a scrollable list, and also scroll the list itself. In
addition, in long lists, you can type a letter to cause the list to scroll
directly to the section with items starting with the letter you typed and use 
Pg-Up and Pg-Down to scroll the list in sections. The space bar selects an item
such as a checkbox. Use Entrée to activate choices.

Certains dialogues peuvent proposer une aide. Si cette aide est disponible,
cela sera indiqué sur la ligne du bas de l'écran. Le contenu de cette aide peut
être affiché en pressant la touche F1.

Le journal de l'installation et les messages d'erreur sont redirigés vers la
quatrième console. Vous pouvez y accéder en pressant Left Alt+F4 (il faut
garder la touche Alt enfoncée pendant que vous appuyez sur la touche de
fonction F4). Revenez sur le processus d'installation avec Left Alt+F1.

Ces messages se retrouvent aussi dans /var/log/syslog. Après l'installation, ce
journal est copié dans /var/log/installer/syslog sur votre nouveau système.
D'autres messages d'installation se trouvent, pendant l'installation, dans le
fichier /var/log/, et, quand la machine a démarré le nouveau système, ces
messages se trouvent dans /var/log/installer/.

6.1.1. Utilisation de l'installateur graphique

Comme l'installateur graphique fonctionne de la même manière que l'installateur
texte, la suite de ce manuel vous servira de guide pour le processus
d'installation.

Si vous préférez le clavier à la souris, vous devez savoir deux choses. Pour
dérouler une liste (par exemple la liste des pays à l'intérieur des continents)
vous pouvez utiliser les touches + et -. Pour les questions permettant
plusieurs choix (par exemple la sélection des tâches), vous devez d'abord
appuyer le bouton Continue après la sélection ; appuyer sur la touche Entrée
modifie une sélection, sans activer Continue.

Quand un dialogue propose une aide, un bouton Help est affiché. Les
informations sont alors accessibles avec ce bouton ou bien en pressant la
touche F1.

Pour changer de console, vous aurez besoin d'utiliser la touche Ctrl, comme
dans le système X Window. Par exemple, pour passer sur VT2 où se trouve un
interpréteur de commandes : Ctrl+Left Alt+F2. Et pour revenir sur
l'installateur graphique qui s'exécute sur la console VT5 : Left Alt+F5.

6.2. Introduction aux composants

Voici une liste des composants de l'installateur, avec une brève description
des buts de chacun d'eux. Des précisions sur leur utilisation se trouvent dans
la Section 6.3, « Utilisation des composants ».

Le menu principal

    Affiche la liste des composants pendant les opérations de l'installateur et
    lance le composant qui a été choisi. Les questions du menu principal ont la
    priorité medium (moyenne), et si la priorité que vous avez choisie est high
    (haute) ou critical (critique) (high, par défaut), vous ne verrez pas le
    menu. Quand une erreur se produit, qui demande votre intervention, la
    priorité de la question peut être abaissée temporairement pour vous
    permettre de résoudre le problème, et dans ce cas, le menu apparaît.

    Depuis le composant en cours, vous pouvez revenir au menu principal en
    sélectionnant plusieurs fois le bouton Go Back.

localechooser

    Ce programme permet à l'utilisateur de choisir des paramètres régionaux
    pour l'installation et le système à installer : la langue, le pays et les 
    locales. L'installateur affiche ses messages dans la langue choisie ; si la
    traduction des messages dans cette langue n'est pas complète, certains
    messages seront affichés en anglais.

console-setup

    Ce programme permet à l'utilisateur de choisir une disposition de clavier
    parmi une liste de cartes clavier.

hw-detect

    Ce programme détecte automatiquement la plupart des éléments matériels du
    système, les cartes réseau, les disques, les cartes PCMCIA.

cdrom-detect

    Ce programme recherche et monte les supports d'installation de Debian.

netcfg

    Ce programme configure la connexion réseau pour la communication sur
    Internet.

iso-scan

    Ce programme recherche les fichiers ISO qui se trouvent sur des disques
    durs.

choose-mirror

    Ce programme affiche une liste des miroirs de l'archive Debian.
    L'utilisateur peut choisir la source des paquets à installer.

cdrom-checker

    Ce programme vérifie l'intégrité des supports d'installation. Ainsi,
    l'utilisateur peut s'assurer que l'image d'installation n'est pas
    corrompue.

lowmem

    Lowmem essaie de détecter les systèmes qui ont peu de mémoire et s'arrange
    pour supprimer les programmes non indispensables de l'installateur, au prix
    de certaines fonctionnalités.

anna

    Anna's Not Nearly APT (Anna n'est pas vraiment APT). C'est un programme qui
    installe les paquets qui ont été récupérés sur le miroir choisi, ou sur le
    support d'installation.

user-setup

    Ce programme permet la création du mot de passe pour le superutilisateur (
    root) et l'ajout d'un utilisateur ordinaire.

clock-setup

    Ce programme contrôle le réglage de l'horloge (UTC ou non).

tzsetup

    Ce programme permet de choisir le fuseau horaire à partir du lieu indiqué
    précédemment.

partman

    Ce programme permet de partitionner les disques du système, de créer les
    systèmes de fichiers sur les partitions et de monter ces partitions. Il
    possède d'autres fonctionnalités intéressantes comme son mode automatique
    ou la gestion des volumes logiques (LVM). C'est le partitionneur principal
    de Debian.

partitioner

    Ce programme permet de partitionner les disques du système. Un
    partitionneur approprié à l'architecture de votre système est choisi.

partconf

    Ce programme affiche la liste des partitions et crée les systèmes de
    fichiers sur les partitions choisies selon les instructions de
    l'utilisateur.

partman-lvm

    Ce programme aide l'utilisateur dans sa configuration du gestionnaire de
    volumes logiques (LVM, Logical Volume Manager).

partman-md

    Ce programme permet la configuration d'un RAID logiciel (Redundant Array of
    Inexpensive Disks). Ce RAID logiciel est supérieur à celui des contrôleurs
    IDE qu'on trouve sur les cartes mère récentes.

base-installer

    Ce programme installe l'ensemble des programmes de base qui permettront le
    fonctionnement de l'ordinateur sous Debian GNU/Linux après le redémarrage.

apt-setup

    Ce programme configure apt à partir d'informations tirées du support
    d'installation.

pkgsel

    Ce programme utilise le logiciel tasksel pour sélectionner et installer des
    logiciels supplémentaires.

os-prober

    Ce programme détecte les systèmes d'exploitation présents sur le système et
    passe cette information au programme bootloader-installer ; celui-ci vous
    donne la possibilité d'ajouter ces systèmes au menu des programmes
    d'amorçage. Ainsi vous pourrez choisir, au moment du démarrage, quel
    système lancer.

bootloader-installer

    Ce programme installe un programme d'amorçage sur le disque choisi ; c'est
    nécessaire pour démarrer Linux sans clé USB ou sans CD. Beaucoup de
    programmes d'amorçage permettent de choisir le système d'exploitation que
    l'on veut lancer au démarrage de la machine.

shell

    Ce programme permet d'exécuter un interpréteur de commandes, à partir du
    menu ou dans la deuxième console.

save-logs

    Ce programme permet d'enregistrer des informations sur une clé USB, un
    réseau, un disque dur, etc., quand quelque chose se passe mal ; ainsi on
    peut par la suite envoyer des informations précises aux développeurs
    Debian.

6.3. Utilisation des composants

Dans cette section, nous décrirons en détail chaque composant de
l'installateur. Ces composants sont présentés selon leur ordre d'apparition
dans le processus d'installation. Notez que les modules ne sont pas tous
utilisés dans toutes les installations. Leur utilisation dépend du matériel et
du type d'installation choisi.

6.3.1. L'installateur Debian et la configuration du matériel

Supposons que l'installateur Debian a démarré et vous propose son premier
écran. Les fonctionnalités de l'installateur sont à ce moment très limitées. Il
ne connaît pas votre matériel, la langue voulue, ni même ce qu'il doit faire.
Ne vous inquiétez pas ! L'installateur est un programme intelligent qui peut
explorer votre matériel, trouver ses composants et se transformer en un système
d'installation opérationnel. Cependant, certaines valeurs comme la langue
choisie, la carte clavier ou le miroir sur le réseau ne peuvent être
automatiquement déterminées et doivent lui être données.

Il faut noter que l'installateur procède à plusieurs détections de matériel
pendant cette étape. La première recherche particulièrement le matériel
nécessaire à l'installation des composants de l'installateur (le lecteur de CD
ou la carte réseau par exemple). Comme tous les pilotes ne sont pas disponibles
lors de cette première recherche, d'autres détections de matériel sont
nécessaires.

Pendant ces détections, l'installateur vérifie si les pilotes de périphériques
exigent des microprogrammes pour fonctionner. Quand un microprogramme est
demandé mais indisponible, un écran est affiché qui propose de charger ce
microprogramme à partir d'un support amovible. Voyez la Section 6.4,
« Télécharger des microprogrammes (firmware) manquants » pour des informations
supplémentaires.

6.3.1.1. Vérification de la mémoire disponible et le mode peu de mémoire

L'une des premières tâches effectuées par l'installateur est la vérification de
la mémoire disponible. Si la mémoire disponible est insuffisante, le processus
d'installation sera modifié pour permettre l'installation de Debian GNU/Linux
sur votre machine.

La première mesure prise pour réduire la consommation de mémoire est de
supprimer les traductions. Cela signifie que l'installation ne peut se faire
qu'en anglais. Bien sûr, une fois l'installation terminée, vous pourrez définir
les paramètres régionaux du système.

Si cela ne suffit pas, l'installateur ne chargera que les composants
nécessaires pour terminer une installation élémentaire. Cela réduit les
fonctionnalités du système installé. Vous avez toujours la possibilité de
charger des composants supplémentaires, mais vous devez savoir que chaque
composant choisi utilisera de la mémoire, ce qui peut provoquer l'échec de
l'installation.

Quand l'installateur est en mode peu de mémoire, il est recommandé de créer une
partition d'échange assez grande (64-128 Mo). Elle sera utilisée comme mémoire
virtuelle, ce qui augmentera la quantité de mémoire disponible. L'installateur
activera cette partition aussi tôt que possible pendant le processus
d'installation. Il faut noter que cette utilisation de la partition d'échange
réduit les performances du système et provoque une grande activité du disque.

Malgré tout, il se peut encore que le système gèle, que des erreurs se
produisent ou que des processus soient supprimés par le noyau à cause du manque
de mémoire (cela sera signalé par des messages « Out of memory » sur la console
VT4 et dans le journal du système).

Il a été rapporté par exemple que la création d'un gros système de fichiers
ext3 n'est pas possible dans ce mode quand la partition d'échange n'est pas
assez grande. Si l'augmentation de la taille de la partition d'échange ne
change rien, essayez de créer un système ext2 (qui est un composant essentiel
de l'installateur). Après l'installation, il sera possible de changer une
partition ext2 en ext3.

Il est possible d'indiquer un niveau de mémoire à utiliser plus élevé que celui
basé sur la mémoire disponible. Il suffit de donner une valeur au paramètre
d'amorçage « lowmem ». Voyez la Section 5.3.2, « Paramètres pour l'installateur
Debian ».

6.3.1.2. Choix des paramètres régionaux

Les premières questions posées concernent le choix des paramètres régionaux qui
seront utilisés à la fois pour l'installation et dans le système à installer.
Ces paramètres sont la langue, le pays (territoire ou région) et les locales.

L'installation se fera dans la langue choisie, à condition que la traduction
des dialogues existe. Quand il n'existe pas de traduction pour la langue
choisie, l'installateur utilise l'anglais.

Le pays choisi sera utilisé pendant l'installation pour configurer votre fuseau
horaire et le miroir Debian correspondant à votre zone géographique. Les choix
du pays et de la langue déterminent la locale par défaut de votre système ainsi
que le choix de la carte clavier.

On vous demandera d'abord de choisir une langue. Les noms des langues sont
affichés en anglais (côté gauche) et dans la langue elle-même (côté droit). Les
noms sur la droite sont aussi affichés avec leurs propres caractères. La liste
est triée selon les noms anglais. Une option supplémentaire, au sommet de la
liste, permet de choisir la locale « C » au lieu d'une langue. L'installation
se fera alors en anglais. Le système qui sera installé ne sera pas localisé,
puisque le paquet locales n'aura pas été installé.

Ensuite vous devrez choisir une zone géographique. Si vous avez choisi une
langue qui est reconnue comme la langue officielle dans au moins deux pays ^[6]
, on vous présentera la liste de ces pays. Pour choisir un pays qui ne se
trouve pas dans cette liste, sélectionnez la dernière option, autre. La liste
des continents sera affichée. En choisissant un continent, vous obtiendrez la
liste des pays de ce continent.

Si vous avez choisi une langue qui n'est associée qu'à un seul pays, ce pays
sera automatiquement sélectionné dans la liste où apparaissent tous les autres
pays appartenant au continent ou à la région du pays sélectionné. Pour choisir
un pays dans un autre continent, il faut utiliser le bouton Retour.

Note

Il est important de choisir le pays dans lequel on vit, car le pays détermine
le fuseau horaire du système installé.

S'il n'existe aucune locale pour la combinaison de langue et de pays choisis et
si, pour cette langue, il existe plusieurs locales, l'installateur offre la
possibilité de choisir la locale par défaut pour le système à installer ^[7].
Dans tous les autres cas, la locale par défaut sera définie en fonction du pays
et de la langue choisis.

Toutes les locales par défaut choisies de la manière décrite dans le paragraphe
précédent possèdent le codage UTF-8.

Si vous faites une installation avec une priorité low, vous pourrez choisir
d'ajouter d'autres locales, comme par exemple d'anciennes locales (Legacy
locales) ^[8], qui seront installées sur le nouveau système. Dans ce cas, il
vous sera demandé de choisir quelle sera la locale par défaut.

6.3.1.3. Choix du clavier

Les claviers sont construits selon les caractères utilisés dans une langue.
Choisissez un clavier dont la carte répond à la langue de votre pays, ou bien,
si aucune carte clavier ne correspond à ce que vous voulez, choisissez un
clavier approchant. Quand l'installation sera terminée, vous pourrez en choisir
un avec la commande dpkg-reconfigure keyboard-configuration, lancée en tant que
superutilisateur, qui vous présentera un plus grand choix de cartes clavier.

Mettez en surbrillance l'élément clavier que vous voulez et appuyez sur la
touche Entrée. Servez-vous pour cela des flèches de direction -- elles se
trouvent au même endroit dans toutes les cartes clavier, et elles sont
indépendantes de la configuration du clavier.

6.3.1.4. Rechercher l'image ISO de l'installateur Debian

Quand vous faites une installation selon la méthode hd-media, il arrive un
moment où vous devez monter l'image ISO de l'installateur Debian pour obtenir
les autres fichiers d'installation. C'est le programme iso-scan qui exécute
cette tâche.

Dans un premier temps, iso-scan monte automatiquement tous les périphériques
bloc (p. ex. les partitions et les volumes logiques) qui possèdent un système
de fichiers connu et recherche les noms de fichiers qui se terminent par .iso
(ou .ISO pour notre exemple). Il faut remarquer que la première recherche se
fait dans le répertoire racine et au premier niveau des sous-répertoires
(c'est-à-dire que les fichiers /fichier.iso ou /data/fichier.iso seront trouvés
mais pas le fichier /data/tmp/fichier.iso). Quand une image a été trouvée, 
iso-scan vérifie que c'est bien une image ISO de Debian. Si ce n'est pas le
cas, iso-scan cherche une autre image.

Quand iso-scan ne trouve pas d'image, le programme vous demande si vous voulez
faire une recherche plus approfondie. Cette fois-ci, la recherche ne se
contentera pas des répertoires de premier niveau, mais elle sera étendue à tout
le système de fichiers.

Quand iso-scan n'a pas découvert l'image ISO de l'installateur, relancez le
premier système d'exploitation et vérifiez que le nom de l'image se termine
bien par .iso, qu'elle se trouve sur un système de fichiers reconnu par
l'installateur Debian et qu'elle n'est pas défectueuse (vérifiez la somme de
contrôle). Les utilisateurs expérimentés d'Unix peuvent effectuer ces
opérations sans redémarrer, dans la deuxième console.

Veuillez noter que la partition (ou le disque) qui contient l'image ISO ne peut
être réutilisée pendant l'installation, car elle l'est déjà par l'installateur.
Pour contourner cela, si le système possède assez de mémoire, l'installateur
peut copier l'image ISO en mémoire RAM avant de la monter. Cela est contrôlé
par la question debconf iso-scan/copy_iso_to_ram de priorité basse (uniquement
posée si les besoins en mémoire sont satisfaits).

6.3.1.5. Configuration du réseau

Pour cette étape, si l'installateur détecte plusieurs interfaces réseau, vous
devrez indiquer quelle est la principale, c'est-à-dire celle que vous voulez
utiliser pour l'installation. Les autres interfaces ne seront pas configurées.
Vous pourrez les configurer une fois l'installation terminée. Consultez la page
du manuel interfaces(5).

6.3.1.5.1. Configuration automatique du réseau

L'installateur essaie d'abord de configurer automatiquement le réseau.
Plusieurs raisons peuvent expliquer un échec, un câble mal branché, un serveur
absent. Lisez les messages d'erreur sur la quatrième console pour des
explications. Dans tous les cas, on vous demandera si vous voulez réessayer ou
si vous voulez configurer vous-même le réseau. Les serveurs sont parfois très
lents et si vous êtes sûr que tout est en place, réessayez. En cas d'échec
répété, vous pouvez choisir de configurer vous-même le réseau.

6.3.1.5.2. Configuration manuelle du réseau

Si vous configurez vous-même le réseau, on vous demandera l'adresse IP de votre
machine, le masque réseau, l'adresse de la passerelle, les adresses des
serveurs de noms et le nom de la machine. De plus, si vous utilisez une
interface pour réseau sans fil, on vous demandera le nom ESSID du réseau et la
clé WEP ou la phrase secrète WPA/WPA2. Pour ces réponses, voyez la Section 3.3,
« Informations utiles ».

Note

Voici quelques précisions techniques que vous trouverez, ou non, utiles : le
programme suppose que l'adresse IP du réseau est le résultat d'un « ET logique
 » entre l'adresse de la machine et l'adresse du masque réseau. L'adresse de
diffusion broadcast sera le résultat d'un « OU logique » entre l'adresse de la
machine et la négation logique du masque réseau. Si vous ne connaissez aucune
de ces valeurs, utilisez les valeurs proposées par l'installateur. Vous pourrez
les changer quand le système aura été installé, en modifiant le fichier /etc/
network/interfaces.

6.3.1.5.3. IPv4 et IPv6

Depuis Debian GNU/Linux 7.0 (« Wheezy »), l'installateur Debian sait gérer IPv6
aussi bien que le « classique » IPv4. Toutes les combinaisons possibles d'IPv4
et IPv6 sont acceptées.

La configuration automatique pour IPv4 est faite par DHCP (Dynamic Host
Configuration Protocol). Celle pour IPv6 utilise NDP (Neighbor Discovery
Protocol) avec RDNSS (recursive DNS server) ou DHCPv6, ou encore un mélange des
deux (configuration de l'adresse par NDP, paramètres additionnels par DHCPv6).

6.3.2. Création des utilisateurs et des mots de passe

Juste avant la configuration de l'horloge, l'installateur permet la création du
compte du superutilisateur (« root ») et du compte du premier utilisateur.
D'autres comptes peuvent être créés une fois l'installation du système
terminée.

6.3.2.1. Mot de passe pour « Root »

Le compte root est aussi appelé le superutilisateur; c'est un utilisateur qui
peut outrepasser toutes les protections de sécurité de votre système. Le compte
superutilisateur ne devrait être utilisé que pour administrer le système, et le
moins longtemps possible.

Tout mot de passe devrait faire au moins 6 caractères, et devrait contenir tant
des minuscules que des majuscules ainsi que des caractères de ponctuation.
Soyez particulièrement soigneux lors du choix de votre mot de passe
superutilisateur en raison des privilèges qui sont associés à ce compte. Évitez
les mots du dictionnaire ou toutes les informations personnelles qui pourraient
être devinées.

Si jamais quelqu'un vous dit qu'il a besoin de votre mot de passe
superutilisateur, soyez sur vos gardes. Vous ne devriez normalement jamais
avoir besoin de le donner, à moins que vous n'administriez une machine avec
plusieurs administrateurs.

Dans le cas où vous ne saisissez pas de mot de passe pour le superutilisateur,
ce compte sera désactivé. En revanche, le paquet sudo sera installé pour
permettre d'effectuer les tâches d'administration du nouveau système, et le
premier utilisateur créé sera autorisé à utiliser la commande sudo.

6.3.2.2. Création d'un utilisateur ordinaire

Le système vous demande à ce stade si vous désirez créer un compte utilisateur
ordinaire. Ce compte devrait être votre compte personnel principal. Vous ne
devriez pas utiliser le compte superutilisateur pour un usage quotidien ou
comme votre compte personnel.

Pourquoi ? Et bien, une raison d'éviter l'utilisation des privilèges du
superutilisateur est qu'il est très aisé de faire des dommages irréparables en
tant que superutilisateur. Une autre raison est que vous pourriez lancer, sans
le savoir, un programme de type Cheval de Troie -- qui utilise avantageusement
vos pouvoirs de superutilisateur pour compromettre, à votre insu, la sécurité
de votre système. Tout bon livre sur l'administration d'un système Unix couvre
ce sujet en détails -- envisagez la lecture d'un tel livre si tout cela est
nouveau pour vous.

On vous demandera d'abord le nom et le prénom de l'utilisateur. Puis vous
choisirez un mot pour nommer le compte de l'utilisateur. En général, c'est
votre prénom ou quelque chose d'approchant. Vous indiquerez enfin le mot de
passe pour ce compte.

Si vous désirez créer un nouveau compte après l'installation, utilisez la
commande adduser.

6.3.3. Configuration de l'horloge et du fuseau horaire

L'installateur essaiera d'abord de se connecter à un serveur de temps sur
internet, en utilisant le protocole NTP. S'il ne réussit pas à configurer
correctement le temps du système, il supposera que l'heure et la date données
par l'horloge de la machine au moment de l'amorçage sont justes. Il n'existe
pas d'autres manières de configurer le temps système pendant le processus
d'installation.

Selon le pays que vous avez sélectionné au début du processus d'installation,
une liste de fuseaux horaires possibles sera affichée. Quand vous faites une
installation standard, si un seul fuseau horaire correspond à votre pays, le
système ne demandera rien et choisira ce fuseau horaire.

Quand vous faites une installation en mode expert ou avec une priorité medium,
vous pouvez choisir le fuseau horaire « Coordinated Universal Time », UTC.

Si vous désirez installer un fuseau horaire qui ne correspond pas au pays
choisi, vous avez deux possibilités.

 1. Vous pouvez simplement sélectionner un autre fuseau horaire après
    l'installation, quand le nouveau système a été amorcé. Utilisez la
    commande :

    # dpkg-reconfigure tzdata

 2. Vous pouvez aussi définir le fuseau horaire au tout début de
    l'installation, en passant le paramètre time/zone=valeur au moment
    d'amorcer l'installateur. Cette valeur doit être valable, par exemple
    Europe/London ou UTC.

Pour les installations automatisées, le fuseau horaire peut être préconfiguré
avec la valeur de son choix.

6.3.4. Partitionnement et points de montage

Après la dernière détection de matériel, l'installateur est pleinement
opérationnel et connaît les besoins de l'utilisateur. Comme l'indique le titre
de cette section, la tâche des composants de cette étape est de partitionner
les disques, créer les systèmes de fichiers et déclarer les points de montage.
Des tâches proches, comme la configuration de périphériques chiffrés ou de
périphériques LVM ou RAID, peuvent aussi être menées à bien.

Si le partitionnement vous inquiète ou si vous voulez des précisions
supplémentaires, voyez l'Annexe C, Partitionnement pour Debian.

Dans un premier temps, vous aurez la possibilité de partitionner un disque
entier ou une partie de disque, de façon automatique. C'est le partitionnement 
« assisté ». Si vous n'aimez pas ce côté automatique, choisissez l'option 
Manuel dans le menu.

6.3.4.1. Options de partitionnement

Le partitionneur de l'installateur Debian est polyvalent. Il autorise la
création de plusieurs schémas de partitionnement et permet l'utilisation de
diverses tables de partitions, systèmes de fichiers et périphériques bloc
complexes.

Les options disponibles dépendent principalement de l'architecture mais aussi
de différents facteurs. Ainsi, sur des systèmes avec peu de mémoire, certaines
options peuvent manquer. Les valeurs par défaut peuvent aussi changer. Le type
de table de partitions peut être différent sur les disques durs à grande
capacité et sur les disques durs de moindre capacité. Certaines options ne sont
modifiables que si la priorité debconf est « medium » ou « low ». Pour les
autres priorités, des valeurs par défaut pertinentes sont utilisées.

L'installateur accepte plusieurs formes de partitionnement ainsi que plusieurs
types de périphérique de stockage, lesquels peuvent être combinés.

  • Gestion des volumes logiques (LVM)

  • RAID logiciel

    Niveaux RAID reconnus : 0, 1, 4, 5, 6, 10.

  • Chiffrement

  • RAID Serial ATA (avec dmraid)

    Appelé « fake RAID » ou « BIOS RAID ». Le RAID Serial ATA n'est disponible
    que s'il a été activé au moment de l'amorçage de l'installateur. Des
    informations plus détaillées sont disponibles sur notre Wiki.

  • Multipath (expérimental)

    Consultez notre Wiki pour des informations. Le « multipath » n'est
    disponible que s'il a été activé au moment de l'amorçage de l'installateur.

Les systèmes de fichiers suivants sont reconnus :

  • ext2, ext3, ext4

    Le système de fichiers choisi par défaut est ext4 ; pour la partition /boot
    ext2 est choisi par défaut si le partitionnement assisté est utilisé.

  • jfs (pas disponible sur toutes les architectures)

  • xfs (pas disponible sur toutes les architectures)

  • reiserfs (optionnel ; pas disponible sur toutes les architectures)

    Le système Reiser n'est plus disponible automatiquement. Quand
    l'installateur s'exécute avec une priorité debconf « medium » ou « low »,
    il peut être activé en choisissant le composant partman-reiserfs. Seule la
    version 3 est disponible.

  • qnx4

    Les partitions existantes sont reconnues et il est possible de leur
    attribuer des points de montage. Il n'est pas possible de créer de
    nouvelles partitions qnx4.

  • FAT16, FAT32

  • NTFS (read-only)

    Les partitions existantes peuvent êtres redimensionnées et il est possible
    de leur attribuer des points de montage. Il n'est pas possible de créer de
    nouvelles partitions NTFS.

6.3.4.2. Le partitionnement assisté

Si vous choisissez le partitionnement assisté, vous aurez le choix entre trois
solutions : créer directement les partitions sur le disque (méthode classique),
utiliser le gestionnaire de volumes logiques (LVM, « Logical Volume management
 ») ou utiliser LVM avec chiffrement ^[9].

Note

Il se peut toutefois que cette dernière option ne soit pas disponible sur
toutes les architectures.

Si vous utilisez LVM ou LVM avec chiffrement, l'installateur créera les
partitions dans une seule grande partition. L'avantage de cette méthode est la
possibilité de redimensionner facilement ces partitions. Si elle est chiffrée,
la grande partition ne sera pas accessible sans une phrase spéciale qui
sécurisera vos données.

Avec LVM avec chiffrement, l'installateur effacera automatiquement le disque en
y écrivant des données aléatoires. Cela améliore la sécurité car cela rend
impossible de dire quelles parties du disque sont utilisées et cela efface
toutes les traces d'une installation précédente. Cependant, cela prend du
temps.

Note

Si vous avez choisi le partitionnement assisté avec LVM ou LVM avec
chiffrement, la table des partitions du disque choisi doit être modifiée. Ces
modifications détruisent réellement les données présentes sur le disque. Il ne
sera pas possible ensuite d'annuler ces modifications. Cependant,
l'installateur vous demandera de confirmer ces modifications avant qu'elles ne
soient écrites sur le disque.

Après avoir choisi le partitionnement assisté (soit la méthode classique, soit
les méthodes LVM), vous devrez choisir le disque à partitionner. Vérifiez que
tous les disques sont listés et choisissez le bon si vous avez plusieurs
disques. L'ordre de la liste peut différer de celui qui vous est habituel. La
taille des disques peut vous aider à les identifier.

Les données présentes sur le disque choisi seront finalement détruites. Mais il
vous est toujours demandé de confirmer les modifications qui doivent être
apportées. Si vous avez choisi la méthode classique, vous pourrez annuler tout
changement jusqu'à la fin du processus. Avec les méthodes LVM, cela n'est pas
possible.

Vous pourrez ensuite choisir un schéma parmi les modèles décrits dans le
tableau ci-dessous. Tous ces schémas ont leurs avantages et leurs
inconvénients, certains sont discutés dans l'Annexe C, Partitionnement pour
Debian. Choisissez le premier si vous n'avez pas d'avis tranché. N'oubliez pas
que le partitionnement assisté a besoin de suffisamment d'espace libre pour
pouvoir fonctionner. Si vous ne lui donnez pas au moins 1 Go, il échouera.

┌──────────────────────────────────────┬─────────────┬────────────────────────┐
│      Schéma de partitionnement       │   Espace    │   Partitions créées    │
│                                      │   minimum   │                        │
├──────────────────────────────────────┼─────────────┼────────────────────────┤
│Tous les fichiers dans une seule      │600 Mo       │/, swap                 │
│partition                             │             │                        │
├──────────────────────────────────────┼─────────────┼────────────────────────┤
│Partition /home distincte             │500 Mo       │/, /home, swap          │
├──────────────────────────────────────┼─────────────┼────────────────────────┤
│Partitions /home, /var et /tmp        │1 Go         │/, /home, /var, /tmp,   │
│séparées                              │             │swap                    │
└──────────────────────────────────────┴─────────────┴────────────────────────┘

Si vous avez choisi le partitionnement assisté avec LVM, l'installateur créera
aussi une partition /boot distincte. Les autres partitions (et aussi la
partition d'échange) seront créées dans la partition LVM.

Si vous avez démarré en mode EFI, une partition supplémentaire, avec un système
de fichiers FAT32 amorçable, sera créée lors du partitionnement assisté pour le
programme d'amorçage EFI. Cette partition est appelée EFI System Partition
(ESP). Il y a aussi un élément de menu supplémentaire qui permet de formater
soi-même une partition comme partition ESP.

Sur l'écran suivant, vous verrez votre table des partitions, avec le type de
formatage des partitions et leur point de montage.

La liste des partitions pourrait ressembler à ceci :

  SCSI1 (0,0,0) (sda) - 6.4 Go WDC AC36400L
        #1 primary   16.4 Mo  B f ext2      /boot
        #2 primary  551.0 Mo     swap       swap
        #3 primary    5.8 Go     ntfs
           pri/log    8.2 Mo     FREE SPACE

  SCSI2 (1,0,0) (sdb) - 80.0 Go ST380021A
        #1 primary   15.9 Mo      ext3
        #2 primary  996.0 Mo      fat16
        #3 primary    3.9 Go      xfs        /home
        #5 logical    6.0 Go    f ext4       /
        #6 logical    1.0 Go    f ext3       /var
        #7 logical  498.8 Mo      ext3

Cet exemple affiche les partitions de deux disques durs. Le premier possède un
espace libre. Chaque ligne donne le numéro de la partition, son type, sa
taille, des drapeaux facultatifs, le système de fichiers et le point de montage
s'il existe. Note : cet exemple ne peut pas être créé avec le partitionnement
assisté, mais il peut l'être avec le partitionnement manuel.

Ainsi se termine le partitionnement assisté. Si vous êtes satisfait de la table
des partitions créée, vous pouvez sélectionner Terminer le partitionnement et
écrire les modifications sur le disque dans le menu pour la créer réellement
(voyez la fin de cette section). Si vous n'êtes pas satisfait, vous pouvez
choisir Ne pas modifier les partitions pour relancer le partitionnement assisté
ou bien pour modifier les changements proposés, voyez le partitionnement « 
manuel » ci-dessous.

6.3.4.3. Le partitionnement « manuel »

Un écran similaire au précédent sera affiché si vous avez choisi le
partitionnement manuel ; mais c'est votre table des partitions qui est montrée,
sans les points de montage. La suite de cette section expliquera comment créer
une table des partitions et indiquera l'usage de ces partitions.

Si vous avez sélectionné un disque vierge, sans partition ni espace libre, on
vous proposera de créer une table des partitions ; c'est nécessaire pour créer
des partitions. Une nouvelle ligne, intitulée « ESPACE LIBRE » devrait
apparaître sous le disque sélectionné.

Si vous avez sélectionné un espace libre, on vous proposera de créer de
nouvelles partitions. On vous posera des questions sur la taille de la
partition, son type (primaire ou logique), son début et sa fin dans l'espace
libre. Puis la nouvelle partition sera présentée en détail. L'élément principal
est Utiliser comme : qui indique si la partition possède un système de fichiers
ou si elle est utilisée comme partition d'échange, comme système RAID, LVM, si
elle est chiffrée, ou si elle n'est pas utilisée du tout. Il y a d'autres
options comme le point de montage, les options de montage, le drapeau
d'amorçage, tout dépend de la manière dont elle est utilisée. Si vous n'aimez
pas les valeurs présélectionnées, n'hésitez pas à les changer. Par exemple, en
choisissant l'option Utiliser comme :, vous pouvez demander un autre système de
fichiers ou demander d'utiliser cette partition comme partition d'échange,
comme partition RAID logiciel ou partition LVM, et même demander de ne pas
l'utiliser du tout. Quand vous êtes satisfait de votre nouvelle partition,
choisissez Terminer le paramétrage de la partition et vous serez ramené à
l'écran principal de partman.

Si vous voulez modifier votre partition, sélectionnez-la et vous reviendrez au
menu de configuration des partitions. C'est le même écran que pour une création
et vous pourrez aussi changer les mêmes options. Ce n'est pas évident au
premier regard, mais on peut modifier la taille de la partition en
sélectionnant l'élément affichant la taille. Les systèmes de fichiers fat16,
fat32, ext2, ext3 et swap sont réputés bien fonctionner. Ce menu permet aussi
de supprimer une partition.

N'oubliez pas de créer au moins deux partitions, une partition d'échange swap
et une partition pour le système de fichiers de la racine (root) qui sera monté
sur /. Si vous ne montez pas le système de fichiers de la racine, partman ne
pourra continuer que si vous corrigez le problème.

Si vous avez démarré en mode EFI mais avez oublié de créer une partition ESP, 
partman le détectera et vous demandera d'en créer une.

On peut ajouter des fonctionnalités à partman avec des modules de
l'installateur. Aussi, quand vous ne trouvez pas les options promises, vérifiez
que vous avez chargé tous les modules requis, par exemple, partman-ext3,
partman-xfs, ou partman-lvm.

Quand les choix de partitionnement vous conviennent, choisissez l'option 
Terminer le partitionnement et appliquer les changements du menu. Un résumé des
modifications apportées aux disques sera affiché et on vous demandera une
confirmation avant de créer les systèmes de fichiers.

6.3.4.4. Configuration d'un périphérique multidisque (RAID logiciel)

Si vous avez plusieurs disques durs ^[10] sur votre machine, vous pouvez
utiliser partman-md pour obtenir de vos disques de meilleures performances et
une meilleure fiabilité de vos données. Le résultat est un périphérique
multidisque, Multidisk Device, ou RAID logiciel.

Un périphérique multidisque n'est qu'un ensemble de partitions situées sur
différents disques mais réunies pour former un périphérique logique. Ce
périphérique peut alors être utilisé comme une simple partition, c'est-à-dire
une partition qu'on peut monter et formater avec partman.

Ce que vous gagnez dépend du type de périphérique créé. Voici ceux qui sont
reconnus :

RAID0

    Ce type vise principalement la performance. RAID0 divise toutes les données
    entrantes en bandes et les distribue également sur tous les disques. Cela
    peut augmenter la vitesse des opérations d'écriture et de lecture, mais si
    l'un des disques a un problème, vous perdez tout : une partie des
    informations est encore sur les disques sains, mais l'autre était sur le
    disque défectueux.

    L'utilisation standard de RAID0 est une partition pour du travail vidéo.

RAID1

    Ce type est adapté là où la fiabilité est le premier souci. Il consiste en
    plusieurs partitions de même taille (deux, habituellement) qui contiennent
    exactement les mêmes données. Cela signifie essentiellement trois choses.
    Premièrement, si l'un des disques a un problème, les données sont encore
    sur les autres disques. Deuxièmement, vous pouvez utiliser une partie
    seulement de la capacité disponible, précisément, la taille de la partition
    la plus petite du RAID. Troisièmement, la charge de lecture des fichiers
    est répartie entre tous les disques, ce qui peut améliorer les performances
    d'un serveur, notamment les serveurs de fichiers où les lectures sont plus
    nombreuses que les écritures de fichiers.

    Vous pouvez aussi inclure dans un tel ensemble un disque de rechange qui
    prendra la place du disque défectueux en cas de problème.

RAID5

    Ce type est un bon compromis entre vitesse, fiabilité et redondance des
    données. RAID5, comme RAID0, divise toutes les données entrantes en bandes
    et les distribue également sur tous les disques. Mais contrairement à
    RAID0, RAID5 calcule aussi l'information de parité, qui est écrite sur le
    disque restant. Le disque de parité n'est pas fixe (ce serait RAID4), il
    change périodiquement et ainsi l'information de parité est distribuée
    également sur tous les disques. Quand l'un des disques s'arrête, la partie
    manquante des données peut être calculée avec les données restantes et la
    parité. RAID5 doit comporter au moins trois partitions actives. Vous pouvez
    aussi inclure un disque de rechange qui prendra la place du disque
    défectueux en cas de problème.

    Comme on le voit, RAID5 est aussi fiable que RAID1 tout en évitant de la
    redondance. D'un autre côté, il sera un tout petit peu moins rapide dans
    les opérations d'écriture que RAID0, à cause du calcul de l'information de
    parité.

RAID6

    RAID6 est semblable à RAID5 mais il y a deux disques de parité au lieu d'un
    seul.

    Un système RAID6 peut supporter jusqu'à deux défaillances de disque.

RAID10

    Le niveau RAID10 combine la répartition en bandes comme dans le RAID0 et la
    duplication des données comme dans le RAID1. Il crée n copies des données
    et les distribue dans les partitions de manière à ce que les copies des
    mêmes données ne soient pas sur le même disque. La valeur par défaut de n
    est 2, mais elle peut être modifiée en mode expert. Le nombre de partitions
    utilisées doit être au moins égal à n. Plusieurs schémas existent pour la
    répartition des copies. Par défaut, le mode near est utilisé. Dans ce mode,
    les copies ont la même position sur tous les disques. Dans le mode far, les
    copies ont des positions différentes sur les disques. Dans le mode offset,
    c'est la bande qui est copiée, non le bloc de données.

    Le niveau RAID10 propose fiabilité et redondance sans avoir à calculer des
    informations de parité.

Pour résumer :

┌──────┬─────────┬──────────┬───────────┬─────────────────────────────────────┐
│      │ Nombre  │          │ Supporte  │                                     │
│ Type │ minimum │Disque de │  l'échec  │          Espace disponible          │
│      │   de    │ rechange │   d'un    │                                     │
│      │ disques │          │ disque ?  │                                     │
├──────┼─────────┼──────────┼───────────┼─────────────────────────────────────┤
│      │         │          │           │Taille de la plus petite partition   │
│RAID0 │2        │non       │non        │multipliée par le nombre des         │
│      │         │          │           │périphériques dans l'ensemble        │
├──────┼─────────┼──────────┼───────────┼─────────────────────────────────────┤
│RAID1 │2        │facultatif│oui        │Taille de la plus petite partition   │
│      │         │          │           │dans l'ensemble                      │
├──────┼─────────┼──────────┼───────────┼─────────────────────────────────────┤
│      │         │          │           │Taille de la plus petite partition   │
│RAID5 │3        │facultatif│oui        │multipliée par (le nombre des        │
│      │         │          │           │périphériques dans l'ensemble moins  │
│      │         │          │           │un).                                 │
├──────┼─────────┼──────────┼───────────┼─────────────────────────────────────┤
│      │         │          │           │Taille de la plus petite partition   │
│RAID6 │4        │facultatif│oui        │multipliée par (le nombre des        │
│      │         │          │           │périphériques dans l'ensemble moins  │
│      │         │          │           │deux).                               │
├──────┼─────────┼──────────┼───────────┼─────────────────────────────────────┤
│RAID10│2        │facultatif│oui        │Total des partitions divisé par le   │
│      │         │          │           │nombre de copies (deux, par défaut)  │
└──────┴─────────┴──────────┴───────────┴─────────────────────────────────────┘

Si vous voulez tout savoir sur le RAID logiciel, lisez le HOWTO sur le RAID
logiciel.

Pour créer un périphérique multidisque, vous devez préparer les partitions
nécessaires. Vous pouvez le faire avec partman, dans le menu Caractéristiques
de la partition où vous choisirez Utiliser comme : → volume physique pour RAID

Note

Assurez-vous que le système peut être amorcé avec le schéma de partitionnement
prévu. Quand on utilise RAID pour le système de fichiers racine (/), il est
nécessaire de créer un système de fichiers distinct pour /boot. La plupart des
programmes d'amorçage (grub par exemple) ne peuvent fonctionner qu'avec le type
RAID1 (RAID en mode miroir, sans bande). Ainsi, il est possible d'utiliser
RAID5 pour / et RAID1 pour /boot.

Ensuite, vous choisissez Configurer le RAID logiciel dans le menu principal de 
partman. Le menu n'apparaît que si vous avez sélectionné au moins une partition
à utiliser comme volume physique pour RAID. Dans le premier écran de partman-md
, sélectionnez Créer un périphérique multidisque. Une liste des types acceptés
pour ces périphériques est affichée et vous pouvez en choisir un, par exemple
RAID1. La suite dépend du type que vous avez choisi.

  • Le type RAID0 est simple. Une liste des partitions RAID disponibles est
    présentée et tout ce que vous avez à faire est de choisir les partitions
    qui composeront le périphérique.

  • Le type RAID1 est un peu plus compliqué. On vous demandera d'abord le
    nombre de périphériques actifs et le nombre de périphériques de rechange
    qui composeront le périphérique. Ensuite vous devrez choisir dans la liste
    des partitions RAID celles qui seront actives et celles qui resteront en
    réserve. Le nombre de ces partitions devra être égal à celui donné
    l'instant d'avant. Si vous n'indiquez pas la même valeur, l'installateur ne
    vous laissera pas continuer et vous demandera de rectifier.

  • RAID5 se configure comme RAID1, mais vous devez utiliser au moins trois
    partitions actives.

  • RAID6 se configure comme RAID1, mais vous devez utiliser au moins quatre
    partitions actives.

  • RAID10 se configure comme RAID1, excepté en mode expert. Dans ce mode,
    l'installateur demande le schéma de répartition des données. Ce schéma est
    en deux parties. La première est le type du schéma, soit n (pour copie near
    ), soit f (pour copie far), soit o (pour copie offset). La seconde partie
    est le nombre de copies à faire. Il doit y avoir au moins autant de disques
    actifs que ce nombre, pour que les copies puissent être réparties sur ces
    disques.

Il est parfaitement possible d'avoir plusieurs types de périphérique
multidisque en même temps. Par exemple, avec trois disques durs de 200 Go,
chacun contenant deux partitions de 100 Go, vous pouvez créer un périphérique
multidisque de type RAID0 avec les premières partitions des trois disques (une
partition rapide de 300 Go pour le travail vidéo) et vous pouvez combiner les
trois partitions restantes (deux actives, une de rechange) dans un périphérique
RAID1 (une partition très fiable de 100 Go pour /home).

Quand vous avez défini vos périphériques multidisques, vous pouvez choisir 
Terminer partman-md pour retourner au menu de partman et créer les systèmes de
fichiers et les options habituelles comme les points de montage pour ces
nouveaux périphériques.

6.3.4.5. Configuration du « Logical Volume Manager » (LVM)

Si vous travaillez sur les ordinateurs comme administrateur système ou si vous
êtes un utilisateur « avancé », vous avez sûrement rencontré le cas suivant :
une partition qui manque d'espace libre (c'est habituellement la plus
importante du système) et une partition grossièrement sous-utilisée, la gestion
de cette situation ayant consisté en déplacement de fichiers, création de liens
symboliques, etc.

Pour éviter cette situation, on peut utiliser un gestionnaire de volumes
logiques, « Logical Volume Manager » (LVM). Dit simplement, avec LVM vous
pouvez combiner vos partitions (volumes physiques dans le lexique LVM) pour
former un disque virtuel (groupe de volumes) qui peut être divisé en partitions
virtuelles (volumes logiques). L'idée est que les volumes logiques s'étendent
sur plusieurs disques physiques.

Dès lors, quand vous constatez que votre vieille partition /home de 160 Go a
besoin d'espace, vous pouvez simplement ajouter un disque de 300 Go à votre
machine, l'intégrer au groupe de volumes existant et redimensionner le volume
logique qui comprend la partition /home et vos utilisateurs ont de nouveau de
la place sur la partition de 460 Go ! Cet exemple est bien sûr un peu
simplifié. Si vous ne l'avez pas encore lu, vous devriez consulter le HOWTO LVM
.

La configuration de LVM dans l'installateur Debian est très simple. D'abord,
vous devez marquer les partitions à utiliser comme volumes physiques par LVM.
Cela se fait avec partman dans le menu Configuration des partitions, où vous
choisissez Utiliser comme : → volume physique pour LVM.

Avertissement

Soyez prudents : la nouvelle configuration de LVM effacera toutes les données
sur toutes les partitions marquées du type LVM. Donc, si vous avez déjà une
configuration LVM sur certains de vos disques, et que vous voulez installer
Debian en plus sur cette machine, l'ancienne configuration (l'existante) sera
supprimée. Il en va de même pour les partitions qui sont (pour quelque raison
que ce soit) marquées du type LVM mais qui contiennent autre chose (un volume
chiffré par exemple). Vous devrez débrancher ces disques du système avant de
commencer une nouvelle configuration de LVM.

Quand vous revenez à l'écran principal de partman, vous voyez une nouvelle
option Configurer LVM, le gestionnaire des volumes logiques. Quand vous la
sélectionnez, on vous demande d'abord de confirmer les modifications en attente
pour la table des partitions (s'il y en a) et le menu de configuration de LVM
sera affiché. Le menu n'affiche que les actions valables selon le contexte. Les
actions possibles sont :

  • Afficher les détails de la configuration : montre la structure des volumes
    LVM, le nom et la taille des volumes, etc.

  • Créer un groupe de volumes

  • Créer un volume logique

  • Supprimer un groupe de volumes

  • Supprimer un volume logique

  • Étendre un volume logique

  • Réduire un volume logique

  • Terminer : retourne à l'écran principal de partman.

Utilisez les options de ce menu pour créer d'abord un groupe de volumes et pour
créer ensuite les volumes logiques.

Quand vous revenez à l'écran principal de partman, tous les volumes logiques
créés sont affichés comme si c'étaient de simples partitions, et vous devez les
traiter ainsi.

6.3.4.6. Configuration des volumes chiffrés

L'installateur Debian permet le chiffrement des partitions. Tout fichier
destiné à une partition chiffrée est sauvegardé sur le périphérique sous une
forme chiffrée. L'accès aux données chiffrées n'est autorisé qu'après avoir
fourni la phrase secrète qui avait été donnée lors de la création de la
partition chiffrée. Ce mécanisme est utile pour protéger des données sensibles
en cas de vol du portable ou du disque dur. Le voleur a bien un accès physique
au disque dur mais, sans la phrase secrète, les données ne sont qu'une suite
inintelligible de caractères.

Le chiffrement est particulièrement important pour deux partitions, la
partition /home avec les données privées et la partition d'échange où peuvent
se trouver stockées temporairement des données sensibles. Bien sûr, vous pouvez
chiffrer n'importe quelle partition, par exemple /var où se trouvent les
données des serveurs de bases de données, des serveurs de courrier ou
d'impression, /tmp avec ses fichiers temporaires, etc. Vous pouvez même
chiffrer le système complet. Généralement, la seule exception est qu'on ne peut
pas chiffrer la partition /boot car il n'existait historiquement aucun moyen de
charger le noyau à partir d'une partition chiffrée. (GRUB est maintenant
capable de le faire, mais l'installateur Debian ne gère pas encore nativement
le chiffrage de /boot. Cependant, cette situation est documentée dans un autre
document.)

Note

Il faut noter que la performance d'une machine avec partitions chiffrées sera
inférieure à celle d'un machine sans. En effet, les données doivent être
chiffrées ou déchiffrées à chaque lecture ou écriture. L'impact sur la
performance dépend de la vitesse du processeur, de l'algorithme choisi et de la
longueur de la clé.

Pour chiffrer une partition, vous devez d'abord la créer, dans le menu de
partitionnement. Une autre possibilité est d'utiliser une partition existante,
par exemple, une partition ordinaire, un volume logique (LVM) ou un volume
RAID. Dans le menu Caractéristiques de la partition, vous devez modifier la
première option pour qu'elle affiche Utiliser comme : → volume physique à
chiffrer. Le menu affichera alors différentes options de chiffrement pour la
partition.

La méthode de chiffrement prise en charge par l'installateur Debian est
dm-crypt (incluse dans les noyaux Linux récents capables de prendre en charge
les volumes physiques avec LVM)

Voyons les options disponibles quand on a sélectionné la méthode de chiffrement
Device-mapper (dm-crypt). N'oubliez pas qu'en cas de doute il faut utiliser les
options par défaut, car elles ont été choisies en visant la sécurité
d'utilisation.

Chiffrement : aes

    Cette option permet de choisir l'algorithme de chiffrement (cipher) qui
    servira à chiffrer les données de la partition. Actuellement l'installateur
    Debian accepte les algorithmes de type bloc suivants : aes, blowfish,
    serpent et twofish. Nous ne discuterons pas ici de la qualité de ces
    différents algorithmes. Cependant, il peut être utile de savoir que
    l'algorithme AES a été choisi en 2000 par l'American National Institute of
    Standards and Technology pour la protection des données sensibles au
    21e siècle.

Taille de clé : 256

    Vous pouvez choisir ici la taille de la clé de chiffrement. Plus la taille
    de la clé est grande, plus la force du chiffrement est augmentée.
    Cependant, la taille de la clé a un impact négatif sur la performance. Les
    différentes tailles de clé dépendent de l'algorithme de chiffrement.

Algorithme IV : xts-plain64

    L'algorithme de type Initialization Vector ou IV assure que si l'on
    applique l'algorithme sur le même texte en clair avec la même clé, on
    obtiendra toujours un texte chiffré différent. L'idée est d'empêcher la
    déduction d'information à partir de motifs répétés dans les données
    chiffrées.

    De toutes ces possibilités, l'option par défaut xts-plain64 est
    actuellement la moins vulnérable aux attaques connues. Ne choisissez les
    autres options que pour assurer la compatibilité avec des systèmes déjà
    installés qui ne reconnaissent pas les nouveaux algorithmes.

Clé de chiffrement : phrase secrète

    Vous pouvez choisir ici le type de la clé de chiffrement pour cette
    partition.

    phrase secrète

        La clé de chiffrement sera calculée ^[11] à partir d'une phrase que
        vous pourrez saisir plus tard dans le processus.

    Clé aléatoire

        Une nouvelle clé est calculée avec des données aléatoires chaque fois
        que la partition chiffrée est montée. En d'autres termes, à chaque
        arrêt de la machine le contenu de la partition est perdu, car la clé
        est supprimée de la mémoire. On pourrait essayer de deviner la clé au
        moyen d'une attaque de type force brute, mais, à moins d'une faiblesse
        non connue de l'algorithme, une vie entière n'y suffirait pas.

        Les clés aléatoires sont adaptées aux partitions d'échange, car vous
        n'avez pas besoin de mémoriser une phrase secrète ou d'effacer des
        données sensibles de la partition d'échange avant d'éteindre la
        machine. Cependant, cela signifie que vous ne pourrez pas utiliser la
        fonctionnalité « suspend-to-disk » qu'offrent les noyaux Linux récents.
        Il est en effet impossible (pendant le redémarrage) de récupérer les
        données écrites sur la partition d'échange.

Effacer les données : oui

    Cette option détermine si la partition doit être remplie de données
    aléatoires avant le début du chiffrement. Cette opération est recommandée
    car un attaquant pourrait sinon discerner quelles parties de la partition
    sont actives et lesquelles ne le sont pas. De plus, cela rendra plus
    difficile de récupérer des données laissées par des installations
    précédentes ^[12].

Après avoir choisi les paramètres des partitions chiffrées, vous pouvez revenir
dans le menu de partitionnement. Une entrée Configuration des volumes chiffrés
devrait être présente. Quand vous la sélectionnez, on vous demande de confirmer
la suppression des données sur les partitions à supprimer ainsi que d'autres
actions comme l'écriture d'une nouvelle table des partitions. Pour les grandes
partitions, cela peut prendre du temps.

On vous demandera ensuite de saisir une phrase secrète pour les partitions qui
en utilisent. Une bonne phrase doit contenir plus de huit caractères, mélanger
les lettres, les chiffres et les autres caractères, ne pas comporter des mots
du dictionnaire ou des informations personnelles comme dates de naissance,
loisirs, petits noms, noms des membres de la famille ou des amis, etc.

Avertissement

Avant de saisir une phrase, vous devez être sûr que le clavier est correctement
configuré et affiche bien les caractères attendus. Si ce n'est pas le cas, vous
pouvez passer sur la deuxième console et saisir quelques caractères. Cela vous
évitera de saisir une phrase avec un clavier configuré en « qwerty » alors qu'à
l'installation vous l'aviez configuré en « azerty ». Cette situation peut avoir
plusieurs causes. Vous avez changé de carte clavier pendant l'installation, ou
bien la carte clavier n'est pas encore configurée au moment où vous saisissez
la phrase secrète pour le système de fichiers racine.

Si vous avez choisi une méthode sans phrase secrète pour créer une clé de
chiffrement, la clé sera créée maintenant. Comme le noyau, à ce stade de
l'installation, peut manquer d'entropie, cela peut prendre du temps. Vous
pouvez accélérer le processus en pressant des touches au hasard ou en passant
sur la deuxième console et en créant du trafic réseau ou disque (télécharger
des fichiers, envoyer des fichiers sur /dev/null, etc.). L'opération est
répétée pour chaque partition à chiffrer.

De retour dans le menu principal de partitionnement, vous pourrez voir tous les
volumes chiffrés listés comme partitions supplémentaires que vous pouvez
configurer de la même façon que des partitions ordinaires. L'exemple suivant
montre un volumes chiffré avec dm-crypt.

Volume chiffré (sda2_crypt) - 115.1 Go Linux device-mapper
        #1 115.1 Go  F ext3


C'est le moment d'affecter des points de montage aux volumes et de modifier les
types de système de fichiers si les types par défaut ne vous conviennent pas.

Notez bien les identifiants entre parenthèses (sda2_crypt dans ce cas) et le
point de montage affecté à chaque volume chiffré. Vous aurez besoin de ces
informations quand vous amorcerez le nouveau système. Les différences entre un
processus de démarrage ordinaire et un processus impliquant des questions de
chiffrement seront abordées dans la Section 7.2, « Le montage des volumes
chiffrés ».

Une fois le schéma de partitionnement terminé, vous pouvez poursuivre
l'installation.

6.3.5. L'installation du système de base

Quoique cette étape de l'installation soit la moins compliquée, elle consomme
une grande partie du temps de l'installation ; c'est pendant cette étape que
sont téléchargés, vérifiés et installés tous les paquets du système de base. Si
votre ordinateur est lent ou si vous utilisez une connexion réseau, cela peut
prendre du temps.

Pendant l'installation du système de base, les messages concernant la
décompression et la configuration des paquets sont redirigés sur tty4. On peut
accéder à ce terminal en faisant Left Alt+F4 ; et l'on revient au processus
principal avec Left Alt+F1.

Les messages concernant la décompression et la configuration des paquets
produits par le processus d'installation sont enregistrés dans le fichier /var/
log/syslog. Vous pouvez les lire dans ce fichier quand l'installation se fait
avec une console série.

Le noyau Linux fait partie de l'installation. Avec la priorité par défaut,
l'installateur choisira le noyau qui correspond le mieux à votre matériel. Avec
les priorités les plus basses, vous pourrez en choisir un dans une liste.

Quand le système de gestion des paquets installe des paquets, il installe aussi
par défaut les paquets qui sont « recommandés » par ces paquets. Les paquets « 
recommandés » ne sont pas absolument nécessaires aux fonctions de base des
logiciels, mais ils les améliorent. Dans l'esprit des responsables de paquets,
ils doivent être installés.

Note

Pour des raisons techniques, les paquets « recommandés » par les paquets
installés pendant le processus d'installation du système de base ne sont pas
installés. La règle décrite précédemment n'est appliquée qu'après
l'installation du système de base.

6.3.6. Installation de logiciels supplémentaires

Pour l'instant, vous avez un système viable mais limité. La plupart des
utilisateurs voudront installer d'autres logiciels et l'installateur le permet.
Cette étape peut prendre plus de temps que l'installation du système de base
sur des ordinateurs lents.

6.3.6.1. La configuration d'apt

Le principal outil utilisé pour installer des paquets sur les systèmes Debian
GNU/Linux est le programme apt qui se trouve dans le paquet apt ^[13]. Il
existe aussi d'autres frontaux comme aptitude et synaptic. Ces frontaux
conviviaux sont recommandés pour les débutants, car ils offrent des fonctions
supplémentaires comme la recherche de paquets ou la vérification des états.

apt doit être configuré pour qu'il sache où récupérer les paquets. Les
résultats de cette configuration sont transcrits dans le fichier /etc/apt/
sources.list. Vous pouvez le consulter et le modifier à votre guise quand
l'installation est terminée.

Quand la priorité de l'installation est la priorité par défaut, l'installateur
prend automatiquement en charge cette configuration, en fonction de la méthode
d'installation et des choix précédemment faits. Dans la plupart des cas, il
installe automatiquement un miroir pour les mises à jour de sécurité et, si
vous installez la distribution stable, un miroir pour le service de mise à jour
« stable-updates ».

Quand la priorité de l'installation est une priorité plus basse (en mode expert
par exemple), vous pourrez prendre davantage de décisions. Vous pouvez choisir
d'utiliser ou non les services de mise à jour (« security » ou « stable-updates
 »), vous pouvez choisir d'ajouter des paquets appartenant aux sections « 
contrib » ou « non-free » de la distribution.

6.3.6.1.1. Installation avec plusieurs images de CD ou DVD

Si l'installation se fait à partir d'une image de CD ou DVD, l'installateur
demandera si vous voulez faire analyser d'autres supports. Si vous en possédez
plusieurs, c'est une bonne idée. L'installateur pourra installer les paquets
ainsi mis à disposition.

Il n'est pas nécessaire de posséder d'autres supports. Cependant, si vous
n'utilisez pas non plus de miroir réseau (cf. la section suivante), il se peut
que certains paquets appartenant aux tâches que vous sélectionnerez dans la
prochaine étape de l'installation ne puissent pas être installés.

Note

Les paquets sont classés sur les images de CD et DVD par ordre de popularité.
Ainsi, pour la plupart des utilisations, seuls les premières images sont
nécessaires. Très peu de personnes utilisent les dernières images d'un
ensemble.

C'est pourquoi acheter ou graver un ensemble complet de CD/DVD n'est qu'une
perte d'argent, car vous n'utiliserez jamais tous les CD/DVD de cet ensemble.
Il vaut mieux ne prendre que les trois premiers CD (ou les huit premiers) et
installer les autres paquets souhaités à partir d'un miroir réseau. De même,
pour les ensembles de DVD, le premier (ou les deux premiers) satisfera tous les
besoins usuels.

Si vous faites analyser plusieurs supports d'installation, l'installateur vous
demandera de les changer quand il aura besoin d'installer un paquet se trouvant
sur un autre. Il est recommandé de ne faire analyser que les disques d'un même
ensemble. L'ordre dans lequel ils sont analysés n'a pas d'importance.
Cependant, une analyse faite selon l'ordre ascendant réduit les risques
d'erreur.

6.3.6.1.2. Utiliser un miroir réseau

Dans la plupart des installations, la question concernant l'utilisation ou non
d'un miroir réseau est posée et, dans la plupart des cas, la réponse par défaut
est correcte. Cependant, il existe des exceptions.

Si l'installation n'est pas faite à partir d'une image de CD ou DVD complet,
l'utilisation d'un miroir réseau est conseillée. En effet, sans miroir réseau,
vous n'installerez qu'un système réduit au minimum. Cependant, si vous ne
possédez pas une bonne connexion internet, il vaut mieux ne pas choisir la
tâche desktop dans la prochaine étape de l’installation

Si vous faites une installation à partir d'une unique image de CD, le miroir
réseau n'est pas nécessaire ; cependant, il est fortement recommandé, car une
image de CD ne contient que peu de paquets. Si vous ne possédez pas une bonne
connexion internet, il reste préférable de ne pas choisir un miroir réseau et
de terminer l'installation avec ce qui se trouve sur l'image de CD. Après
l'installation, c'est-à-dire après le lancement du nouveau système, vous
pourrez ajouter d'autres paquets.

Si vous faites une installation à partir d'un DVD, tous les paquets nécessaires
à l'installation devraient être présents sur la première image de DVD.
L'utilisation d'un miroir réseau est facultative.

L'un des avantages du miroir réseau est qu'il rend disponibles les mises à jour
apparues depuis la création des images de CD ou DVD et intégrées dans une
version intermédiaire de la distribution. La durée de vie des CD et DVD est
ainsi allongée sans compromettre la sécurité et la stabilité du système
installé.

En résumé, choisir un miroir réseau est une bonne idée, sauf si votre connexion
internet n'est pas de bonne qualité. Si la version courante d'un paquet est
présente sur l'image de CD ou DVD, l'installateur l'utilisera. La quantité de
données téléchargées à partir d'un miroir dépend :

 1. des tâches choisies lors de la prochaine étape de l'installation ;

 2. des paquets nécessaires à ces tâches ;

 3. de la présence de ces paquets sur les supports d'installation analysés ;

 4. de l'existence de nouvelles versions de ces paquets sur un miroir réseau,
    offrant soit la distribution standard, soit les services de mises à jour « 
    security » ou « stable-updates ».

Il faut noter que même si vous avez choisi de ne pas utiliser de miroir,
certains paquets peuvent être téléchargés sur internet, par exemple, s'il
existe de nouvelles versions des paquets et que les services de mises à jour « 
security » ou « stable-updates » ont été installés.

6.3.6.1.3. Choisir un miroir réseau

À moins d'avoir choisi de ne pas utiliser de miroir réseau, une liste vous est
présentée contenant les miroirs, choisis par rapport au pays que vous avez
précédemment indiqué. Le miroir proposé par défaut peut être sélectionné sans
problème.

Le miroir par défaut deb.debian.org n'est pas un vrai miroir, mais redirige
vers un miroir qui devrait être rapide et à jour. Ces miroirs prennent en
charge TLS (protocole https) et l'IPv6. Ce service est maintenu par l'équipe
d'administrateurs système de Debian (DSA).

Vous pouvez aussi indiquer un miroir en choisissant « Entrez l'information
vous-même » et en saisissant le nom du miroir et un numéro de port
(facultatif). Ce nom doit être une URL, c'est-à-dire, si vous spécifiez une
adresse IPv6, vous devez ajouter les crochets, « [2001:db8::1] ».

Si votre ordinateur est sur un réseau uniquement IPv6 (ce qui n'est sans doute
pas le cas de la grande majorité des utilisateurs), le miroir par défaut peut
ne pas fonctionner. Tous les miroirs de la liste sont atteignables en IPv4,
mais seuls quelques uns utilisent IPv6. Comme la connectivité de chaque miroir
se modifie au cours du temps, cette information n'est pas connue par
l'installateur. Si le miroir par défaut de votre pays n'utilise pas IPv6, vous
pouvez essayer les autres miroirs de la liste ; vous pouvez aussi choisir
l'option « Entrer l'information vous-même » et indiquer le miroir « 
ftp.ipv6.debian.org », qui est l'alias d'un miroir atteignable en IPv6. Il ne
sera sans doute pas le plus rapide.

6.3.6.2. Sélection et installation des paquets

Pendant l'installation, il vous est proposé de choisir des logiciels à
installer. Plutôt que de choisir les paquets un par un parmi les 87573 paquets
disponibles, vous pourrez, pendant cette phase de l'installation, sélectionner
et installer un certain nombre de collections de logiciels prédéfinies.

Ces tâches représentent grosso modo les différents travaux qu'on peut faire
avec son ordinateur, par exemple de la « bureautique », du « service web » ou
encore du « serveur SSH » ^[14]. L'espace nécessaire pour chaque tâche est
indiqué dans la Section D.2, « Espace disque nécessaire pour les tâches ».

Certaines tâches peuvent avoir été présélectionnées en fonction de la machine
sur laquelle vous faites l'installation. Si vous n'êtes pas d'accord avec ces
sélections, vous pouvez désélectionner ces tâches ; vous pouvez même
n'installer aucune tâche.

Astuce

Dans l'interface standard de l'installateur, vous pouvez utiliser la barre
d'espace pour sélectionner une tâche.

Note

La tâche « Environnement graphique de bureau » installe l'environnement de
bureau.

Par défaut, l'installateur Debian installe l'environnement de bureau Gnome. Il
est possible de choisir un environnement de bureau différent pendant
l'installation. Il est aussi possible d'installer plusieurs environnements de
bureau, mais certaines combinaisons ne sont pas possibles.

Il est aussi nécessaire que les paquets composant les environnements soient
disponibles. Si vous faites une installation à partir de l'image d'un seul CD,
il faudra peut être télécharger les paquets depuis un miroir, car ils peuvent
ne pas être sur le premier CD. Avec une image DVD ou une autre méthode
d'installation, tous les environnements de bureau s'installent parfaitement.

Les différentes tâches serveur installeront globalement les logiciels suivants.
Serveur web : apache2 ; serveur SSH : openssh.

La tâche « Standard system » installe tous les paquets dont la priorité est « 
standard ». Beaucoup d'utilitaires habituellement disponibles sur les systèmes
Linux ou Unix sont dans ce cas. Vous devez laisser cette tâche à moins de ne
vouloir réellement qu'un système minimal.

Si pendant la phase de choix de la langue, une « locale » autre que « C » a été
choisie, le programme tasksel recherchera s'il existe une tâche de localisation
pour cette locale et installera tous les paquets relatifs à cette tâche, comme
par exemple les paquets contenant des dictionnaires ou des polices spéciales.
Si un environnement de bureau a été choisi, il installera aussi les paquets
nécessaires à la localisation du système.

Une fois les tâches sélectionnées, choisissez Continue. Apt installera les
paquets qui font partie des tâches demandées. Quand un programme a besoin
d'informations, l'utilisateur est interrogé.

Il est important de savoir que la tâche Environnement graphique de bureau
comprend beaucoup de paquets. En particulier, si vous faites une installation à
partir d'un CD en combinaison avec un miroir pour les paquets qui ne sont pas
sur le CD, l'installateur téléchargera beaucoup de paquets. Si votre connexion
à internet est relativement lente, cela peut prendre beaucoup de temps. Il
n'existe pas d'option pour interrompre l'installation des paquets une fois
qu'elle a commencé.

Même quand les paquets sont sur le CD, l'installateur peut les télécharger sur
le miroir si la version sur le miroir est plus récente que celle sur le CD. Si
vous installez la distribution stable, cela peut arriver après une mise à jour
de cette distribution (point release). Si vous installez la distribution 
testing, cela peut arriver si vous utilisez une image plus ancienne.

6.3.7. Rendre le système amorçable

Si vous installez Debian sur un poste de travail sans disque, amorcer le disque
est une option sans intérêt et cette étape sera évitée.

6.3.7.1. Détecter les autres systèmes d'exploitation

Avant l'installation du programme d'amorçage, l'installateur recherche les
systèmes d'exploitation installés sur la machine. S'il reconnaît un système
d'exploitation, vous en serez informé et l'installateur configurera le
programme d'amorçage pour pouvoir démarrer aussi bien ce système que Debian.

Notez que la possibilité d'amorcer différents systèmes sur une même machine
relève encore de la magie. Le support de détection et de configuration
automatique des programmes d'amorçage est différent pour chaque architecture et
même pour chaque sous-architecture. Si l'automatisation ne fonctionne pas
correctement, reportez-vous à la documentation propre à votre programme
d'amorçage pour plus d'information.

6.3.7.2. Installer le programme d'amorçage Grub sur le disque dur

Le programme d'amorçage pour amd64 est « grub ». Grub est un programme souple
et stable, il constitue un bon choix pour les débutants aussi bien que pour les
utilisateurs expérimentés.

Par défaut, il sera installé sur la partition UEFI ou le secteur d'amorçage,
d'où il prendra un contrôle total sur le processus d'amorçage. Mais vous pouvez
l'installer ailleurs. Voyez le manuel pour des informations complètes.

Si vous ne voulez pas installer grub, utilisez le bouton Go Back pour aller sur
le menu principal et choisissez un autre programme d'amorçage.

6.3.7.3. Continuer sans programme d'amorçage

Cette option peut être employée pour terminer l'installation même lorsqu'aucun
programme d'amorçage n'est installé soit parce qu'il n'en existe aucun pour
cette architecture, soit parce qu'on veut utiliser un autre programme.

Si vous voulez configurer vous-même un programme d'amorçage, vous devez
chercher le nom du noyau installé dans /target/boot. Vous devez aussi vérifier
la présence dans ce répertoire d'un initrd. Si ce fichier existe, vous devrez
indiquer au programme d'amorçage de l'utiliser. Vous devrez connaître aussi le
disque et la partition sur laquelle est monté le système de fichiers racine / ;
si vous avez mis /boot sur une partition distincte, vous devez connaître son
système de fichiers.

6.3.8. La fin de l'installation

Dans cette dernière étape du processus d'installation, les tâches de dernière
minute sont effectuées. Elles consistent essentiellement en un nettoyage après
le travail de l'installateur.

6.3.8.1. Configuration de l'horloge du système

L'installateur peut demander si l'horloge de votre système est réglée sur UTC.
Normalement cette question n'est pas posée et l'installateur essaie de
déterminer si l'horloge est réglée sur UTC en analysant les autres systèmes
installés.

En mode expert il est toujours possible de régler l'horloge sur UTC. Les
machines qui tournent (aussi) sous Dos ou Windows sont normalement réglées sur
l'heure locale. Si vous désirez utiliser plusieurs systèmes, sélectionnez heure
locale plutôt que GMT.

À ce point, l'installateur modifie l'horloge de la machine avec l'heure
courante en UTC ou temps local selon le choix qui a été fait précédemment.

6.3.8.2. Réamorcer le système

On vous demandera de retirer le support d'installation (CD, clé USB, etc.)
utilisé pour démarrer l'installateur. Puis l'installateur amorce le nouveau
système Debian.

6.3.9. Dépannage

Les composants suivants ne participent pas au processus d'installation, ils
attendent en silence que l'utilisateur ait besoin d'aide.

6.3.9.1. Sauvegarde des journaux de l'installation

Si l'installation a réussi, les journaux créés pendant l'installation seront
automatiquement sauvegardés dans le répertoire /var/log/installer/ sur votre
nouveau système Debian.

Choisissez Sauvegarder les journaux de débogage depuis le menu principal pour
sauvegarder les journaux sur une clé USB, le réseau, un disque dur ou un autre
support. Cela peut être utile, si vous rencontrez des problèmes durant
l'installation et que vous souhaitez étudier les journaux sur un autre système
ou les envoyer dans un rapport de bogue sur l'installation.

6.3.9.2. Utilisation de l'interpréteur et consultation des journaux

Il y a plusieurs façons d'obtenir un interpréteur de commandes pendant
l'installation. Sur la plupart des systèmes (et si vous n'utilisez pas une
console série) la méthode la plus simple est de passer sur la deuxième console
virtuelle en appuyant sur les touches Left Alt+F2 ^[15] (sur un clavier Mac, 
Option+F2). Utilisez Left Alt+F1 pour revenir à l'installateur.

Pour l'installateur graphique, voyez la Section 6.1.1, « Utilisation de
l'installateur graphique ».

Si vous ne pouvez pas passer d'une console à l'autre, il y a aussi une entrée
dans le menu principal, Exécuter un shell, qui peut lancer un interpréteur de
commandes. Dans la plupart des dialogues, vous pouvez revenir au menu principal
en utilisant le bouton Go Back, une ou plusieurs fois. Pour fermer
l'interpréteur et revenir à l'installateur, utilisez la commande exit.

Vous avez maintenant amorcé votre système depuis un disque virtuel en mémoire,
et vous avez seulement accès à un ensemble limité d'utilitaires Unix. Vous
pouvez voir les programmes disponibles avec la commande ls /bin /sbin /usr/bin
/usr/sbin et en utilisant la commande help. L'interpréteur de commandes
disponible est ash. Il possède quelques fonctionnalités intéressantes comme la
complétion automatique et le rappel des commandes.

Pour lire ou modifier des fichiers, utilisez l'éditeur nano. Les journaux de
l'installation se trouvent dans le répertoire /var/log.

Note

Bien qu'il soit possible de faire tout ce que les commandes disponibles
permettent, il ne faut utiliser l'interpréteur de commandes qu'en cas de
problème.

Exécuter un programme dans un interpréteur de commandes interfère avec le
processus d'installation et provoque des erreurs ou une installation
incomplète. En particulier, la partition d'échange doit toujours être activée
par l'installateur.

6.3.10. Installation par le réseau avec network-console

L'un des composants les plus intéressants est network-console. Il permet de
faire une installation grâce au réseau avec SSH. L'utilisation du réseau
implique d'effectuer les premières étapes de l'installation à partir de la
console, jusqu'à la configuration du réseau. Mais vous pouvez automatiser le
processus, voyez la Section 4.6, « Installation automatisée ».

Ce composant n'est pas chargé automatiquement et il vous faut le demander
explicitement. Si vous faites une installation à partir d'un disque optique,
vous devez amorcer avec la priorité medium ou appeler le menu principal de
l'installateur et choisir Chargement des composants de l'installateur à partir
d'un support d'installation  puis, choisir sur la liste des composants
supplémentaires network-console : Continuer l'installation depuis une machine
distante avec SSH. Si le chargement a réussi, une nouvelle entrée appelée 
Continuer l'installation depuis une machine distante avec SSH apparaît.

Quand vous avez sélectionné cette nouvelle entrée, on vous demande le mot de
passe qui servira à se connecter au système d'installation, ainsi que sa
confirmation. Et c'est tout. Vous devez voir maintenant un écran qui indique
comment accéder à la machine distante en tant qu'utilisateur installer avec le
mot de passe que vous venez de donner. Un point important à noter dans cet
écran est l'empreinte numérique du système. Vous devez transférer de façon
sécurisée cette empreinte à la personne qui continuera l'installation à
distance.

Si vous décidiez de continuer l'installation localement, vous pourrez toujours
appuyer sur la touche Entrée, qui vous ramènera au menu principal où vous
pourrez choisir un autre composant.

Passons maintenant à l'autre bout du câble. Vous devez tout d'abord configurer
votre terminal avec le codage UTF-8, car c'est le codage utilisé par le système
d'installation. Si vous n'utilisez pas ce codage, l'installation à distance
sera possible mais vous risquez de rencontrer d'étranges artefacts comme des
bordures de dialogue effacées ou des caractères illisibles. L'établissement de
la connexion avec le système d'installation est très simple :

$ ssh -l installer install_host

Où install_host est soit le nom soit l'adresse IP de la machine où sera
installé le système. Avant de vous connecter réellement, l'empreinte du système
distant sera affichée et vous devrez confirmer qu'elle est correcte.

Note

Le serveur ssh de l'installateur n'est pas configuré pour envoyer des paquets
destinés à maintenir la connexion (« keep-alive packets »). En principe, la
connexion à la machine distante doit rester ouverte indéfiniment. Cependant,
dans certains cas liés à la configuration du réseau local, la connexion peut
être fermée après une période d'inactivité. C'est le cas par exemple s'il
existe un système de traduction d'adresses réseau (« Network Address
Translation, NAT ») entre le client et la machine distante. Selon le moment de
l'installation où la connexion a été perdue, il est ou non possible de
reprendre l'installation après la reconnexion.

Pour éviter une déconnexion, on peut lancer la connexion ssh avec l'option
-o ServerAliveInterval=valeur. On peut aussi ajouter cette option au fichier de
configuration du serveur ssh. Cependant, cette option peut provoquer une
déconnexion, par exemple quand des paquets destinés à maintenir la connexion « 
keep-alive » sont envoyés pendant une courte interruption du réseau. Sans cette
option, ssh aurait maintenu la connexion. N'utilisez cette option qu'en cas de
nécessité.

Note

Si vous installez le système sur plusieurs machines, l'une à la suite de
l'autre, et qu'elles possèdent le même nom ou la même adresse IP, ssh refusera
toute connexion. En effet, il aura enregistré des empreintes différentes, ce
qui est signe d'une attaque par mystification (« spoofing attack »). Si vous
êtes certain que ce n'est pas le cas, vous devez supprimer la ligne adéquate
dans le fichier ~/.ssh/known_hosts ^[16] et recommencer.

Après la connexion, un premier écran apparaît qui offre deux possibilités
appelées Lancer le menu et Lancer un shell. La première vous place dans le menu
principal de l'installateur, où vous pouvez poursuivre l'installation comme
habituellement. La seconde lance un interpréteur de commandes et vous pouvez
examiner ou corriger si nécessaire le système distant. Vous ne pouvez lancer
qu'une seule session ssh pour le menu d'installation, mais vous pouvez lancer
plusieurs interpréteurs.

Avertissement

Une fois l'installation à distance commencée, vous ne devez pas revenir à la
session d'installation en cours sur la console locale. Si vous le faites, vous
risquez de corrompre la base de données où est enregistrée la configuration du
nouveau système. Il en résulterait l'échec de l'installation ou des problèmes
dans le système installé.

6.4. Télécharger des microprogrammes (firmware) manquants

Certains périphériques exigent des microprogrammes pour fonctionner. Voyez la
Section 2.2, « Périphériques demandant des microprogrammes (firmware) ». Dans
la plupart des cas, le périphérique ne fonctionnera pas si le microprogramme
n'est pas disponible. Parfois, les fonctionnalités de base ne sont pas
affectées par l'absence du microprogramme et seules les fonctionnalités
avancées exigent sa présence.

Quand un pilote de périphérique demande un microprogramme qui n'est pas
disponible, l'installateur debian affiche un écran qui propose de télécharger
le microprogramme. Si cette option est choisie, les fichiers du microprogramme
ou les paquets contenant ce microprogramme seront cherchés sur les
périphériques disponibles. Une fois trouvé, le microprogramme sera placé au bon
endroit, (/lib/firmware), et le module du pilote sera rechargé.

Note

Quels périphériques sont examinés et quels systèmes de fichiers sont reconnus,
cela dépend de l'architecture, de la méthode d'installation et aussi du moment
dans le processus d'installation. Pendant les premières étapes de ce processus,
il est probable que le microprogramme sera correctement chargé depuis une clé
USB avec un système de fichiers FAT. Sur les architectures i386 et amd64, les
microprogrammes peuvent être chargés sur des cartes SD ou MMC.

Il est possible d'éviter l'étape du chargement d'un microprogramme si l'on sait
que le périphérique fonctionnera sans microprogramme ou que le périphérique
n'est pas nécessaire pendant l'installation.

L'installateur Debian ne demande que les microprogrammes nécessaires aux
modules du noyau chargés pendant l'installation. L'installateur Debian ne
contient pas tous les pilotes et en particulier, il ne contient pas radeon.
Ainsi, les capacités de certains périphériques à la fin de l'installation
peuvent ne pas différer de ce qu'elles étaient au début de l'installation. Si
vous suspectez que vos périphériques ne sont pas utilisés pleinement, ou si
vous êtes simplement curieux, vous pouvez vérifier sur le nouveau système ce
que donne une recherche de « firmware » sur le résultat de la commande dmesg.

6.4.1. Préparer le support

Les images d'installation officielles ne comportent pas de microprogrammes non
libres. La méthode la plus commune pour télécharger ces microprogrammes est de
les placer sur un support amovible comme une clé USB. Cependant, on peut
trouver des images d'installation non officielles comportant ces
microprogrammes à l'adresse suivante, https://cdimage.debian.org/cdimage/
unofficial/non-free/cd-including-firmware/. Les fichiers du microprogramme ou
le paquet les contenant doivent être dans le répertoire racine ou dans un
répertoire nommé /firmware du système de fichiers utilisé (partition de disque
dur, clé USB). Il est recommandé d'utiliser le système de fichiers FAT car ce
système sera certainement reconnu dans les premières étapes du processus
d'installation.

Des archives (tarballs ou fichiers zip) contenant les paquets pour les
microprogrammes les plus courants sont disponibles sur

  • https://cdimage.debian.org/cdimage/unofficial/non-free/firmware/

Il suffit de télécharger la bonne version des fichiers et de les placer sur le
système de fichiers du support.

Si le microprogramme voulu n'est pas inclus dans le fichier tar, vous pouvez
aussi trouver des paquets spécifiques dans la section non-free de l'archive. La
liste suivante indique la plupart des microprogrammes disponibles sous forme de
paquets. Elle n'est certainement pas complète et elle peut contenir des paquets
qui ne sont pas des microprogrammes.

  • https://packages.debian.org/search?keywords=firmware

Il est aussi possible de copier sur le support des microprogrammes sous forme
de simple fichier. Ces fichiers peuvent être pris, par exemple, sur un système
déjà installé ou donnés par un vendeur de matériel.

6.4.2. Microprogrammes et système installé

Tout microprogramme chargé pendant l'installation est copié automatiquement sur
le système installé. Dans la plupart des cas, le périphérique qui demandait le
microprogramme fonctionnera correctement une fois la machine relancée sur le
nouveau système installé. Cependant, si le système installé utilise une autre
version du noyau que celle utilisée par l'installateur, il existe un risque
léger que le microprogramme ne puisse être chargé, à cause de la différence des
versions.

Si le microprogramme chargé était sous forme de paquet, l'installateur debian
installera aussi ce paquet dans le nouveau système installé et ajoutera
automatiquement la section non-free de l'archive debian dans le fichier
sources.list d'apt. Ainsi, le microprogramme sera automatiquement mis à jour
quand une nouvelle version apparaîtra.

Si l'étape de chargement du microprogramme a été sautée pendant l'installation,
le périphérique ne fonctionnera pas correctement sur le système installé. Il
faudra installer le microprogramme manuellement.

Note

Quand le microprogramme provient de simples fichiers, une fois copié sur le
système installé, il ne sera pas automatiquement mis à jour, sauf s'il existe
un paquet correspondant à ce microprogramme et que ce paquet est installé quand
l'installation est terminée.

6.4.3. Finaliser le système installé

En fonction du mode d'installation, il est possible que la nécessité d'un
microprogramme n'ait pas été détectée, que ce microprogramme n'était pas
disponible ou qu'il ne se soit pas installé comme il faut au moment de
l'installation. Dans certains cas, une installation, même réussie, peut aboutir
à un écran noir ou un affichage défectueux lors du redémarrage. Si cela
arrivait, il est possible d'essayer quelques contournements :

  • Passer l'option nomodeset à la ligne de commande du noyau. Cela peut aider
    à démarrer dans un mode dégradé d'affichage (« fallback graphics »).

  • Utiliser la combinaison Ctrl+Alt+F2 pour basculer sur le terminal virtuel
    VT2. Cela peut permettre de se connecter quand même.

Une fois connecté au système, il est possible d'automatiser la détection des
microprogrammes manquants et d'effectuer les étapes nécessaires pour les
activer. Pour cela, il est conseillé de suivre la procédure suivante :

 1. Installer le paquet isenkram-cli ;

 2. Exécuter la commande isenkram-autoinstall-firmware en tant que
    superutilisateur.

Habituellement, la façon la plus simple de s'assurer que tous les modules du
noyau ont été correctement initialisés est de redémarrer. Cela est
particulièrement important lorsque le démarrage précédent a utilisé l'option
nomodeset comme mesure de contournement.

Note

L'installation de paquets de microprogrammes nécessite généralement
l'activation de la section « non-free » de l'archive des paquets. Dans Debian
GNU/Linux 11.0, la commande isenkram-autoinstall-firmware effectue cela
automatiquement en créant un fichier dédié (/etc/apt/sources.list.d/
isenkram-autoinstall-firmware.list) qui pointe vers un miroir générique.

6.5. Personnalisation

En utilisant l'interpréteur de commandes (consultez pour cela la
Section 6.3.9.2, « Utilisation de l'interpréteur et consultation des journaux »
), l'installation peut être personnalisée précisément pour s'adapter aux cas
particuliers.

6.5.1. Installer un système d'initialisation alternatif

Le système d'initialisation par défaut de Debian est systemd. Cependant,
d'autres systèmes (comme sysvinit ou OpenRC) fonctionnent, et la manière la
plus simple d'en utiliser un est de basculer pendant le processus
d'installation. Consultez la page dédiée sur le wiki Debian pour avoir des
instructions détaillées.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[6] Techniquement parlant : plusieurs locales existent pour cette langue avec
des codes de pays différents.

^[7] Avec une priorité « medium » ou « low », vous pouvez toujours choisir la
locale que vous préférez parmi celles disponibles pour votre langue.

^[8] Les Legacy locales sont des locales qui n'utilisent pas le codage UTF-8,
mais d'anciennes normes de codage comme ISO 8859-1 pour les Européens ou EUC-JP
pour les Japonais.

^[9] L'installateur chiffrera le groupe de volumes avec une clé AES 256 bits et
utilisera la fonction « dm-crypt » du noyau.

^[10] Pour tout dire, on peut construire un périphérique multidisque avec les
partitions d'un seul disque, mais ça n'apporte pas grand chose.

^[11] L'utilisation d'une phrase comme clé signifie que la partition sera créée
avec LUKS.

^[12] Il est cependant probable que certains organismes gouvernementaux ont les
moyens de récupérer des données même après plusieurs écritures d'un support
magnéto-optique.

^[13] Notez que le programme effectivement utilisé pour installer des paquets
est dpkg. Toutefois, ce programme est un outil de bas niveau qu'apt appelle
lorsqu'il en a besoin. Ce dernier est un outil de plus haut niveau, car il sait
aussi bien installer les autres paquets nécessaires au bon fonctionnement du
paquet que vous essayez d'installer, que récupérer les paquets à partir d'un
disque optique, du réseau, etc.

^[14] Il faut savoir que pour présenter cette liste, l'installateur appelle
simplement le programme tasksel. Ce programme peut être utilisé à tout moment
une fois l'installation terminée pour installer ou supprimer des paquets. Vous
pouvez aussi utiliser un outil plus sophistiqué comme aptitude. Une fois que
l'installation est terminée, si vous voulez un paquet particulier, exécutez
simplement aptitude install paquet, où paquet est le nom du paquet voulu.

^[15] C'est-à-dire qu'il faut appuyer simultanément sur la touche Alt, à gauche
de la barre espace, et sur la touche de fonction F2.

^[16] La commande suivante supprime une entrée existante : ssh-keygen -R <
hostname|IP address>.

Chapitre 7. Démarrer votre nouveau système Debian

Table des matières

7.1. Le moment de vérité
7.2. Le montage des volumes chiffrés

    7.2.1. En cas de problèmes

7.3. Se connecter

7.1. Le moment de vérité

Voici ce que les ingénieurs en électronique appellent le test de la fumée :
démarrer un système pour la première fois.

Après une installation standard, le premier écran que vous verrez au démarrage
du système est le menu du programme d'amorçage grub. Le premier choix est votre
nouveau système Debian. Si d'autres systèmes (comme Windows) ont été détectés,
ils seront affichés en dessous.

Si le système ne démarre pas correctement, ne paniquez pas. Si l'installation
s'est déroulée normalement, il est très probable que seul un problème mineur
empêche le système d'amorcer Debian. Dans la plupart des cas, il ne sera pas
nécessaire de refaire une installation pour corriger de tels problèmes. On peut
commencer par utiliser le mode de secours intégré à l'installateur (voyez la
Section 8.6, « Réparer un système cassé »).

Si vous découvrez Debian et Linux, vous aurez besoin de l'aide d'utilisateurs
expérimentés. Les canaux IRC #debian ou #debian-boot sur le réseau OFTC
apportent une aide directe. Vous pouvez aussi contacter la liste de diffusion
debian-user. Vous pouvez aussi envoyer un rapport d'installation, voyez la
Section 5.4.7, « Faire un rapport de bogue ». Assurez-vous de bien décrire
votre problème et d'inclure tous les messages qui sont affichés. Cela peut
aider à diagnostiquer le problème.

Veuillez envoyer un rapport d'installation si des systèmes d'exploitation
installés sur la machine n'ont pas été détectés ou ont été mal détectés.

7.2. Le montage des volumes chiffrés

Si vous avez créé des volumes chiffrés et leurs points de montage pendant
l'installation, vous devrez fournir pendant le démarrage la phrase secrète pour
chaque volume.

Pour les partitions chiffrées avec dm-crypt, l'invite pendant l'amorçage sera :

Starting early crypto disks... part_crypt(starting)
Enter LUKS passphrase:

Le mot part sur la première ligne de l'invite est le nom de la partition, par
exemple, sda2 ou md0. Vous vous demandez probablement pour quel volume vous
saisissez la phrase secrète. Est-ce pour /home, pour /var ? Bien sûr, si vous
n'avez chiffré qu'un seul volume, c'est facile et vous n'avez qu'à saisir la
phrase utilisée. Si vous avez chiffré plusieurs volumes, les notes que vous
avez prises pendant l'installation (étape Section 6.3.4.6, « Configuration des
volumes chiffrés ») vous seront utiles. Si vous n'avez pas noté la
correspondance entre part_crypt et les points de montage, vous pouvez les
trouver dans les fichiers /etc/crypttab et /etc/fstab de votre nouveau système.

L'invite peut être légèrement différente quand un système de fichiers racine
chiffré est monté. Cela dépend du type d'« initramfs » qui a servi à créer l'« 
initrd » utilisé pour amorcer le système. Voici par exemple l'invite pour un
initrd créé avec initramfs-tools :

Begin: Mounting root file system... ...
Begin: Running /scripts/local-top ...
Enter LUKS passphrase:

Quand vous saisissez la phrase, aucun caractère (même pas l'astérisque) n'est
montré. Si vous faites une erreur, vous aurez deux possibilités de correction.
Après la troisième tentative, le processus de démarrage sautera ce volume et
continuera avec les autres volumes. Veuillez consulter la Section 7.2.1, « En
cas de problèmes » pour d'autres informations.

Une fois toutes les phrases saisies, le processus de démarrage se poursuit
normalement.

7.2.1. En cas de problèmes

Quand vous n'avez pas pu monter certains volumes chiffrés à cause d'une
mauvaise phrase secrète, vous devez les monter après le démarrage. Il y a
plusieurs cas.

  • Le premier cas concerne la partition racine. Si elle n'est pas montée
    correctement, le processus de démarrage s'arrête et vous devez réamorcer la
    machine.

  • Le cas est simple pour les volumes chiffrés qui contiennent des données
    comme /home ou /srv. Vous pouvez simplement les monter manuellement après
    le démarrage.

    En revanche, avec dm-crypt, c'est un peu plus compliqué. Vous devez d'abord
    enregistrer les volumes avec l'application device mapper de cette façon :

    # /etc/init.d/cryptdisks start

    Tous les volumes listés dans /etc/crypttab seront examinés et les
    périphériques seront créés dans le répertoire /dev après avoir saisi les
    bonnes phrases secrètes. Les volumes déjà enregistrés sont ignorés et vous
    pouvez répéter cette commande sans souci. Quand l'enregistrement des
    volumes sera terminé, vous pouvez simplement les monter de la façon
    habituelle :

    # mount /mount_point

  • Quand des volumes contenant des systèmes de fichiers non critiques (/usr ou
    /var) n'ont pas été montés, le système doit s'amorcer malgré tout et vous
    pouvez monter ces volumes comme dans le cas précédent. Mais vous aurez
    besoin de (re)lancer les services qui fonctionnent habituellement car il
    est probable qu'ils n'auront pas été lancés. Le plus simple est de
    réamorcer l'ordinateur.

7.3. Se connecter

Quand le système a été amorcé, vous vous retrouvez face à l'invite de connexion
(login). Connectez-vous en utilisant le nom d'utilisateur et le mot de passe
que vous avez choisis pendant le processus d'installation. Vous pouvez
maintenant utiliser votre système.

Si vous êtes un nouvel utilisateur, vous voudrez peut-être parcourir la
documentation qui est déjà installée sur votre système. Il existe plusieurs
systèmes de documentation ; un travail est en cours afin de les intégrer dans
un tout cohérent. Vous trouverez ci-dessous quelques points de départ.

La documentation qui accompagne les programmes que vous avez installés se
trouve dans le répertoire /usr/share/doc/, dans un sous-répertoire qui porte le
nom du programme, et plus précisément le nom du paquet qui contient le
programme. Il arrive qu'une documentation soit mise dans un paquet séparé qui
n'est pas installé par défaut. Par exemple, de la documentation concernant le
gestionnaire de paquets apt se trouve dans les paquets apt-doc et apt-howto.

De plus, il y a quelques répertoires spéciaux dans le répertoire /usr/share/doc
/. Les HOWTO Linux sont installés au format .gz (compressé) dans le répertoire
/usr/share/doc/HOWTO/en-txt/. Une fois dhelp installé, vous pouvez consulter,
avec votre navigateur, le fichier /usr/share/doc/HTML/index.html qui contient
un index de la documentation installée.

Pour consulter facilement ces documents, on peut utiliser un navigateur en mode
texte :

$ cd /usr/share/doc/
$ w3m .

Le point après la commande w3m demande d'afficher le contenu du répertoire
courant.

Avec un environnement graphique, vous pouvez lancer son navigateur depuis le
menu application et mettre /usr/share/doc/ comme adresse.

Vous pouvez aussi saisir info command ou man command pour obtenir des
informations sur la plupart des commandes disponibles depuis l'interpréteur de
commandes. En exécutant help, vous afficherez l'aide sur les commandes de
l'interpréteur de commandes. Et si vous tapez une commande suivie par --help,
un court résumé sur l'usage de cette commande sera affiché. Si le résultat
d'une commande défile au-delà du haut de l'écran, tapez | more après la
commande de façon à provoquer une pause entre chaque écran. Pour voir une liste
de toutes les commandes disponibles qui commencent par une lettre donnée, tapez
cette lettre, puis deux fois la touche de tabulation.

Chapitre 8. Les prochaines étapes

Table des matières

8.1. Arrêter le système
8.2. S'orienter dans Debian

    8.2.1. Le système des paquets
    8.2.2. Autres logiciels disponibles
    8.2.3. Gestion des versions des applications
    8.2.4. Gestion des tâches récurrentes

8.3. Pour aller plus loin
8.4. Configurer le courrier électronique

    8.4.1. Configuration par défaut
    8.4.2. Envoyer des courriels vers l'extérieur
    8.4.3. Configuration de Exim4

8.5. Compiler un nouveau noyau
8.6. Réparer un système cassé

8.1. Arrêter le système

Pour arrêter un système Debian GNU/Linux, vous ne devez pas redémarrer en
appuyant sur le bouton-poussoir « reset » sur le devant de votre ordinateur, ni
simplement arrêter l'ordinateur. Debian GNU/Linux doit être arrêté de la bonne
manière, sinon des fichiers pourraient être perdus et le disque pourrait être
endommagé. Si vous avez un environnement de bureau, il existe une option « 
éteindre l'ordinateur » disponible dans le menu qui permet d'éteindre ou de
redémarrer le système.

Vous pouvez aussi appuyer sur la combinaison de touches Ctrl+Alt+Del. Si cette
combinaison ne fonctionne pas, vous pouvez aussi vous connecter en tant que
superutilisateur et exécuter les commandes nécessaires. Utilisez reboot pour
redémarrer le système, halt pour arrêter le système sans couper l'alimentation
^[17]. Pour éteindre la machine, utilisez poweroff ou shutdown -h now. Le
système d'initialisation systemd fournit des commandes additionnelles qui
effectuent la même chose, par exemple systemctl reboot ou systemctl poweroff.

8.2. S'orienter dans Debian

Debian est une distribution différente des autres distributions. Même si vous
êtes habitué à travailler avec d'autres distributions Linux, il est nécessaire
de connaître certains détails propres à Debian pour garder votre système en bon
état. Le contenu de ce chapitre vous aidera à vous orienter ; ce n'est pas un
didacticiel sur l'utilisation de Debian, mais un rapide coup d'œil sur le
système, pour les gens pressés.

8.2.1. Le système des paquets

Le concept le plus important à assimiler est le système de gestion des paquets.
La plus grande partie de votre système est sous le contrôle du système de
gestion des paquets. Cela inclut :

  • /usr (en excluant /usr/local)

  • /var (vous pourriez créer /var/local en toute sécurité)

  • /bin

  • /sbin

  • /lib

Par exemple, si vous remplacez /usr/bin/perl, cela fonctionnera, mais lors de
la prochaine mise à jour du paquet perl, le fichier que vous avez modifié sera
remplacé. Les experts évitent cela en marquant le paquet comme « à conserver
(hold) » avec l'application aptitude.

L'une des meilleures méthodes d'installation est la méthode apt. Vous pouvez
utiliser la version en ligne de commande apt, ou bien des outils comme aptitude
ou synaptic (qui sont des interfaces graphiques à apt). Notez qu'apt permet de
fusionner plusieurs sources pour les paquets : main, contrib et non-free ;
ainsi vous pouvez installer des paquets soumis à des restrictions
(n'appartenant pas à Debian au sens strict) en même temps que des paquets de
Debian GNU/Linux.

8.2.2. Autres logiciels disponibles

Certains dépôts de paquets, officiels ou non officiels, ne sont pas activés par
défaut dans une installation standard de Debian. Ils contiennent des paquets
que beaucoup considèrent comme des paquets importants et nécessaires à une
distribution. Vous pouvez trouver des informations sur ces dépôts sur la page
du wiki Debian intitulée Les logiciels disponibles pour la distribution stable
de Debian.

8.2.3. Gestion des versions des applications

Les différentes versions des applications sont gérées par update-alternatives.
Si vous utilisez plusieurs versions de vos applications, lisez la page de
manuel de update-alternatives.

8.2.4. Gestion des tâches récurrentes

Les actions dont l'administrateur a la responsabilité devraient se trouver dans
le répertoire /etc, car ce sont des fichiers de configuration. Si un travail
doit être répété chaque jour, semaine ou mois, mettez simplement un script ou
une application exécutant cette action respectivement dans /etc/cron.daily, /
etc/cron.weekly et /etc/cron.monthly. Ils seront appelés depuis /etc/crontab,
et lancés consécutivement par ordre alphabétique.

D'un autre côté, si vous avez une tâche qui doit être lancée par un utilisateur
particulier, ou à une heure ou à une fréquence bien précise, vous pouvez
utiliser /etc/crontab, ou, mieux encore, /etc/cron.d/votre_choix. Ces fichiers
possèdent aussi un champ supplémentaire qui permet de spécifier sous quelle
identité l'action sera exécutée.

Dans tous les cas, vous n'avez qu'à modifier les fichiers, et cron le
remarquera automatiquement. Vous n'avez pas à lancer de commandes spéciales.
Pour plus d'informations, lisez cron(8), crontab(5) et /usr/share/doc/cron/
README.Debian.

8.3. Pour aller plus loin

Le site web Debian contient beaucoup de documentation sur Debian. Vous pouvez
consulter en particulier la FAQ Debian GNU/Linux et la Guide de référence pour
Debian. Le Projet de documentation Debian répertorie d'autres documents sur
Debian. Les membres de la communauté Debian s'entraident ; pour vous abonner à
une ou plusieurs listes de diffusion Debian, voyez la page d'abonnement aux
listes de diffusion. Enfin les archives des listes de diffusion sont une mine
d'informations sur Debian.

Si vous avez besoin d'informations à propos d'un programme particulier, vous
devriez d'abord essayer man programme, ou info programme.

Vous pourrez également trouver beaucoup de documents utiles dans /usr/share/
doc. En particulier, /usr/share/doc/HOWTO et /usr/share/doc/FAQ contiennent
beaucoup d'informations intéressantes. Pour signaler des bogues, regardez les
fichiers /usr/share/doc/debian/bug*. Pour connaître des informations
spécifiques à Debian pour un programme particulier, lisez /usr/share/doc/(nom
du paquet)/README.Debian.

Le Projet de documentation sur Linux est une source d'informations générales
sur GNU/Linux. Vous y trouverez des guides et des liens vers d'autres
informations sur le système GNU/Linux.

Linux est une implémentation d'Unix. Le projet de documentation Linux (LDP)
rassemble un certain nombre de HOWTO et de livres en ligne relatifs à Linux.

Si vous ne connaissez pas Unix, vous devrez sans doute acheter et lire quelques
livres sur le sujet. La liste des FAQ Unix référence beaucoup de documents
Usenet à valeur historique.

8.4. Configurer le courrier électronique

Le courrier électronique tient aujourd'hui une grande place dans la vie des
gens. Comme il est important que le système de courrier, avec ses nombreuses
options, soit bien configuré, nous aborderons dans cette section ses principaux
éléments.

Un système de courrier est composé de trois éléments. Il y a d'abord l'agent
utilisateur, Mail User Agent, (MUA) qui est le programme avec lequel
l'utilisateur lit et écrit son courrier. Ensuite il y a l'agent de transport, 
Mail Transfer Agent, (MTA), programme qui transporte les courriers d'un
ordinateur à l'autre. Enfin il y a l'agent de distribution, Mail Delivery Agent
(MDA), programme qui distribue le courrier dans les boîtes des utilisateurs.

Ces trois fonctions peuvent être effectuées par des programmes distincts, ou
bien seulement par un ou deux programmes. Il est possible aussi que différents
programmes accomplissent ces tâches pour différents types de courrier.

Sur Linux et les systèmes Unix, mutt est un lecteur (MUA) très apprécié. Comme
les programmes traditionnels de Linux, il est en mode texte. Il est souvent
associé à exim ou sendmail comme MTA et à procmail comme MDA.

Avec la popularité croissante des environnements de bureau graphique, des
programmes comme evolution de GNOME, kmail de KDE ou thunderbird de Mozilla
deviennent aussi populaires. Ils combinent les trois fonctions, MUA, MTA et
MDA, mais ils peuvent -- et le sont souvent -- être utilisés avec les
programmes traditionnels de Debian GNU/Linux.

8.4.1. Configuration par défaut

Même si vous comptez utiliser un programme graphique, il est utile d'installer
et de configurer un ensemble traditionnel MTA/MDA. En effet, certains
utilitaires du système ^[18] peuvent envoyer des messages importants sous forme
de courriels à l'administrateur du système.

Pour cela, les paquets exim4 et mutt sont installables avec la commande apt
install exim4 mutt. L'agent de transport du courrier exim4, combinant les
fonctions MTA et MDA, est un programme relativement petit mais très pratique.
Par défaut, il est configuré pour n'envoyer des courriels que sur le système
local. Les courriels adressés à l'administrateur (le compte root) sont envoyés
à l'utilisateur créé pendant l'installation^[19].

Quand des courriels système sont envoyés, ils sont ajoutés dans le fichier /var
/mail/nom_utilisateur. Les courriels peuvent être lus avec mutt.

8.4.2. Envoyer des courriels vers l'extérieur

Comme il a été dit précédemment, le système Debian installé ne gère l'envoi de
courriel qu'en local et ne permet pas d'envoyer des messages vers l'extérieur
ni d'en recevoir de l'extérieur.

Si vous désirez que exim4 gère l'envoi de messages vers l'extérieur, lisez la
section qui suit, elle vous présentera les options de configuration
disponibles. N'oubliez pas de tester si l'envoi et la réception de courrier
sont corrects.

Si vous avez l'intention d'utiliser un programme graphique avec le serveur de
courrier de votre fournisseur d'accès à internet ou de votre entreprise, vous
n'avez pas vraiment besoin de configurer exim4. Indiquez juste à votre
programme de courrier les bons serveurs à utiliser pour envoyer et recevoir les
messages.

Dans ce cas, vous aurez aussi à configurer certains programmes pour envoyer
correctement des courriels. Par exemple, reportbug, un programme qui permet
d'envoyer des rapports de bogues pour les paquets Debian, s'attend à trouver
exim4.

Pour indiquer à reportbug d'utiliser un serveur de courrier externe, lancez la
commande reportbug --configure et répondez « no » à la question de savoir si un
MTA est disponible. On vous demandera le serveur à utiliser pour envoyer les
rapports de bogues.

8.4.3. Configuration de Exim4

Si vous désirez que votre système gère le courrier vers l'extérieur, vous devez
reconfigurer la paquet exim4^[20] :

# dpkg-reconfigure exim4-config

Après avoir saisi cette commande (en tant que superutilisateur), il vous sera
demandé si vous voulez diviser la configuration en petits fichiers. En cas de
doute, choisissez l'option par défaut.

Plusieurs scénarios communs vous sont proposés. Choisissez celui qui vous
paraît le plus conforme à vos besoins.

site internet

    Votre système est connecté à un réseau et le courrier est expédié et reçu
    directement avec SMTP. Dans les écrans suivants, on vous posera quelques
    questions élémentaires comme le nom de votre machine pour le courrier, les
    domaines dont vous acceptez ou pour lesquels vous relayez les courriels.

courrier envoyé par une machine relais (smarthost)

    Dans ce scénario, le courrier sortant est envoyé à une autre machine,
    appelé le smarthost qui expédie le courrier à sa destination. Cette machine
    relais garde les courriels qui vous sont adressés et vous permet de ne pas
    être constamment connecté. Vous devez donc récupérer vos courriels sur
    cette machine avec des programmes comme fetchmail.

    Le plus souvent, le « smarthost » est le serveur de votre fournisseur
    d'accès à internet. C'est l'option adaptée à un système connecté par le
    réseau téléphonique. Le serveur peut être aussi celui d'une entreprise, ou
    bien même un autre système sur votre réseau.

courrier envoyé par une machine relais ; pas de courrier local

    Cette option est presque la même que la précédente sauf que le système ne
    gère pas le courrier local. Les messages du système, par exemple pour
    l'administrateur, sont toujours gérés.

distribution locale seulement

    C'est l'option par défaut.

pas de configuration pour le moment

    Choisissez cette option si vous êtes absolument certain de savoir ce que
    vous faites. Le système de courrier ne sera pas configuré. Tant qu'il ne le
    sera pas, vous ne pourrez ni envoyer ni recevoir des courriels. Les
    messages importants venant des utilitaires du système ne vous parviendront
    pas.

Si aucun de ces scénarios ne s'accorde à vos besoins, ou si vous voulez un
réglage très fin, vous devrez modifier les fichiers de configuration qui se
trouvent dans le répertoire /etc/exim4. D'autres informations sur le programme 
exim4 se trouvent dans /usr/share/doc/exim4. Le fichier README.Debian.gz
contient d'autres informations sur la configuration de exim4. Il signale aussi
d'autres sources d'informations.

Il faut noter qu'envoyer des messages directement sur internet quand on ne
possède pas de nom de domaine officiel peut provoquer le rejet des messages, à
cause des mesures antipourriel prises par les serveurs de courrier. Il est
préférable d'utiliser le serveur de son fournisseur d'accès à internet. Si vous
le voulez malgré tout, vous pouvez utiliser une autre adresse que celle créée
par défaut. Avec exim4, c'est possible en ajoutant une entrée dans /etc/
email-addresses.

8.5. Compiler un nouveau noyau

Pourquoi compiler un nouveau noyau ? Cela est très probablement inutile car le
noyau par défaut fourni dans Debian prend en charge la quasi totalité des
configurations.

Si vous souhaitez tout de même compiler votre propre noyau, cela est possible
et nous vous recommandons alors l'utilisation de la cible « make deb-pkg ».
Pour plus d'informations, veuillez consulter le Manuel du noyau Linux pour
Debian (Debian Linux Kernel Handbook, en anglais).

8.6. Réparer un système cassé

Les choses tournent mal parfois, et le système que vous avez soigneusement
installé ne peut plus être démarré. Vous avez modifié et... cassé la
configuration du programme d'amorçage ; le nouveau noyau que vous avez installé
ne peut pas s'amorcer ou bien des rayons cosmiques ont atteint le disque et
déplacé un bit dans /sbin/init. Mais, quelle qu’en soit la raison, vous avez
besoin d'un système pour pouvoir corriger le problème. Le mode de secours peut
vous aider.

Pour passer en mode de secours, sélectionnez rescue dans le menu de démarrage,
saisissez rescue à l'invite boot: ou amorcez le système avec le paramètre
rescue/enable=true. Les premiers écrans de l'installateur seront affichés, avec
une note dans un coin de l'écran qui indique que vous êtes en mode de secours
et non pas dans un processus d'installation. Ne vous inquiétez pas, votre
système ne va pas être réécrit ! Le mode de secours exploite simplement les
possibilités de détection de matériel qui existent dans l'installateur pour
rendre disponibles les disques, les périphériques réseau, etc., pendant que
vous réparez le système.

À la place du partitionneur, une liste des partitions présentes sur le système
est affichée et on vous demande d'en choisir une. Normalement, vous devez
choisir la partition contenant le système de fichiers racine à réparer. Vous
pouvez choisir aussi bien des partitions sur des périphériques RAID ou LVM que
celles créées directement sur des disques.

S'il le peut, l'installateur affichera l'invite d'un interpréteur de commandes
dans le système de fichiers que vous avez sélectionné ; et vous pourrez
l'utiliser pour effectuer les corrections nécessaires. Par exemple, pour
réinstaller le programme d'amorçage GRUB sur le secteur principal d'amorçage du
premier disque dur, vous pouvez lancer la commande grub-install '(hd0)'.

Si l'installateur ne peut pas lancer un interpréteur de commandes dans le
système de fichiers que vous avez sélectionné, il vous avertira et proposera un
interpréteur dans l'environnement de l'installateur. Dans cet environnement
vous aurez moins d'outils, mais souvent ils seront suffisants pour réparer
votre système. Le système de fichiers racine que vous aurez sélectionné sera
monté sur le répertoire /target.

Dans les deux cas, après que vous aurez quitté l'interpréteur, le système sera
relancé.

Réparer un système cassé peut être difficile et ce manuel ne cherche pas à
recenser tous les problèmes possibles ni à les corriger. Si vous avez des
problèmes, consultez un expert.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[17] Avec le système d'initialisation SysV, halt a le même effet que poweroff,
mais avec systemd, (par défaut depuis Jessie), leurs effets sont différents.

^[18] Par exemple, cron, quota, logcheck, aide, ...

^[19] Le renvoi de courriel pour root vers le compte utilisateur est configuré
dans le fichier /etc/aliases. S'il n'existe pas de compte utilisateur, le
courriel sera bien sûr envoyé au compte root.

^[20] Vous pouvez bien sûr supprimer exim4 et le remplacer par un autre MTA/
MDA.

Annexe A. Guide de l'installation

Table des matières

A.1. Préliminaires
A.2. Démarrer l'installateur

    A.2.1. Disque optique
    A.2.2. Clés USB
    A.2.3. Amorcer depuis le réseau
    A.2.4. Amorcer depuis un disque dur

A.3. Installation
A.4. Envoyez-nous un rapport d'installation
A.5. Et ils eurent...

Ce document décrit l'installation de Debian GNU/Linux bullseye pour PC 64 bits
(« amd64 ») avec le nouvel installateur Debian. Il reproduit le processus
d'installation et donne des informations valables pour la plupart des
installations. Quand des informations supplémentaires sont nécessaires, nous
renvoyons aux explications plus détaillées qui se trouvent dans d'autres
parties de ce document.

A.1. Préliminaires

Si vous rencontrez des erreurs lors de l'installation, veuillez vous référer à
la Section 5.4.7, « Faire un rapport de bogue » pour savoir comment les
signaler. Si ce document ne répond pas à vos questions, posez-les sur la liste
de diffusion debian-boot (debian-boot@lists.debian.org) ou demandez sur IRC (#
debian-boot, réseau OFTC).

A.2. Démarrer l'installateur

L'équipe debian-cd fournit des images d'installation contenant l'installateur
sur la page Debian sur CD et DVD. Pour savoir où trouver des images
d'installation, lisez la Section 4.1, « images d'installation Debian GNU/Linux
officielles ».

Certaines méthodes d'installation demandent des images différentes des images
pour disques optiques. La Section 4.2.1, « Où trouver les fichiers
d'installation ? » explique comment trouver des images sur les miroirs Debian.

Les sections suivantes donnent des précisions sur les images nécessaires pour
chaque type d'installation.

A.2.1. Disque optique

Pour installer bullseye avec l'installateur, vous pouvez utiliser l'image CD
appelée « netinst ». Cette méthode d'installation amorce à partir de l'image et
installe les paquets en les récupérant sur le réseau, d'où le nom, « netinst ».
L'image contient les logiciels nécessaires à l'exécution de l'installateur et
les paquets pour installer un système bullseye minimal. Si vous préférez, vous
pouvez obtenir une image de CD ou DVD complet qui n'a pas besoin du réseau pour
l'installation. Seul la première image de cet ensemble est nécessaire.

Téléchargez l'image que vous préférez et gravez-la sur un disque. Pour amorcer
à partir de ce disque, vous devrez sans doute changer la configuration du BIOS
ou de l'UEFI ; c'est expliqué dans la Section 3.6.1, « Le menu de configuration
du BIOS ou de l'UEFI ».

A.2.2. Clés USB

On peut aussi amorcer à partir d'un support USB amovible. Par exemple, une clé
USB, facilement transportable, peut servir à installer Debian.

Pour préparer la clé USB, la méthode la plus simple est de télécharger une
image de Debian sur CD ou DVD et de la transférer sur la clé. Bien sûr, toutes
les données de la clé seront détruites. Cette méthode fonctionne car les images
de Debian sont des images hybrides (« isohybrid ») qui peuvent s'amorcer aussi
bien depuis un lecteur optique que depuis un périphérique USB.

Il y a des moyens plus souples de mettre en œuvre une clé USB et l'installateur
Debian peut fonctionner avec des clés qui possèdent moins de mémoire. Pour des
précisions, voyez la Section 4.3, « Préparation des fichiers pour un amorçage
avec une clé USB ».

Amorcer depuis un périphérique USB est commun sur les systèmes UEFI, mais les
anciens systèmes avec BIOS fonctionnent différemment. Certains BIOS peuvent
lancer directement des périphériques USB, d'autres non. Il vous faudra
peut-être configurer le BIOS ou l'UEFI pour activer le « USB legacy support »
(ou « Legacy support »), c'est à dire la prise en charge de l'USB traditionnel.
Le menu de sélection du périphérique d'amorçage devrait présenter un « 
removable drive » (disque amovible) ou un « USB-HDD ». Pour des précisions,
voyez la Section 5.1.1, « Amorcer sur une clé USB ».

A.2.3. Amorcer depuis le réseau

Il est aussi possible de lancer l'installateur Debian à partir du réseau. Les
différentes méthodes pour cet amorçage réseau dépendent de l'architecture et de
la configuration. Les fichiers dans netboot/ servent à l'amorçage de
l'installateur.

La méthode la plus facile est l'amorçage de type PXE. Extrayez les fichiers de
netboot/pxeboot.tar.gz dans le répertoire /srv/tftp ou dans le répertoire que
demande le serveur tftp. Et configurez le serveur DHCP pour qu'il passe le nom
pxelinux.0 aux clients. Avec un peu de chance, tout marchera bien. Pour des
instructions précises, voyez la Section 4.5, « Préparer les fichiers pour
amorcer depuis le réseau avec TFTP ».

A.2.4. Amorcer depuis un disque dur

Il est possible de faire une installation sans utiliser de support amovible,
par exemple avec un disque dur possédant déjà un autre système d'exploitation.
Téléchargez hd-media/initrd.gz, hd-media/vmlinuz et une image CD ou DVD dans le
répertoire racine du disque dur. Assurez-vous que le nom de l'image se termine
par .iso. Maintenant, il suffit d'amorcer Linux avec initrd. La Section 5.1.5,
« Amorcer à partir de Linux avec GRUB » explique comment faire.

A.3. Installation

Après le démarrage de l'installateur, l'écran initial est affiché. Appuyez sur
la touche Entrée pour amorcer, ou bien lisez les instructions sur les autres
méthodes d'amorçage et sur les paramètres (voyez la Section 5.3, « Paramètres
d'amorçage »).

On vous demandera ensuite de choisir une langue. Déplacez-vous avec les flèches
et appuyez sur la touche Entrée quand vous avez choisi. On vous demandera un
pays, à choisir parmi les pays où cette langue est parlée. Si votre pays n'est
pas dans la première liste, une liste contenant tous les pays est disponible.

On vous demandera de confirmer la carte clavier. Choisissez la carte par
défaut, sauf si vous en connaissez une meilleure.

Patientez maintenant, tandis que l'installateur détecte le matériel et charge
ses composants.

Ensuite l'installateur recherche le matériel réseau et configure le réseau avec
DHCP. Si vous n'êtes pas sur un réseau ou si vous n'utilisez pas DHCP, vous
aurez la possibilité de configurer vous-même le réseau.

Puis les comptes des utilisateurs sont créés. Par défaut vous devez fournir un
mot de passe pour le compte du superutilisateur (« root ») et vous devez créer
un compte d'utilisateur ordinaire. Si vous ne donnez pas de mot de passe pour
le superutilisateur, ce compte sera désactivé. Cependant, pour que les tâches
administratives soient possibles sur le nouveau système, le paquet sudo sera
installé, et le premier utilisateur créé sera autorisé à utiliser la commande 
sudo.

Ensuite l'horloge et le fuseau horaire sont définis. L'installateur essaiera de
contacter un serveur de temps sur internet pour configurer l'horloge. Le fuseau
horaire dépend du pays choisi. L'installateur ne demandera d'en choisir un que
s'il existe plusieurs fuseaux pour ce pays.

Il est temps maintenant de partitionner les disques. Vous aurez d'abord la
possibilité de partitionner automatiquement soit un disque entier soit l'espace
libre d'un disque, consultez la Section 6.3.4.2, « Le partitionnement assisté »
. C'est la méthode recommandée pour les débutants ou pour les gens pressés. Si
vous ne voulez pas du partitionnement automatique, choisissez Manuel dans le
menu.

Si vous voulez préserver une partition DOS ou Windows, faites attention en
utilisant le partitionnement automatique. Si vous utilisez le partitionnement
automatique, vous pouvez redimensionner une partition FAT ou NTFS avec
l'installateur pour faire de la place à Debian : choisissez simplement la
partition et indiquez la taille voulue.

L'écran suivant montre la table des partitions, avec les systèmes de fichiers
et les points de montage. Choisissez une partition que vous voulez modifier ou
supprimer. Si vous aviez choisi le partitionnement automatique, il vous suffira
de sélectionner Terminer le partitionnement et appliquer les changements dans
le menu pour accepter ce qui a été fait. N'oubliez pas qu'il vous faut au moins
une partition d'échange et une partition racine montée sur /. Pour des
informations détaillées sur l'utilisation du partitionneur, consultez la
Section 6.3.4, « Partitionnement et points de montage ». Des informations plus
générales sur le partitionnement se trouvent dans l'Annexe C, Partitionnement
pour Debian.

L'installateur formate les partitions et installe le système de base, ce qui
peut prendre du temps. Puis le noyau est installé.

Le système de base installé est un système fonctionnel mais limité. Pour le
rendre plus efficace, vous pouvez maintenant installer d'autres paquets en
choisissant des tâches. Il faut aussi configurer apt et indiquer d'où les
paquets seront téléchargés. La tâche « Standard system » est sélectionnée par
défaut et doit généralement être installée. Si vous voulez un environnement de
bureau graphique, sélectionnez la tâche « Desktop environment ». Consultez la
Section 6.3.6.2, « Sélection et installation des paquets » pour des
informations supplémentaires sur cette étape.

La dernière étape est l'installation d'un programme d'amorçage. Si
l'installateur a détecté d'autres systèmes d'exploitation sur la machine, il
les ajoutera au menu du programme d'amorçage. GRUB est par défaut installé sur
la partition UEFI ou le secteur d'amorçage du premier disque dur, ce qui est
une bonne idée. Mais vous avez la possibilité de refuser ce choix et de
l'installer ailleurs.

L'installateur annonce maintenant que l'installation est terminée. Retirez le
CD ou le support que vous avez utilisé et appuyez sur la touche Entrée pour
réamorcer la machine. Vous devriez pouvoir maintenant vous connecter au nouveau
système. Cette étape est expliquée dans le Chapitre 7, Démarrer votre nouveau
système Debian.

Si vous avez besoin d'autres informations sur ce processus d'installation,
voyez le Chapitre 6, Comment utiliser l'installateur Debian ?.

A.4. Envoyez-nous un rapport d'installation

Si l'installateur Debian a installé correctement le système, veuillez prendre
le temps de nous envoyer un rapport. Vous pouvez simplement installer le paquet
reportbug (apt install reportbug), le configurer comme nous l'avons expliqué
dans la Section 8.4.2, « Envoyer des courriels vers l'extérieur », et exécuter
la commande reportbug installation-reports.

Si vous n'avez pas pu terminer l'installation, vous avez sans doute trouvé un
bogue dans l'installateur. Il est nécessaire que nous le connaissions pour
améliorer l'installateur. Veuillez prendre le temps de nous le signaler. Vous
pouvez utiliser le modèle précédent. Si l'installateur a complètement échoué,
voyez la Section 5.4.6, « Signaler les problèmes ».

A.5. Et ils eurent...

Nous espérons que votre système Debian vous plaira et qu'il vous sera utile.
Vous pouvez maintenant lire le Chapitre 8, Les prochaines étapes.

Annexe B. Automatisation de l'installation par préconfiguration

Table des matières

B.1. Introduction

    B.1.1. Les méthodes
    B.1.2. Limitations

B.2. Utiliser la préconfiguration

    B.2.1. Charger le fichier de préconfiguration
    B.2.2. Utiliser les paramètres d'amorçage pour préconfigurer des questions
    B.2.3. Le mode auto
    B.2.4. Alias utiles avec la préconfiguration
    B.2.5. Exemples de préconfiguration de l'invite d'amorçage
    B.2.6. Utiliser un serveur DHCP pour indiquer les fichiers de
        préconfiguration

B.3. Créer un fichier de préconfiguration
B.4. Contenu du fichier de préconfiguration (pour bullseye)

    B.4.1. Localisation
    B.4.2. Configuration du réseau
    B.4.3. Console réseau
    B.4.4. Valeurs pour les miroirs
    B.4.5. Configuration des comptes
    B.4.6. Configuration du fuseau horaire
    B.4.7. Partitionnement
    B.4.8. Installation du système de base
    B.4.9. Configuration d'Apt
    B.4.10. Choix des paquets
    B.4.11. Installation du programme d'amorçage
    B.4.12. Pour terminer l'installation
    B.4.13. Les autres questions

B.5. Options complexes

    B.5.1. Exécuter des commandes pendant l'installation
    B.5.2. Changer les valeurs par défaut avec la préconfiguration
    B.5.3. Chaîner les fichiers de préconfiguration

Dans cette annexe du manuel, nous abordons les problèmes que pose la
préconfiguration des réponses aux questions de l'installateur en vue
d'automatiser l'installation.

Les éléments de configuration utilisés dans cette annexe sont aussi disponibles
en tant que fichier dans ../example-preseed.txt.

B.1. Introduction

La préconfiguration est une façon de donner des réponses aux questions posées
par le processus d'installation sans avoir à les saisir pendant le processus
lui-même. Cela rend possible une automatisation complète de ce processus et
cela offre même des fonctionnalités qui ne sont pas disponibles autrement.

La préconfiguration n'est pas obligatoire. Avec un fichier de préconfiguration
vide, l'installateur se comporte comme lors d'une installation normale. Chaque
question correctement préconfigurée modifie l'installation.

B.1.1. Les méthodes

La préconfiguration peut être faite de trois manières différentes : initrd,
file et network. La méthode initrd est compatible avec tous les types
d'installation et offre toutes les possibilités mais elle demande une
préparation soignée. Les méthodes file et network sont compatibles avec
plusieurs types d'installation.

Le tableau suivant montre les relations entre les méthodes d'installation et
les méthodes de préconfiguration.

┌───────────────────────────────────────────────┬─────────┬──────┬────────────┐
│            Méthode d'installation             │ initrd  │ file │  network   │
├───────────────────────────────────────────────┼─────────┼──────┼────────────┤
│CD/DVD/USB                                     │oui      │oui   │oui^[a]     │
├───────────────────────────────────────────────┼─────────┼──────┼────────────┤
│netboot                                        │oui      │non   │oui         │
├───────────────────────────────────────────────┼─────────┼──────┼────────────┤
│disque externe (clé USB incluse)               │oui      │oui   │oui ^[a]    │
├───────────────────────────────────────────────┴─────────┴──────┴────────────┤
│^[a] Seulement si vous avez accès au réseau et si vous définissez preseed/   │
│url.                                                                         │
└─────────────────────────────────────────────────────────────────────────────┘

La différence fondamentale entre les diverses méthodes de préconfiguration est
le moment où le fichier de préconfiguration est chargé et exécuté. Avec la
méthode initrd, ce fichier est chargé au tout début de l'installation, avant
même qu'une seule question ne soit posée. La préconfiguration depuis la ligne
de commande du noyau arrive juste après. Il est donc possible d'écraser la
configuration de l'image initiale en modifiant la ligne de commande du noyau
(soit dans la configuration du chargeur d'amorçage, ou manuellement à
l'amorçage pour les chargeurs qui l'autorisent). Avec la méthode file, il faut
que l'image ait été chargée. Avec la méthode network, le réseau doit avoir été
préalablement configuré.

Important

Il est donc clair que toutes les questions posées avant que le fichier de
préconfiguration n'ait été chargé, ainsi que les questions avec une priorité de
type médium ou basse, ne peuvent pas être préconfigurées (comme la première
détection de matériel). Une méthode (pas si simple) pour éviter ces questions
est de les préconfigurer avec les paramètres d'amorçage, comme décrit dans la
Section B.2.2, « Utiliser les paramètres d'amorçage pour préconfigurer des
questions ».

Pour éviter facilement que des questions ne soient posées avant la mise en
œuvre de la préconfiguration, vous pouvez lancer l'installateur en mode « auto
 ». Ce mode retarde certaines questions, comme les questions sur la langue, le
pays et le clavier, pour ne les poser qu'après l'installation du réseau : elles
peuvent donc être préconfigurées. Ce mode définit la priorité à critical, ce
qui écarte les questions sans importance. Voyez la Section B.2.3, « Le mode
auto » pour des précisions.

B.1.2. Limitations

La plupart des dialogues de l'installateur Debian peuvent être préconfigurés de
cette manière. Il y a cependant des exceptions notables. Vous devez
partitionner tout un disque ou utiliser une partie de l'espace disponible ; il
n’est pas possible d’utiliser des partitions existantes.

B.2. Utiliser la préconfiguration

Vous devez d'abord créer le fichier de préconfiguration et le placer là où vous
le voulez. Cette création est abordée plus loin dans l'annexe. Mettre ce
fichier au bon endroit est simple si vous voulez le lire sur le réseau ou sur
une clé USB. Si vous voulez inclure ce fichier sur une image d'installation,
vous devez alors recréer l'image ISO. Cette annexe n'expliquera pas comment le
mettre dans l'initrd. Veuillez consulter la documentation des développeurs de
l'installateur.

Un exemple de fichier de préconfiguration basé sur les éléments de cette annexe
est disponible, ../example-preseed.txt. Vous pouvez vous servir de ce fichier
pour créer le vôtre. Ce fichier utilise les éléments de configuration inclus
dans cette annexe.

B.2.1. Charger le fichier de préconfiguration

Quand on utilise la méthode initrd, il faut être sûr qu'un fichier appelé
preseed.cfg se trouve dans le répertoire racine de l'initrd. L'installateur
recherche ce fichier et le charge s'il est présent.

Avec les autres méthodes de préconfiguration, vous devez dire à l'installateur
quel fichier charger au moment de l'amorçage de l'installateur. On peut passer
un paramètre au noyau soit au moment de l'amorçage soit en modifiant le fichier
de configuration du programme d'amorçage (par exemple syslinux.cfg) et en
ajoutant le paramètre à la fin des lignes « append ».

Si vous avez indiqué le fichier de préconfiguration dans le fichier de
configuration du programme d'amorçage, il est possible de modifier la
configuration pour ne pas avoir à appuyer sur la touche « Entrée » pour lancer
l'installateur. Avec syslinux, il suffit de mettre le délai d'attente à 1 dans
le fichier syslinux.cfg.

Pour être sûr que l'installateur charge le bon fichier de préconfiguration vous
pouvez indiquer une somme de contrôle pour ce fichier. Cette somme doit être
pour l'instant de type md5sum. Quand elle est spécifiée, elle doit correspondre
au fichier sinon l'installateur refusera de charger le fichier.

Paramètres à indiquer :
- quand l'amorçage se fait sur le réseau :
  preseed/url=http://host/path/to/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d
- ou
  preseed/url=tftp://host/path/to/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d

- quand l'amorçage se fait sur une image modifiée :
  preseed/file=/cdrom/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

- quand l'amorçage se fait sur une clé USB (le fichier
  est dans le répertoire racine de la clé) :
  preseed/file=/hd-media/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

Il est possible de raccourcir preseed/url en url, preseed/file en file et
preseed/file/checksum en preseed-md5 si vous les passez en paramètres
d'amorçage.

B.2.2. Utiliser les paramètres d'amorçage pour préconfigurer des questions

Quand on ne peut pas utiliser un fichier de préconfiguration pour préconfigurer
certaines étapes, on peut quand même automatiser complètement l'installation
car il est possible de préconfigurer des paramètres sur la ligne de commande
lors du démarrage de l’installateur.

Même si l'on ne veut pas se servir de la préconfiguration, on peut utiliser les
paramètres d'amorçage pour fournir une réponse à une question particulière. Des
exemples sont donnés ailleurs dans ce manuel.

Pour toutes les variables listées dans les exemples, il suffit d'indiquer une
paire de type chemin/vers/variable=valeur. Quand une valeur est destinée à la
configuration de paquets du système cible, il est nécessaire d'ajouter le
propriétaire ^[21]de la variable : propriétaire:chemin/vers/variable=valeur. Si
vous n'indiquez pas de propriétaire, la valeur de la variable ne sera pas
copiée dans la base de données debconf du système cible et ne sera pas utilisée
pendant la configuration du paquet en question.

Préconfigurer une question de cette manière signifie que la question ne sera
pas posée. Si l'on veut à la fois donner une valeur par défaut et poser la
question, il faut utiliser l'opérateur « ?= » au lieu de « = ». Voyez la
Section B.5.2, « Changer les valeurs par défaut avec la préconfiguration ».

Certaines des variables qui sont fréquemment définies à l'invite du démarrage
possèdent des alias plus courts. Quand un alias est disponible, les exemples de
cette annexe l'utilisent au lieu de la variable complète. Ainsi la variable
preseed/url possède l'alias url et elle permet de raccourcir les URL à
utiliser. Un autre exemple est l'alias tasks, qui représente tasksel:tasksel/
first.

Dans les paramètres d'amorçage, « --- » possède une signification spéciale.
Tous les paramètres du noyau placés après le dernier ensemble de trois tirets
seront copiés dans la configuration du programme d'amorçage (si l'installateur
le permet). L'installateur filtrera automatiquement les options qu'il
reconnaît, comme par exemple les options de préconfiguration.

Note

Il faut savoir que le noyau Linux (version 2.6.9 et au delà) accepte un maximum
de 32 options en ligne de commandes et 32 variables d'environnement. Les
options ajoutées par défaut par l'installateur sont comprises dans ces
chiffres. S'il y a dépassement, le noyau panique. Les précédents noyaux
acceptaient moins d'options.

On peut sans risque supprimer certaines options par défaut dans le fichier de
configuration de votre chargeur de démarrage, comme vga=normal. Cela permet de
rajouter autant d'options pour la préconfiguration.

Note

Il n'est pas toujours possible d'indiquer des valeurs contenant des espaces
dans les paramètres d'amorçage, même encadrés par des guillemets.

B.2.3. Le mode auto

En combinant certaines fonctionnalités de l'installateur Debian, il est
possible d'écrire des lignes de commandes très simples qui automatiseront
toutes vos installations, aussi complexes soient-elles.

Il faut pour cela utiliser le choix d'amorçage Automated install, ou auto dans
certaines architectures et méthodes d'amorçage. Dans cette section, auto n'est
donc pas un paramètre, mais un type d'amorçage qui ajoute des paramètres à
l'invite d'amorçage. Consultez la Section 5.1.7, « L'écran d'amorçage » pour
des informations sur la manière d'ajouter des paramètres d'amorçage.

Voici quelques exemples à utiliser à l'invite d'amorçage :

auto url=autoserver

On suppose qu'un serveur DHCP permettra que autoserver puisse être résolu par
un serveur DNS, en ajoutant peut-être un domaine local s'il est donné par le
serveur DHCP. Si le site, dont le domaine est example.com, possède un serveur
DHCP correctement configuré, alors le fichier de préconfiguration recherché
sera trouvé à l'URL http://autoserver.example.com/d-i/bullseye/./preseed.cfg.

La dernière partie de l’adresse, (d-i/bullseye/./preseed.cfg), provient de
auto-install/defaultroot qui contient le répertoire bullseye par défaut. Il
sera ainsi possible dans de prochaines versions d'indiquer un nom de code
particulier, ce qui permettra des migrations contrôlées. L'élément /./ indique
une racine relative à laquelle rattacher les chemins (à utiliser avec preseed/
include et preseed/run). On peut ainsi indiquer des fichiers soit avec une URL
complète -- chemin commençant par « / », donc rattaché --, soit avec un chemin
relatif à l'endroit où a été trouvé le dernier fichier de préconfiguration.
Cela permettra d'écrire des scripts portables où une hiérarchie complète de
scripts pourra être déplacée à un nouvel endroit sans être détruite. Par
exemple, on pourra déplacer des fichiers d'un serveur web sur une clé USB. Si
le fichier de préconfiguration définit preseed/run comme /scripts/
late_command.sh, le fichier sera cherché à http://autoserver.example.com/d-i/
bullseye/./scripts/late_command.sh.

S'il n'existe pas de serveur DHCP ou DNS, ou si vous ne voulez pas utiliser le
chemin par défaut du fichier preseed.cfg, vous pouvez toujours utiliser une URL
explicite. Et si vous n'utilisez pas l'élément /./, le fichier sera rattaché au
troisième / de l'URL. Voici un exemple qui demande une gestion minimale du
réseau :

auto url=http://192.168.1.2/path/to/mypreseed.file

Cela fonctionne ainsi :

  • Si l'URL n'a pas de protocole, HTTP est supposé,

  • si le domaine n'a pas de point, le domaine donné par DHCP lui sera ajouté,

  • s'il n'y a pas de / après le domaine, le chemin par défaut est ajouté.

En outre, vous pouvez indiquer des paramètres qui n'affectent pas directement
l'installateur Debian mais qui peuvent être passés à des scripts spécifiés dans
les éléments preseed/run du fichier de préconfiguration chargé. Pour l'instant,
le seul exemple est auto-install/classes, avec l'alias classes. Exemple :

auto url=example.com classes=class_A;class_B

Une classe peut par exemple indiquer le type de système à installer ou la 
locale à utiliser.

Il est bien sûr possible d'étendre ce concept. Dans ce cas, il est raisonnable
d'utiliser l'espace de nom auto-install. On peut avoir par exemple un
auto-install/style qui sera utilisé dans les scripts. Si vous en éprouvez le
besoin, veuillez envoyer un courriel à la liste <debian-boot@lists.debian.org>
pour que nous puissions éviter des conflits d'espace de noms et, qui sait,
ajouter un alias pour votre paramètre.

Le type d'amorçage auto n'est pas encore défini pour toutes les architectures.
Mais il suffit d'ajouter les deux paramètres auto=true priority=critical sur la
ligne de commande du noyau. Le paramètre du noyau auto est un alias pour
auto-install/enable. Quand il vaut true, son effet est de retarder les
questions sur la locale et le clavier pour qu'elles puissent être
préconfigurées. Le paramètre priority est un alias pour debconf/priority. Quand
sa valeur est critical, les questions avec une priorité plus basse sont
évitées.

Voici d'autres options intéressantes pour automatiser une installation avec
DHCP : interface=auto netcfg/dhcp_timeout=60. Elles permettent de choisir la
carte réseau et de patienter pour l'obtention d'une réponse du serveur DHCP.

Astuce

Il existe un exemple d'utilisation très poussée de la préconfiguration, avec
des scripts et des classes, sur le site web de son développeur. Des exemples
sont donnés d'effets très intéressants obtenus par un usage créatif de la
préconfiguration.

B.2.4. Alias utiles avec la préconfiguration

Voici des alias utiles avec la préconfiguration (mode auto). Il faut remarquer
que ce sont simplement des alias courts pour les noms des questions. Vous devez
toujours leur donner des valeurs, comme par exemple, auto=true ou interface=
eth0.

priority    debconf/priority
fb          debian-installer/framebuffer
language    debian-installer/language
country     debian-installer/country
locale      debian-installer/locale
theme       debian-installer/theme
auto        auto-install/enable
classes     auto-install/classes
file        preseed/file
url         preseed/url
domain      netcfg/get_domain
hostname    netcfg/get_hostname
interface   netcfg/choose_interface
protocol    mirror/protocol
suite       mirror/suite
modules     anna/choose_modules
recommends  base-installer/install-recommends
tasks       tasksel:tasksel/first
desktop     tasksel:tasksel/desktop
dmraid      disk-detect/dmraid/enable
keymap      keyboard-configuration/xkb-keymap
preseed-md5 preseed/file/checksum

B.2.5. Exemples de préconfiguration de l'invite d'amorçage

Voici quelques exemples d'invites d'amorçage que vous pouvez adapter à vos
besoins ; consultez aussi la Section 5.1.7, « L'écran d'amorçage »).

# Pour choisir la langue française et la France comme pays :
/install.amd/vmlinuz vga=788 initrd=/install.amd/gtk/initrd.gz language=fr country=FR --- quiet
# Pour choisir la langue anglaise, l'Allemagne comme pays et utiliser un clavier allemand :
/install.amd/vmlinuz vga=788 initrd=/install.amd/gtk/initrd.gz language=en country=DE locale=en_US.UTF-8 keymap=de --- quiet
# Pour installer le bureau MATE :
/install.amd/vmlinuz vga=788 initrd=/install.amd/gtk/initrd.gz desktop=mate-desktop --- quiet
# Pour installer la tâche de serveur web :
/install.amd/vmlinuz initrd=/install.amd/initrd.gz tasksel:tasksel/first=web-server ---

B.2.6. Utiliser un serveur DHCP pour indiquer les fichiers de préconfiguration

Il est aussi possible d'utiliser DHCP pour spécifier un fichier à télécharger
sur le réseau. DHCP permet d'indiquer un nom de fichier. Normalement ce fichier
sert à un amorçage par le réseau (netboot). S'il s'agit d'une URL, le système
d'installation qui permet une préconfiguration de type réseau téléchargera le
fichier et l'utilisera comme fichier de préconfiguration. Voici un exemple
montrant comment configurer le fichier dhcpd.conf appartenant à la version 3 du
serveur DHCP de ISC (paquet debian isc-dhcp-server).

if substring (option vendor-class-identifier, 0, 3) = "d-i" {
    filename "http://host/preseed.cfg";
}

Remarquez que l'exemple précédent n'autorise le fichier qu'aux clients DHCP qui
s'identifient comme « d-i ». Les autres clients DHCP ne sont pas affectés. Vous
pouvez aussi mettre le texte dans un bloc d’instructions à destination d'un
seul hôte pour ne pas préconfigurer toutes les installations faites dans votre
réseau.

Une bonne façon d'utiliser cette technique est de ne préconfigurer que les
valeurs liées à votre réseau, par exemple le nom de votre miroir Debian. De
cette manière les installations utilisent automatiquement le bon miroir et la
suite de l'installation peut se faire interactivement. Il faut être très
prudent si l'on veut automatiser toute l'installation avec une préconfiguration
de type DHCP.

B.3. Créer un fichier de préconfiguration

Le format de ce fichier est celui de la commande debconf-set-selections. Chaque
ligne est de cette forme :

<propriétaire> <nom de la question> <type de la question> <valeur>

Le fichier doit commencer par #_preseed_V1.

Voici quelques règles pour écrire un fichier de préconfiguration :

  • Une seule espace (ou tabulation) autorisée entre le type et la valeur.
    Toute autre espace sera considérée comme appartenant à la valeur ;

  • Une ligne peut être divisée en ajoutant une barre oblique inverse (« \ »)
    pour signifier la continuation de la ligne. Il vaut mieux couper la ligne
    après le nom de la question. Ce n'est pas très heureux de la couper entre
    le type et la valeur. Les lignes coupées seront réunies en une seule ligne
    et toutes les espaces superflues condensées en une seule ;

  • Le propriétaire des variables debconf utilisées seulement dans
    l'installateur doit être « d-i ». Pour les variables utilisées dans le
    système installé, le propriétaire doit correspondre au nom du paquet qui
    contient ces variables. Seules les variables dont le propriétaire n'est pas
    « d-i » sont conservées dans la base de données debconf du système
    installé ;

  • La plupart des valeurs doivent être en anglais et non pas en français. Mais
    il existe des valeurs, dans partman par exemple, qui doivent être données
    en français ;

  • Certaines valeurs reçoivent du code comme valeur au lieu du texte anglais
    qui est affiché pendant l'installation.

  • Commencer le fichier par #_preseed_V1.

  • Un commentaire est une ligne qui commence par un dièse (« # ») et qui
    continue jusqu'à la fin de la ligne.

Pour créer le fichier de préconfiguration, la méthode la plus facile est de
travailler à partir du fichier d'exemple dans la Section B.4, « Contenu du
fichier de préconfiguration (pour bullseye) ».

Une autre méthode est de faire une installation puis, après le redémarrage,
d'utiliser la commande debconf-get-selections du paquet debconf-utils pour
copier la base de données debconf et la base de données cdebconf de
l'installateur dans un fichier unique :

$ echo "#_preseed_V1" > fichier
$ debconf-get-selections --installer >> fichier
$ debconf-get-selections >> fichier

Cependant ce fichier contiendra des éléments qui ne peuvent pas être
préconfigurés et il vaut mieux utiliser le fichier d'exemple.

Note

Cette méthode est fondée sur le fait qu'à la fin de l'installation, la base de
données cdebconf de l'installateur est sauvegardée dans le fichier /var/log/
installer/cdebconf. Mais cette base peut contenir des données sensibles et par
défaut elle n'est lisible que par le superutilisateur.

Le répertoire /var/log/installer et tous ses fichiers seront détruits si vous 
« purgez » le paquet installation-report.

Pour examiner les valeurs données aux variables, on peut utiliser nano et
consulter les fichiers dans /var/lib/cdebconf pendant l'installation. Regardez
templates.dat pour les exemples et questions.dat pour les valeurs actuelles et
les valeurs affectées aux variables.

Pour vérifier que votre fichier de préconfiguration est correct avant de faire
une installation, vous pouvez utiliser la commande debconf-set-selections -c 
preseed.cfg.

B.4. Contenu du fichier de préconfiguration (pour bullseye)

Les éléments de configuration utilisés dans cette annexe sont aussi disponibles
en tant que fichier dans ../example-preseed.txt.

Les exemples donnés ici sont valables pour l'architecture Intel x86. Si vous
utilisez une autre architecture, certains exemples, comme la préconfiguration
du clavier ou du programme d'amorçage, ne seront pas corrects et vous devrez
les modifier avec les valeurs adéquates.

Les différents composants de l'installateur Debian sont décrits dans la
Section 6.3, « Utilisation des composants ».

B.4.1. Localisation

Lors d'une installation normale, les questions à propos de la localisation sont
posées en premier. Ces valeurs ne peuvent être donc préconfigurées uniquement
par l'initrd ou les paramètres du noyau. Le mode auto (Section B.2.3, « Le mode
auto ») inclut un paramètre auto-install/enable=true (normalement via l'alias
auto). Cela reporte les questions à propos de la localisation et elles peuvent
ainsi être préconfigurées avec n'importe quelle méthode.

Une locale peut être choisie pour indiquer à la fois la langue et le pays.
Toute combinaison d'une langue reconnue par l'installateur et d'un pays valable
est acceptée. Si la combinaison ne forme pas une locale valable, l'installateur
choisira automatiquement une locale correspondant à la langue sélectionnée.
Pour indiquer une locale sous forme de paramètre d'amorçage, écrivez : locale=
fr_FR.

Cette méthode, très simple à utiliser, ne permet pas de préconfigurer toutes
les combinaisons possibles de pays, de langue et de locale ^[22]. Ces valeurs
peuvent être préconfigurées individuellement. La langue et le pays peuvent être
spécifiés en tant que paramètres d'amorçage.

# Préconfigurer la locale seule définit la langue, le pays et la locale.
d-i debian-installer/locale string en_US

# Les valeurs peuvent être préconfigurées individuellement.
#d-i debian-installer/language string en
#d-i debian-installer/country string NL
#d-i debian-installer/locale string en_GB.UTF-8
# On peut aussi demander la création d'autres locales.
#d-i localechooser/supported-locales multiselect en_US.UTF-8, fr_FR.UTF-8

La configuration du clavier consiste à sélectionner une carte clavier et à
choisir, pour les claviers non latins, une touche qui permet de basculer d'une
carte non latine à une carte US. Seules quelques cartes de base sont
disponibles pendant l'installation. Une fois le système installé, vous pourrez
choisir des cartes plus évoluées avec la commande dpkg-reconfigure
keyboard-configuration.

# Choix du clavier :
d-i keyboard-configuration/xkb-keymap select fr(latin9)
# d-i keyboard-configuration/toggle select No toggling

Pour éviter la configuration du clavier, préconfigurez keymap avec skip-config.
La carte clavier du noyau restera active.

B.4.2. Configuration du réseau

Bien sûr, si vous récupérez le fichier de préconfiguration sur le réseau, cela
ne marchera pas ! Mais c'est parfait si vous amorcez à partir d'un disque
optique ou d'une clé USB. Vous pouvez aussi ajouter des paramètres réseau aux
paramètres du noyau si vous récupérez le fichier de préconfiguration sur le
réseau.

Si, quand vous amorcez par le réseau, vous avez besoin d'une interface
particulière avant de charger le fichier de préconfiguration, utilisez un
paramètre comme celui-ci : interface=eth1.

Quand vous utilisez la préconfiguration de type « network » (avec « preseed/url
 »), il n'est pas possible normalement de préconfigurer le réseau. Cependant on
peut utiliser l'astuce suivante. Pour définir par exemple l'adresse statique de
l'interface réseau, il suffit de forcer la configuration du réseau à s'exécuter
une nouvelle fois après que le fichier de préconfiguration a été chargé. Le
script « preseed/run » suivant fera l'affaire :

kill-all-dhcp; netcfg

Les variables debconf suivantes traitent de la configuration du réseau.

# Interdire toute configuration réseau. C'est utile pour des
# installations à partir de CD sur des machines sans réseau.
# Les questions et les avertissements à propos du réseau ainsi
# que les temps d'attente sont fastidieux.
#d-i netcfg/enable boolean false

# Netcfg choisira une interface connectée si possible. Cela empêchera
# d'afficher une liste s'il y a plusieurs interfaces.
d-i netcfg/choose_interface select auto

# Pour utiliser une interface particulière :
#d-i netcfg/choose_interface select eth1

# Pour augmenter le délai de détection de lien (par défaut, 3 secondes).
# Valeur en seconde :
#d-i netcfg/link_wait_timeout string 10

# Quand le serveur dhcp est lent et que l'installateur s'arrête pour
# l'attendre, ceci peut être utile :
#d-i netcfg/dhcp_timeout string 60
#d-i netcfg/dhcpv6_timeout string 60

# Par défaut, la configuration du réseau est automatique.
# Si vous préférez configurer vous-même le réseau, décommentez cette ligne
# et les lignes suivantes sur la configuration du réseau.
#d-i netcfg/disable_autoconfig boolean true

# Si vous voulez que le fichier de préconfiguration fonctionne aussi bien
# avec que sans serveur dhcp, décommentez ces lignes et les lignes sur la
# configuration du réseau.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Configuration du réseau.
#
# exemple pour IPv4
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/confirm_static boolean true
#
# exemple pour IPv6
#d-i netcfg/get_ipaddress string fc00::2
#d-i netcfg/get_netmask string ffff:ffff:ffff:ffff::
#d-i netcfg/get_gateway string fc00::1
#d-i netcfg/get_nameservers string fc00::1
#d-i netcfg/confirm_static boolean true


# Remarquez que les valeurs données par DHCP, nom de domaine ou nom de
# machine, prennent le pas sur les valeurs déclarées ici. Cependant,
# cette déclaration empêche que les questions ne soient posées, même si les
# valeurs viennent de dhcp.
d-i netcfg/get_hostname string unassigned-hostname
d-i netcfg/get_domain string unassigned-domain

# Si vous voulez imposer un nom d'hôte, quelque soit le nom retourné par le
# serveur DHCP ou l'entrée DNS inverse donnée pour l'adresse IP, vous pouvez
# décommenter et modifier la ligne qui suit..
#d-i netcfg/hostname string somehost


# Supprimer le dialogue irritant sur la clé WEP.
d-i netcfg/wireless_wep string
# Et l'étonnant nom de machine DHCP que certains FAI utilisent comme mot de
# passe.
#d-i netcfg/dhcp_hostname string radish

# Si pour le réseau ou pour un autre matériel vous avez besoin d'un
# microprogramme (« firmware ») non libre, vous pouvez forcer
# l'installateur à le télécharger, en évitant la demande de confirmation.
# Vous pouvez aussi désactiver la question en mettant ce paramètre à
# « false ».
#d-i hw-detect/load_firmware boolean true

La commande netcfg détermine automatiquement le masque réseau quand la variable
netcfg/get_netmask n'est pas préconfigurée. Quand c'est le cas, cette variable
doit être positionnée à seen pour les installations automatiques. De même, la
commande netcfg choisit une adresse convenable si la variable netcfg/
get_gateway n'est pas définie. Ainsi, pour ne pas utiliser de passerelle, vous
pouvez positionner cette variable à « none ».

B.4.3. Console réseau

# Pour utiliser le composant « network-console » et faire une
# installation par SSH, vous pouvez vous servir des commandes suivantes.
# Elles n'ont de sens que si vous avez l'intention de poursuivre
# l'installation « manuellement ».
#d-i anna/choose_modules string network-console
#d-i network-console/authorized_keys_url string http://10.0.0.1/openssh-key
#d-i network-console/password password r00tme
#d-i network-console/password-again password r00tme

Plus d'informations à propos de la console réseau sont disponible dans la
Section 6.3.10, « Installation par le réseau avec network-console ».

B.4.4. Valeurs pour les miroirs

Selon la méthode d'installation choisie, vous pouvez utiliser un miroir pour
installer le système de base, pour télécharger des composants supplémentaires
de l'installateur et pour configurer le fichier /etc/apt/sources.list.

Le paramètre mirror/suite détermine la distribution du système à installer.

Le paramètre mirror/udeb/suite détermine la distribution des composants
supplémentaires de l'installateur. On s'en sert uniquement quand ces composants
sont récupérés sur le réseau et qu'ils doivent correspondre à la distribution
utilisée pour construire l'initrd nécessaire à la méthode d'installation. En
général, il n'est pas nécessaire de donner une valeur à ce paramètre car
l'installateur la détermine automatiquement.

# Protocole pour les miroirs :
# Si vous utilisez ftp, il n'est pas nécessaire d'indiquer la chaîne
# mirror/country.
# Le protocole par défaut est http.
#d-i mirror/protocol string ftp
d-i mirror/country string manual
d-i mirror/http/hostname string http.us.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Distribution à installer.
#d-i mirror/suite string testing
# Distribution à utiliser pour charger les composants de l'installateur
# (facultatif).
#d-i mirror/udeb/suite string testing

B.4.5. Configuration des comptes

Le mot de passe de « root » et le nom et le mot de passe d'un premier
utilisateur peuvent être préconfigurés. Pour les mots de passe, vous pouvez
utiliser simplement du texte ou bien utiliser le hachage crypt(3).

Avertissement

Il faut être conscient que la préconfiguration des mots de passe n'est pas
entièrement sécurisée. On peut en effet lire le fichier de préconfiguration
quand on y a accès et donc connaître les mots de passe. Le hachage des mots de
passe peut être plus sûr si le hachage n'est pas faible, comme le sont les
algorithmes MD5 et DES qui permettent les attaques par force brute. Les
algorithmes recommandés pour le hachage des mots de passe sont SHA-256 et
SHA-512.

# Ne pas créer de compte root (l'utilisateur ordinaire utilisera sudo).
#d-i passwd/root-login boolean false
# On peut aussi ne pas créer de compte d'utilisateur.
#d-i passwd/make-user boolean false

#Le mot de passe de root en clair...
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# ... ou chiffré avec un hachage crypt(3)
#d-i passwd/root-password-crypted password [crypt(3) hash]


# Vous pouvez aussi présélectionner le nom de l'utilisateur et son
# identifiant de connexion
#d-i passwd/user-fullname string Utilisateur Debian
#d-i passwd/username string debian
# Mot de passe de l'utilisateur en clair...
#d-i passwd/user-password password insecure
#d-i passwd/user-password-again password insecure
# ... ou chiffré avec un hachage crypt(3)
#d-i passwd/user-password-crypted password [crypt(3) hash]
# Préciser l'UID du premier utilisateur.
#d-i passwd/user-uid string 1010

# Le compte sera ajouté à certains groupes. Pour contrôler ces groupes,
# utilisez cette ligne par exemple :
#d-i passwd/user-default-groups string audio cdrom video

Les variables passwd/root-password-crypted et passwd/user-password-crypted
peuvent être aussi préconfigurées avec la valeur « ! ». Dans ce cas,
l'identifiant correspondant est désactivé. Cette méthode convient pour le
compte root. Mais il faut pouvoir autoriser la gestion administrative ou la
connexion du superutilisateur d'une autre manière, par exemple authentification
avec clé SSH, ou sudo.

Un hachage SHA-512 avec crypt(3) pour le mot de passe peut être obtenu de la
manière suivante (commande disponible dans le paquet whois :

mkpasswd -m sha-512

B.4.6. Configuration du fuseau horaire

# Cette commande permet de régler l'horloge matérielle sur UTC :
d-i clock-setup/utc boolean true

# Vous pouvez mettre toute valeur acceptée pour $TZ.
# Voyez ce que contient /usr/share/zoneinfo/ pour les valeurs possibles.
d-i time/zone string Europe/Paris

# La ligne suivante autorise l'utilisation de NTP pour régler l'horloge
# pendant l'installation :
d-i clock-setup/ntp boolean true
# Le serveur NTP à utiliser. Le serveur par défaut est presque
# toujours correct.
#d-i clock-setup/ntp-server string ntp.example.com

B.4.7. Partitionnement

Préconfigurer le partitionnement du disque dur est limité aux possibilités
offertes par partman-auto. Vous pouvez partitionner un disque entier ou
seulement un espace libre sur ce disque. La disposition du disque peut être
indiquée par un schéma prédéfini, un schéma inclus dans un fichier de schémas
ou un schéma mis dans le fichier de préconfiguration.

La préconfiguration de schémas complexes de partitionnement, utilisant RAID,
LVM ou le chiffrement, est possible mais sans la flexibilité offerte lors d'une
installation standard.

Les exemples donnés par la suite n'offrent qu'une information élémentaire sur
l'utilisation des schémas. Pour des précisions, consultez les fichiers
partman-auto-recipe.txt et partman-auto-raid-recipe.txt qui font partie du
paquet debian-installer. Ces deux fichiers sont aussi disponibles dans le
répertoire source de l'installateur Debian. Il faut noter que les
fonctionnalités disponibles peuvent changer d'une version à l'autre de
l'installateur.

Avertissement

L'identification des disques dépend de l'ordre de chargement des pilotes des
disques. Si le système possède plusieurs disques, assurez-vous que le bon sera
choisi avant de préconfigurer son partitionnement.

B.4.7.1. Exemples de partitionnement

# Si le système possède un espace libre, vous pouvez ne partitionner que
# cet espace.
# Mais il faut que partman-auto/method (ci-dessous) ne soit pas définie.
#d-i partman-auto/init_automatically_partition select biggest_free

# Vous pouvez aussi choisir un disque entier. Si le système ne possède
# qu'un seul disque, l'installateur le choisira automatiquement. Si le
# système possède plusieurs disques, le nom du disque doit être
# donné selon le format traditionnel (par exemple, /dev/sda,
# mais pas /dev/discs/disc0/disc).
# Par exemple, pour utiliser le premier disque SCSI/SATA :
#d-i partman-auto/disk string /dev/sda
# Il faudra aussi indiquer la méthode à utiliser.
# Actuellement les méthodes disponibles sont :
# - regular : utilisation des types de partition habituels.
# - lvm :     utilisation de LVM pour le partitionnement du disque.
# - crypto :  utilisation de LVM à l'intérieur d'une partition chiffrée.
d-i partman-auto/method string lvm

# Vous pouvez définir la quantité d'espace qui sera utilisée
# par le groupe LVM.
# Cela peut être une taille associée à son unité (par exemple 20 GB),
# un pourcentage d'espace libre ou le mot "max".
d-i partman-auto-lvm/guided_size string max

# Si l'un des disques à partitionner automatiquement contient une ancienne
# configuration LVM, l'utilisateur recevra normalement un avertissement.
# Cet avertissement peut être évité :
d-i partman-lvm/device_remove_lvm boolean true
# De même pour un Raid logiciel existant déjà :
d-i partman-md/device_remove_md boolean true
# Et aussi pour la confirmation concernant la création de partitions lvm :
d-i partman-lvm/confirm boolean true
d-i partman-lvm/confirm_nooverwrite boolean true

# Vous pouvez choisir l'un des trois schémas prédéfinis...
# - atomic : tous les fichiers dans une seule partition
# - home :   partition /home distincte
# - multi :  partitions /home, /var et /tmp séparées
d-i partman-auto/choose_recipe select atomic

# ...ou donner vous-même votre schéma.
# Si vous avez la possibilité d'obtenir un schéma dans l'environnement de
# l'installateur, vous pouvez simplement pointer sur lui.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# Sinon, vous pouvez mettre un schéma dans le fichier de préconfiguration
# (une seule ligne logique). L'exemple suivant crée une petite partition
# /boot, une partition swap convenable, et utilise le reste de l'espace libre
# pour la partition racine :
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# Une documentation complète sur le format des schémas se trouve dans le
# fichier partman-auto-recipe.txt, disponible dans le
# paquet « debian-installer » ou dans les sources de l'installateur.
# On trouve aussi dans ce document la manière d'indiquer les étiquettes
# de systèmes de fichiers, les noms de groupes de volumes ainsi que les
# noms de périphériques physiques à inclure dans les groupes de volumes.

## Partitionnement pour EFI
# Si votre système nécessite une partition EFI, vous pouvez ajouter ceci au
# schéma précédent, en tant que premier élément :
#               538 538 1075 free                              \
#                      $iflabel{ gpt }                         \
#                      $reusemethod{ }                         \
#                      method{ efi }                           \
#                      format{ }                               \
#               .                                              \
#
# Le fragment ci-dessus correspond à l'architecture amd64,
# certains détails peuvent varier en fonction des architectures.
# Le paquet « partman-auto » dans le dépôt de sources de D-I
# peut contenir des exemples à adapter.

# Si vous avez indiqué la méthode à utiliser, partman créera automatiquement
# les partitions sans demander de confirmation.
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

# Forcer l'amorçage avec UEFI (la compatibilité avec le BIOS sera perdue),
# cela n'est pas fait par défaut.
#d-i partman-efi/non_efi_system boolean true
# S'assurer que la table de partitionnement est en GPT,
# cela est nécessaire pour l'EFI.
#d-i partman-partitioning/choose_label select gpt
#d-i partman-partitioning/default_label string gpt

# Quand le chiffrage de disque est activé,
# ne pas effacer les partitions avant.
#d-i partman-auto-crypto/erase_disks boolean false

B.4.7.2. Partitionnement et RAID logiciel

Il est aussi possible de préconfigurer le partitionnement d'un RAID logiciel.
Les niveaux 0, 1, 5, 6 et 10 sont acceptés, de même que la gestion d'ensemble
en mode dégradé et l’indication de périphériques de rechange.

Si vous utilisez RAID 1, vous pouvez préconfigurer grub pour qu'il s'installe
sur tous les périphériques de l'ensemble, voyez la Section B.4.11,
« Installation du programme d'amorçage ».

Avertissement

Il est facile de se tromper avec ce type de partitionnement automatique. C'est
aussi une nouvelle fonctionnalité qui a été relativement peu testée par les
développeurs de l'installateur. Il revient à chacun de trouver les bonnes
formules. Consultez le fichier /var/log/syslog si vous rencontrez des
problèmes.

# La méthode à indiquer est "raid".
#d-i partman-auto/method string raid
# Indiquez les disques à partitionner. Ils auront tous les mêmes
# caractéristiques, et donc cela ne fonctionnera que s'ils ont tous
# la même taille.
#d-i partman-auto/disk string /dev/sda /dev/sdb

# Ensuite, indiquez les partitions physiques à utiliser.
#d-i partman-auto/expert_recipe string \
#      multiraid ::                                         \
#              1000 5000 4000 raid                          \
#                      $primary{ } method{ raid }           \
#              .                                            \
#              64 512 300% raid                             \
#                      method{ raid }                       \
#              .                                            \
#              500 10000 1000000000 raid                    \
#                      method{ raid }                       \
#              .

# Enfin vous devez indiquer comment seront utilisées les partitions que
# vous venez de définir. N'oubliez pas de donner les bons numéros pour
# les partitions logiques. Les niveaux RAID 0, 1, 5, 6 et 10 sont acceptés.
# Les noms des périphériques sont séparés par un caractère « # ».
# Paramètres :
# <raidtype> <devcount> <sparecount> <fstype> <mountpoint> \
#          <devices> <sparedevices>

#d-i partman-auto-raid/recipe string \
#    1 2 0 ext3 /                    \
#          /dev/sda1#/dev/sdb1       \
#    .                               \
#    1 2 0 swap -                    \
#          /dev/sda5#/dev/sdb5       \
#    .                               \
#    0 2 0 ext3 /home                \
#          /dev/sda6#/dev/sdb6       \
#    .

# Une documentation complète se trouve dans le
# fichier partman-auto-raid-recipe.txt, disponible dans le
# paquet « debian-installer » ou dans les sources de l'installateur.

# Pour que partman partitionne automatiquement sans demander de confirmation :
d-i partman-md/confirm boolean true
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

B.4.7.3. Contrôler le montage des partitions

Les systèmes de fichiers sont normalement montés en utilisant une clé appelée
identifiant unique universel, UUID. Même si le nom du périphérique change, cet
identifiant permet de monter le système de fichiers sur le bon périphérique. La
lecture de ces identifiants est difficile. Aussi l'installateur peut monter des
systèmes de fichiers en utilisant les noms traditionnels des périphériques ou
les étiquettes que vous leur avez attribuées. Quand vous demandez un montage
par étiquette, tout système de fichiers sans étiquette sera monté en utilisant
un UUID.

Pour les périphériques dont les noms sont stables, comme les volumes logiques
LVM, les noms traditionnels seront toujours utilisés à la place des UUID.

Avertissement

Les noms traditionnels des périphériques peuvent changer en fonction de l'ordre
dans lequel ils sont découverts par le noyau au moment du démarrage. Un mauvais
système de fichiers peut être ainsi monté sur un périphérique. De même les
étiquettes peuvent créer des conflits si vous branchez un nouveau disque ou un
périphérique USB. Si cela arrive, le comportement du système devient aléatoire.

# Par défaut, les UUID sont utilisés, mais vous pouvez choisir traditional pour
# utiliser les noms traditionnels des périphériques, ou label pour utiliser des
# étiquettes.
# En l'absence d'étiquette, l'UUID est utilisé.
#d-i partman/mount_style select uuid

B.4.8. Installation du système de base

Peu d'éléments peuvent être préconfigurés à cette étape de l'installation. Les
seules questions posées concernent l'installation du noyau.

# Configurer APT pour empêcher l'installation des paquets recommandés.
# Cette option qui peut conduire à un système incomplet est réservée à des
# utilisateurs expérimentés.
#d-i base-installer/install-recommends boolean false

# Version du noyau à installer (nom du paquet). Utilisez none si vous ne voulez
# pas installer de noyau.
#d-i base-installer/kernel/image string linux-image-686

B.4.9. Configuration d'Apt

La création du fichier /etc/apt/sources.list et les principales options de
configuration se font automatiquement à partir de la méthode d'installation
choisie et des réponses aux précédentes questions. Vous pouvez aussi ajouter
d'autres sources (locales par exemple).

# Choose, if you want to scan additional installation media
# (default: false).
d-i apt-setup/cdrom/set-first boolean false
# You can choose to install non-free and contrib software.
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Uncomment the following line, if you don't want to have the sources.list
# entry for a DVD/BD installation image active in the installed system
# (entries for netinst or CD images will be disabled anyway, regardless of
# this setting).
#d-i apt-setup/disable-cdrom-entries boolean true
# Uncomment this if you don't want to use a network mirror.
#d-i apt-setup/use_mirror boolean false
# Select which update services to use; define the mirrors to be used.
# Values shown below are the normal defaults.
#d-i apt-setup/services-select multiselect security, updates
#d-i apt-setup/security_host string security.debian.org

# Additional repositories, local[0-9] available
#d-i apt-setup/local0/repository string \
#       http://local.server/debian stable main
#d-i apt-setup/local0/comment string local server
# Enable deb-src lines
#d-i apt-setup/local0/source boolean true
# URL to the public key of the local repository; you must provide a key or
# apt will complain about the unauthenticated repository and so the
# sources.list line will be left commented out.
#d-i apt-setup/local0/key string http://local.server/key
# If the provided key file ends in ".asc" the key file needs to be an
# ASCII-armoured PGP key, if it ends in ".gpg" it needs to use the
# "GPG key public keyring" format, the "keybox database" format is
# currently not supported.

# By default the installer requires that repositories be authenticated
# using a known gpg key. This setting can be used to disable that
# authentication. Warning: Insecure, not recommended.
#d-i debian-installer/allow_unauthenticated boolean true

# Uncomment this to add multiarch configuration for i386
#d-i apt-setup/multiarch string i386


B.4.10. Choix des paquets

Vous pouvez installer toute combinaison de tâches parmi celles disponibles.
Pour l'heure, les tâches disponibles sont les suivantes :

  • standard (outils standards)

  • desktop (environnement graphique de bureau)

  • gnome-desktop (bureau Gnome)

  • xfce-desktop (bureau Xfce)

  • kde-desktop (bureau KDE Plasma)

  • cinnamon-desktop (bureau Cinnamon)

  • mate-desktop (bureau MATE)

  • lxde-desktop (bureau LXDE)

  • web-server (serveur web)

  • ssh-server (serveur SSH)

Vous pouvez aussi choisir de n'installer aucune tâche et forcer l'installation
de paquets par un autre moyen. Il est recommandé de toujours inclure la tâche 
standard.

Or if you don't want the tasksel dialog to be shown at all, preseed pkgsel/
run_tasksel (no packages are installed via tasksel in that case).

Si vous voulez installer des paquets particuliers en plus des paquets installés
par les tâches, vous pouvez utiliser le paramètre pkgsel/include. Séparez les
valeurs par des virgules ou des espaces. Vous pouvez ainsi l'utiliser
facilement sur la ligne de commande du noyau.

#tasksel tasksel/first multiselect standard, web-server, kde-desktop

# Or choose to not get the tasksel dialog displayed at all (and don't install
# any packages):
#d-i pkgsel/run_tasksel boolean false

# Individual additional packages to install
#d-i pkgsel/include string openssh-server build-essential
# Whether to upgrade packages after debootstrap.
# Allowed values: none, safe-upgrade, full-upgrade
#d-i pkgsel/upgrade select none

# You can choose, if your system will report back on what software you have
# installed, and what software you use. The default is not to report back,
# but sending reports helps the project determine what software is most
# popular and should be included on the first CD/DVD.
#popularity-contest popularity-contest/participate boolean false

B.4.11. Installation du programme d'amorçage

# Grub est le programme d'amorçage (pour x86).


# Le paramètre suivant est sans danger : il installe grub sur la
# partition UEFI ou le secteur d'amorçage s'il n'existe aucun autre système
# d'exploitation sur la machine.
d-i grub-installer/only_debian boolean true

# Ce paramètre installe grub sur la partition UEFI ou le secteur d'amorçage
# même s'il existe un autre système d'exploitation, ce qui est moins sûr car
# il pourrait ne pas savoir amorcer cet autre système.
d-i grub-installer/with_other_os boolean true

# En raison, entre autres, des clés USB, la position du disque principal ne
# peut pas être déterminée de façon sûre dans le cas général, elle doit donc
# être spécifiée :
#d-i grub-installer/bootdev  string /dev/sda
# Pour installer grub sur le premier périphérique
# (présumant que ce n'est pas une clé USB) :
#d-i grub-installer/bootdev  string default

# Vous pouvez aussi l'installer ailleurs que sur la partition UEFI
# ou le secteur d'amorçage.
# Décommentez et modifiez les lignes suivantes :
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
#d-i grub-installer/bootdev  string (hd0,1)
# Pour installer grub sur plusieurs disques :
#d-i grub-installer/bootdev  string (hd0,1) (hd1,1) (hd2,1)

# Mot de passe facultatif pour grub, soit en clair (simple texte) :
#d-i grub-installer/password password r00tme
#d-i grub-installer/password-again password r00tme
# soit chiffré avec un hachage MD5, voyez grub-md5-crypt(8) :
#d-i grub-installer/password-crypted password [MD5 hash]

# Si le programme d'amorçage permet d'ajouter des paramètres d'amorçage au
# système installé, vous pouvez utiliser l'option suivante.
# Note : les options passées à l'installateur sont ajoutées automatiquement.
#d-i debian-installer/add-kernel-opts string nousb

Un mot de passe chiffré avec un hachage MD5 pour grub peut être créé avec la
commande grub-md5-crypt ou avec la commande donnée dans l'exemple de la
Section B.4.5, « Configuration des comptes ».

B.4.12. Pour terminer l'installation

# Lors d'une installation à partir d'une console série, les consoles virtuelles
# (VT1-VT6) sont désactivées dans /etc/inittab. Décommentez la ligne suivante
# pour empêcher la désactivation.
#d-i finish-install/keep-consoles boolean true

# Pour éviter le dernier message disant que l'installation est terminée :
d-i finish-install/reboot_in_progress note

# Pour empêcher l'éjection du CD au moment du redémarrage,
# c'est utile parfois :
#d-i cdrom-detect/eject boolean false

# Pour arrêter l'installateur quand il a terminé, mais sans redémarrer
# le système installé :
#d-i debian-installer/exit/halt boolean true
# Pour éteindre la machine au lieu de simplement l'arrêter :
#d-i debian-installer/exit/poweroff boolean true

B.4.13. Les autres questions

# Selon les logiciels que vous avez installés et s'il y a eu des problèmes
# pendant le processus d'installation, d'autres questions peuvent être posées.
# Vous pouvez bien sûr les préconfigurer ! Pour obtenir la liste de toutes
# les questions possibles, faites une installation, et exécutez ces
# commandes :
#   debconf-get-selections --installer > fichier
#   debconf-get-selections >> fichier

B.5. Options complexes

B.5.1. Exécuter des commandes pendant l'installation

Une option très puissante offerte par les outils de préconfiguration est la
possibilité de lancer des commandes ou des scripts à certains moments de
l'installation.

Lorsque le système de fichiers du système cible est monté, il est accessible
dans /target. Si un CD d'installation est utilisé, une fois monté, il est
accessible dans /cdrom.

# La préconfiguration de l'installation n'est pas sécurisée. Rien dans
# l'installateur ne vérifie que des dépassements de tampon ou des
# exploitations quelconques des valeurs données dans ce fichier n'ont pas lieu.
# N'utilisez que les fichiers dont vous connaissez la provenance !
# Pour tout dire, et parce que c'est en général utile, voici un
# moyen d'exécuter automatiquement une commande dans l'installateur.

# La première commande est exécutée aussi tôt que possible, juste après
# la lecture du fichier.
#d-i preseed/early_command string anna-install some-udeb
# Cette commande est exécutée juste avant que le partitionneur ne commence.
# Il peut être utile de préconfigurer le partitionneur en fonction de l'état
# des disques
# (qui ne sont peut-être pas visibles quand preseed/early_command est exécutée).
#d-i partman/early_command \
#       string debconf-set partman-auto/disk "$(list-devices disk | head -n1)"
# Cette commande est exécutée juste avant que l'installation ne se termine,
# mais quand le répertoire /target est encore utilisable. Vous pouvez exécuter
# un chroot dans /target et utiliser cet environnement directement ; ou bien vous
# pouvez utiliser les commandes apt-install et in-target pour installer des
# paquets et lancer des commandes dans le répertoire target.
#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh

B.5.2. Changer les valeurs par défaut avec la préconfiguration

Il est possible de changer la réponse par défaut à une question tout en
maintenant l'interrogation. Pour cela, le drapeau seen doit être remis à « 
false » après avoir modifié la valeur de la réponse.

d-i foo/bar string value
d-i foo/bar seen false

Il suffit de déclarer le paramètre preseed/interactive=true au moment de
l'amorçage pour obtenir le même effet pour toutes les questions. Cela peut
servir à tester le fichier de préconfiguration.

Le propriétaire « d-i » est utilisé uniquement pour les variables dont se sert
l'installateur. Pour des variables appartenant à des paquets installés sur le
système cible, il faut utiliser le nom du paquet. Consultez la note
Section B.2.2, « Utiliser les paramètres d'amorçage pour préconfigurer des
questions ».

Si vous utilisez les paramètres d'amorçage pour la préconfiguration,
l'opérateur « ?= » demande à l'installateur de poser la question
correspondante, c'est-à-dire, foo/bar?=valeur (ou propriétaire:foo/bar?=valeur
). Cela n'aura un effet que sur les paramètres qui correspondent à des
questions qui sont réellement affichées pendant l'installation et non pas sur
les paramètres « internes ».

Il est possible d'obtenir davantage d'informations de débogage en utilisant le
paramètre DEBCONF_DEBUG=5. Ainsi, debconf affichera beaucoup plus de détails
sur la configuration actuelle de chaque variable et sur sa progression lors de
l'exécution des scripts d'installation de chaque paquet.

B.5.3. Chaîner les fichiers de préconfiguration

Vous pouvez inclure dans ce fichier d'autres fichiers de préconfiguration.
Toutes les valeurs de ces fichiers annuleront les valeurs préexistantes
définies par des fichiers précédemment chargés. Vous pouvez par exemple mettre
la configuration du réseau dans un fichier et certaines configurations plus
spécifiques dans un autre fichier.

# Vous pouvez indiquer plus d'un fichier, en les séparant par des espaces ;
# tous seront chargés. Ces fichiers peuvent à leur tour contenir d'autres
# directives de préconfiguration ou d'inclusion. Notez que si les fichiers
# sont relatifs, ils seront pris dans le répertoire où se trouve le fichier
# qui les inclut.
#d-i preseed/include string x.cfg

# L'installateur peut vérifier la somme de contrôle des fichiers de
# préconfiguration avant de les utiliser. Pour le moment, cette somme doit
# être de type md5sum. Il faut lister les sommes de contrôle dans le même ordre
# que les fichiers à inclure.
#d-i preseed/include/checksum string 5da499872becccfeda2c4872f9171c3d

# D'une manière plus souple, cela exécute des commandes de l'interpréteur
# et si le résultat donne les noms de ces fichiers, ils sont inclus.
#d-i preseed/include_command \
#      string if [ "`hostname`" = bob ]; then echo bob.cfg; fi

# Plus encore, cela télécharge un programme et l'exécute. Le programme peut
# utiliser des commandes comme debconf-set pour manipuler la base de données
# de debconf. Il est possible de lister plusieurs scripts, séparés par des
# espaces. Il faut remarquer que si les fichiers sont indiqués de façon
# relative, ils seront cherchés dans le répertoire qui contient le fichier de
# préconfiguration qui les a lancés.
#d-i preseed/run string foo.sh

Il est aussi possible de chaîner une préconfiguration de type initrd ou file
avec une préconfiguration de type network. Pour cela, il faut déclarer preseed/
url dans les fichiers précédents. La préconfiguration network sera exécutée
quand le réseau fonctionnera. Soyez prudent car il y aura deux exécutions
distinctes de la préconfiguration. Cela signifie que vous pouvez exécuter à
nouveau la commande preseed/early, la seconde fois après la mise en œuvre du
réseau.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[21] Le propriétaire d'une variable debconf (ou d'une question) est le paquet
qui contient la question correspondante. Les variables utilisées par
l'installateur sont la propriété de « d-i ». Variables et questions peuvent
avoir plusieurs propriétaires, ce qui aide à déterminer si elles peuvent être
supprimées de la base de données lorsqu'un paquet est purgé.

^[22] Si la valeur de locale est préconfigurée avec en_NL, la locale du système
installé sera par défaut en_US.UTF-8. Si la locale voulue est en_GB.UTF-8, il
faudra préconfigurer les valeurs individuellement.

Annexe C. Partitionnement pour Debian

Table des matières

C.1. Décider des partitions et de leurs tailles
C.2. L'arborescence des fichiers
C.3. Schéma de partitionnement recommandé
C.4. Noms des périphériques sous Linux
C.5. Programmes de partitionnement

    C.5.1. Partitionnement pour PC 64 bits

C.1. Décider des partitions et de leurs tailles

Au strict minimum, GNU/Linux a besoin d'une partition pour lui-même. Vous
pouvez avoir une seule partition contenant le système entier, les applications
et vos fichiers personnels. La plupart des gens pensent qu'une partition
d'échange (swap) est nécessaire, bien que ce ne soit pas tout à fait vrai. Le
« Swap » est l'espace de travail du système d'exploitation ; il lui permet
d'utiliser de l'espace disque comme « mémoire virtuelle ». En le plaçant sur
une partition séparée, Linux peut en faire un usage bien plus efficace. Il est
possible de forcer Linux à utiliser un fichier normal comme espace d'échange,
mais ce n'est pas recommandé.

La plupart des gens choisissent d'utiliser plus de partitions que le minimum
requis pour GNU/Linux. Il y a deux raisons pour que vous ayez envie de diviser
le système de fichiers en de nombreuses petites partitions. La première
concerne la sécurité. Si le système de fichiers est corrompu, en général une
seule partition est affectée. Donc, vous n'avez à remplacer (à partir des
sauvegardes que vous avez soigneusement conservées) qu'une partie de votre
système. Au minimum, vous devriez envisager la création de ce qui est
communément appelée la « partition racine ». Elle contient les composants les
plus essentiels du système. Si une autre partition est corrompue, vous pourrez
toujours amorcer Linux pour réparer le système. Cela peut vous épargner le
désagrément d'avoir à réinstaller le système entier.

La seconde raison est généralement plus importante pour une entreprise, mais
cela dépend vraiment de l'utilisation de votre machine. Par exemple, recevoir
des envois en nombre de messages électroniques peut facilement remplir une
partition. Si vous avez placé /var/mail sur sa propre partition, la majeure
partie du système marchera même si vous êtes submergé de courrier non sollicité
(spam).

Le seul inconvénient qu'il y a à utiliser plusieurs partitions est qu'il est
souvent difficile de connaître ses besoins à l'avance. Si vous faites une
partition trop petite, vous aurez soit à réinstaller le système soit à déplacer
constamment des fichiers pour faire de la place sur la partition trop petite.
D'un autre côté, si vous faites une partition trop grande, vous aurez perdu de
l'espace. L'espace disque est bon marché de nos jours, mais pourquoi jeter
votre argent par les fenêtres ?

C.2. L'arborescence des fichiers

Debian GNU/Linux adhère à la norme sur l'organisation des systèmes de fichiers
pour le nommage des fichiers et des répertoires. Cette norme permet aux
utilisateurs et aux auteurs de logiciel de prévoir l'emplacement des fichiers
et des répertoires. Le répertoire racine est simplement représenté par la barre
oblique /. Au niveau de la racine, tous les systèmes Debian incluent ces
répertoires :

┌──────────┬────────────────────────────────────────────────────┐
│Répertoire│                      Contenu                       │
├──────────┼────────────────────────────────────────────────────┤
│bin       │Binaires (exécutables) des commandes essentielles   │
├──────────┼────────────────────────────────────────────────────┤
│boot      │Fichiers statiques pour le programme d'amorçage     │
├──────────┼────────────────────────────────────────────────────┤
│dev       │Fichiers des pilotes de périphériques               │
├──────────┼────────────────────────────────────────────────────┤
│etc       │Configuration système propre à la machine           │
├──────────┼────────────────────────────────────────────────────┤
│home      │Répertoires personnels des utilisateurs             │
├──────────┼────────────────────────────────────────────────────┤
│lib       │Bibliothèques partagées et modules noyaux essentiels│
├──────────┼────────────────────────────────────────────────────┤
│media     │Points de montage pour les supports amovibles       │
├──────────┼────────────────────────────────────────────────────┤
│mnt       │Point de montage pour les montages temporaires      │
├──────────┼────────────────────────────────────────────────────┤
│proc      │Répertoire virtuel pour les informations système    │
├──────────┼────────────────────────────────────────────────────┤
│root      │Répertoire personnel de l'utilisateur root          │
├──────────┼────────────────────────────────────────────────────┤
│run       │Données variables d'exécution                       │
├──────────┼────────────────────────────────────────────────────┤
│sbin      │Exécutables système essentiels                      │
├──────────┼────────────────────────────────────────────────────┤
│sys       │Répertoire virtuel pour les informations système    │
├──────────┼────────────────────────────────────────────────────┤
│tmp       │Fichiers temporaires                                │
├──────────┼────────────────────────────────────────────────────┤
│usr       │Hiérarchie secondaire                               │
├──────────┼────────────────────────────────────────────────────┤
│var       │Données variables                                   │
├──────────┼────────────────────────────────────────────────────┤
│srv       │Données pour les services fournis par le système    │
├──────────┼────────────────────────────────────────────────────┤
│opt       │Répertoire pour d'autres logiciels                  │
└──────────┴────────────────────────────────────────────────────┘

La liste suivante décrit quelques caractéristiques importantes des répertoires
et des partitions. L'utilisation de l'espace disque varie grandement avec la
configuration du système et les modes d'utilisation. Les principes généraux
énoncés ici constituent une introduction au partitionnement des disques.

  • La partition racine / doit toujours contenir les répertoires : /etc, /bin,
    /sbin, /lib et /dev, sinon votre système ne pourra pas démarrer. En
    général, 250 à 350 Mo sont nécessaires ;

  • /usr : tous les programmes des utilisateurs (/usr/bin), les bibliothèques
    (/usr/lib), la documentation (/usr/share/doc), etc. sont dans ce
    répertoire. Cette partie du système de fichiers a besoin du plus d'espace
    possible. Vous devriez disposer d'au moins 500 Mo d'espace disque. Si vous
    voulez installer plus de paquets, vous devriez augmenter l'espace disque
    attribué à ce répertoire. Pour installer un poste de travail ou un serveur 
    « généreux », 4 à 6 Go sont nécessaires ;

  • Il est maintenant recommandé d'avoir /usr dans la partition racine /,
    autrement cela pourrait provoquer des problèmes au démarrage. Cela signifie
    que vous devriez disposer d'au moins 600 à 700 Mo d'espace pour la
    partition racine, y compris /usr, ou 5 à 6 Go pour un poste de travail ou
    un serveur.

  • /var : toutes les données variables comme les articles des forums usenet,
    les messages électroniques, les sites web, le cache du système des
    paquets, etc. seront placées dans ce répertoire. La place nécessaire dépend
    énormément de l'usage que vous faites de votre ordinateur, mais pour la
    plupart des administrateurs, elle sera dictée par la charge due aux outils
    de gestion des paquets. Si vous envisagez de faire une installation
    complète de tout ce que Debian peut vous offrir en une seule fois, réserver
    2 à 3 Go d'espace pour /var devrait suffire. Si vous préférez installer le
    tout en plusieurs étapes (p. ex. d'abord les services et utilitaires, puis
    les outils texte, puis X11...), vous pouvez vous contenter de 300 à 500 Mo.
    Si l'espace disque est une contrainte majeure et que vous ne voulez pas
    faire de mises à jour majeures, vous pouvez vous en tirer avec 30 à 40 Mo ;

  • /tmp : si un programme crée des données temporaires, elles seront
    probablement placées dans /tmp. 40 à 100 Mo devraient suffire. Certaines
    applications, gestionnaires d'archives, outils pour créer des CD/DVD,
    logiciels multimédias, peuvent se servir de /tmp pour stocker
    provisoirement des images. Si vous comptez utiliser ces programmes, vous
    devrez recalculer l'espace nécessaire dans /tmp.

  • /home : chaque utilisateur mettra ses données dans un sous-répertoire de ce
    répertoire. La place nécessaire dépend du nombre d'utilisateurs sur le
    système, et du genre de fichiers qu'ils devront stocker. Selon
    l'utilisation du système, vous devriez réserver environ 100 Mo par
    utilisateur. Réservez beaucoup plus d'espace si des fichiers multimédias
    (images, MP3, films) seront conservés dans le répertoire.

C.3. Schéma de partitionnement recommandé

Pour les nouveaux utilisateurs, les machines Debian personnelles ou familiales,
et autres systèmes mono-utilisateur, une simple partition / (plus celle
d'échange) est sans doute la solution la plus simple. Le type de partition
recommandé est ext4.

Pour les systèmes avec plusieurs utilisateurs, ou les systèmes avec beaucoup
d'espace disque, il vaut mieux placer les répertoires /var, /tmp et /home
chacun sur une partition distincte de la partition /.

Dans certains cas, vous pourriez avoir besoin d'une partition /usr/local
distincte si vous prévoyez d'installer beaucoup de programmes qui ne font pas
partie de la distribution Debian. Si votre machine est destinée à être un
serveur de courrier, vous pourriez avoir besoin de mettre aussi /var/mail sur
une partition distincte. Si vous mettez sur pied un serveur avec beaucoup
d'utilisateurs, il est généralement intéressant d'avoir une grande partition
distincte pour /home. La méthode de partitionnement varie d'un ordinateur à
l'autre, en fonction de son usage.

Pour des systèmes très complexes, consultez le HOWTO Multi Disk. Il contient
des informations très précises qui intéresseront les fournisseurs d'accès à
internet et les personnes installant des serveurs.

En ce qui concerne la taille de la partition d'échange (swap), les avis sont
partagés. Une règle traditionnelle, qui fonctionne bien, est d'utiliser autant
d'espace d'échange que de RAM. Dans la plupart des cas, cette taille ne devrait
pas être inférieure à 512 Mo. Bien sûr, il y a des exceptions à cette règle.

Avec une ancienne machine possédant 512 Mo de RAM et un disque IDE de 20 Go sur
/dev/sda, on pourrait créer une partition de 8 Go pour un autre système
d'exploitation sur /dev/sda1, une partition d'échange de 512 Mo sur /dev/sda3
et une partition Linux d'environ 11,4 Go sur /dev/sda2.

Pour avoir une idée de la place nécessaire pour les tâches que vous voudriez
rajouter à la fin de l'installation, consultez la Section D.2, « Espace disque
nécessaire pour les tâches ».

C.4. Noms des périphériques sous Linux

Le nom des disques et des partitions sous Linux peut être différent des autres
systèmes d'exploitation. Vous devez connaître les noms utilisés lors de la
création et du montage de partitions. Voici les principales conventions de
nommage :

  • Le premier disque dur détecté est appelé /dev/sda.

  • Le second disque dur détecté est appelé /dev/sdb, etc.

  • Le premier lecteur CD SCSI est nommé /dev/scd0, ou encore /dev/sr0.

Les partitions sur chaque disque sont représentées en ajoutant un numéro au nom
du disque : sda1 et sda2 représentent la première et la seconde partition du
premier disque SCSI du système.

Voici un exemple concret. Supposons que vous ayez deux disques SCSI, l'un à
l'adresse SCSI 2 et l'autre à l'adresse SCSI 4. Le premier disque (à
l'adresse 2) est nommé sda, et le second sdb. Si le disque sda a trois
partitions, elles s'appelleront sda1, sda2 et sda3. La même convention
s'applique au disque sdb et à ses partitions.

Notez que si vous avez deux adaptateurs SCSI (c.-à-d. des contrôleurs SCSI),
l'ordre de nommage des disques peut-être embrouillé. La meilleure solution est
de regarder les messages au démarrage, en supposant que vous connaissiez les
modèles ou les tailles des disques.

Linux représente les partitions primaires par le nom du disque, suivi des
nombres 1 à 4. Par exemple la première partition sur le premier disque est /dev
/sda1. Les partitions logiques sont numérotées à partir de 5. Donc, la première
partition logique sur ce même disque est /dev/sda5. Rappelez-vous que la
partition étendue, c'est-à-dire la partition primaire contenant les partitions
logiques, n'est pas utilisable en elle-même.

C.5. Programmes de partitionnement

De nombreux utilitaires de partitionnement ont été adaptés par les développeurs
Debian pour fonctionner sur différents types de disques et d'architectures
matérielles. Voici les programmes qui sont disponibles sur votre architecture :

partman

    C'est le partitionneur que recommande Debian. Ce « couteau suisse » sait
    aussi redimensionner des partitions et monter des systèmes de fichiers (« 
    formater » en langage Windows) sur des points de montage.

fdisk

    C'est le premier partitionneur de disque pour Linux... bon pour les
    gourous.

    Faites attention si vous avez des partitions FreeBSD sur votre machine. Les
    noyaux d'installation reconnaissent ces partitions, mais la façon dont 
    fdisk les représente (ou pas) peut faire varier les noms des périphériques.
    Lisez attentivement le Linux+FreeBSD HOWTO.

cfdisk

    C'est un partitionneur simple à utiliser, fonctionnant en mode plein
    écran... pour nous autres.

    Remarquez que cfdisk ne reconnaît pas du tout les partitions FreeBSD et que
    les noms des périphériques peuvent être différents.

L'un de ces programmes sera lancé par défaut quand vous sélectionnerez : 
Partitionner un disque dur. Il est possible d'utiliser un autre partitionneur
sur la console VT2 mais cela n'est pas recommandé.

N'oubliez pas de rendre amorçable votre partition racine.

C.5.1. Partitionnement pour PC 64 bits

Si vous utilisez un nouveau disque dur (ou si vous souhaitez supprimer la
totalité de la table de partitions), une nouvelle table de partitions doit être
créée. Cela peut être fait de manière automatique avec le « Partitionnement
assisté ». Si vous souhaiter partitionner le disque dur manuellement,
sélectionnez l'entrée de premier niveau du disque et appuyez sur Entrée pour
créer une nouvelle table de partitions. Dans le mode expert, vous pourrez
choisir le type de table. Sur les systèmes avec UEFI, « gpt » est le type de
table par défaut, tandis que « msdos » est le type de table par défaut pour les
systèmes BIOS. Dans une installation standard, les valeurs par défaut sont
utilisées.

Note

Lorsqu'une table de partitions de type « gpt » est sélectionnée, un espace
libre de 1 Mo est créé automatiquement au début du disque. Cela est nécessaire
pour embarquer le programme d'amorçage GRUB2.

Si vous voulez préserver un système d'exploitation existant comme DOS ou
Windows, il vous faudra redimensionner sa partition pour faire de la place pour
installer Debian. L'installateur sait redimensionner les systèmes de fichiers
FAT et NTFS ; quand vous arrivez à l'étape « Partitionnement » de
l'installateur, choisissez Manuel et indiquez simplement la nouvelle taille de
la partition.

Alors que les systèmes récents avec UEFI n'ont pas les limitations listées
ci-dessous, les anciens BIOS des PC ont généralement leurs propres contraintes
pour le partitionnement des disques. Il y a une limite sur le nombre de
partitions « primaires » et « logiques » qu'un disque peut contenir. De plus,
avec les BIOS antérieurs à 1994-98 (selon les constructeurs), il y a des
limites sur l'emplacement des partitions à partir desquelles on peut démarrer
le système. Vous trouverez plus d'information dans le HOWTO sur le
partitionnement Linux, mais cette section contient quelques éléments pour vous
aider à aplanir les difficultés les plus courantes.

À l'origine, le système de partitionnement des disques de PC est basé sur les
partitions « primaires », mais il ne peut y en avoir que quatre. Pour passer
outre cette limitation, les partitions « étendues » et « logiques » ont été
inventées. En configurant une partition primaire en partition étendue, vous
pouvez subdiviser l'espace attribué à cette partition en partitions
« logiques ». La partition étendue peut contenir jusqu'à 60 partitions
logiques ; en revanche, il ne peut y avoir qu'une seule partition étendue par
disque.

Linux limite le nombre de partitions à 255 par disque SCSI (3 partitions
primaires utilisables et 252 partitions logiques dans la partition étendue) et
à 63 par disque IDE (3 partitions primaires et 60 partitions logiques).
Cependant, le système Debian GNU/Linux classique fournit seulement
20 périphériques pour les partitions, c'est pourquoi vous ne pourrez pas
procéder à l'installation sur des partitions supérieures à 20, à moins d'avoir
créé vous-même des périphériques pour ces partitions.

Si vous avez un gros disque IDE, et que vous n'utilisez ni l'adressage LBA ni
les pilotes en couche (quelquefois fournis par les constructeurs de disques),
la partition de démarrage (celle qui contient l'image noyau) doit être placée
dans les 1024 premiers cylindres de votre disque dur (habituellement, autour de
524 Mo, sans la translation du BIOS).

Cette restriction ne s'applique pas si vous avez un BIOS postérieur à 1995-98
(selon les constructeurs) qui prend en charge la norme « Enhanced Disk Drive
Support Specification ». Le paquet Debian mbr (qui est une alternative à Lilo)
a besoin du BIOS pour charger en RAM le noyau lu sur le disque. Si les
extensions du BIOS int 0x13 pour l'accès aux gros disques sont présentes, elles
seront utilisées. Sinon, l'interface standard d'accès au disque sera utilisée
par défaut, et elle ne permettra pas de démarrer sur des emplacements situés
après le 1023e cylindre du disque. Une fois que Linux est démarré, peu importe
le BIOS de votre ordinateur, ces restrictions ne s'appliquent plus, puisque
Linux n'utilise pas le BIOS pour les accès disque.

Si vous avez un gros disque, vous devrez peut-être utiliser des techniques de
translation de cylindres que vous pouvez configurer dans le BIOS, comme le mode
d'adressage LBA (Linear Block Addressing), ou le mode de translation CHS. Vous
trouverez plus d'informations sur la gestion des gros disques dans le HOWTO
Large Disk. Si vous utilisez une méthode de translation de cylindres, et que le
BIOS n'accepte pas les extensions pour l'accès aux gros disques, votre
partition de démarrage devra être contenue dans la partie correspondant aux
1024 premiers cylindres translatés.

La meilleure façon de régler ce problème est de créer une petite partition (25
à 50 Mo doivent suffire) en début de disque, qui sera la partition de
démarrage, puis de créer toutes les autres partitions que vous voulez dans
l'espace restant. Cette partition de démarrage devra être montée sur /boot, le
répertoire où seront stockés les noyaux Linux. Cette configuration marchera sur
tous les systèmes, quel que soit votre mode d'adressage (LBA) ou de translation
(CHS), et quel que soit votre BIOS, avec ou sans extensions.

Annexe D. Informations diverses

Table des matières

D.1. Périphériques Linux

    D.1.1. Régler la souris

D.2. Espace disque nécessaire pour les tâches
D.3. Installer Debian GNU/Linux à partir d'un système Unix/Linux

    D.3.1. Pour commencer
    D.3.2. Installer debootstrap
    D.3.3. Lancer debootstrap
    D.3.4. Configurer le système de base
    D.3.5. Installer un noyau
    D.3.6. Configurer le programme d'amorçage
    D.3.7. Accès distant : installer SSH et configurer l'accès
    D.3.8. Touches finales

D.4. Installer Debian GNU/Linux grâce au protocole PLIP (IP sur port parallèle)

    D.4.1. Prérequis
    D.4.2. Configuration du système source
    D.4.3. Installation du système cible

D.5. Installer Debian GNU/Linux avec PPP sur Ethernet (PPPoE)

D.1. Périphériques Linux

Sous Linux, vous disposez de fichiers spéciaux dans le répertoire /dev. Ces
fichiers sont appelés fichiers de périphérique et ils se comportent
différemment des fichiers ordinaires. Les types les plus courants de ces
fichiers concernent les périphériques de type bloc et les périphériques de type
caractère. Ces fichiers sont des interfaces au pilote réel qui fait partie du
noyau et qui accède au périphérique. Un autre type, moins courant, de fichier
de périphérique est pipe. Ci-dessous sont repris les fichiers de périphérique
les plus importants.

┌────┬─────────────────────────────────────────┐
│sda │Premier disque dur                       │
├────┼─────────────────────────────────────────┤
│sdb │Deuxième disque dur                      │
├────┼─────────────────────────────────────────┤
│sda1│Première partition du premier disque dur │
├────┼─────────────────────────────────────────┤
│sdb7│Septième partition du deuxième disque dur│
└────┴─────────────────────────────────────────┘

┌───┬───────────────────────────┐
│sr0│Premier lecteur de CD-ROM  │
├───┼───────────────────────────┤
│sr1│Deuxième lecteur de CD-ROM │
└───┴───────────────────────────┘

┌───────┬──────────────────────────────────────────────────────┐
│ttyS0  │Port série 0 (COM1 sous MS-DOS)                       │
├───────┼──────────────────────────────────────────────────────┤
│ttyS1  │Port série 1 (COM2 sous MS-DOS)                       │
├───────┼──────────────────────────────────────────────────────┤
│psaux  │port souris PS/2                                      │
├───────┼──────────────────────────────────────────────────────┤
│gpmdata│pseudo périphérique, répétiteur du démon GPM de souris│
└───────┴──────────────────────────────────────────────────────┘

┌─────┬────────────────────────────────────────────────────────────┐
│cdrom│Lien symbolique vers le lecteur de CD                       │
├─────┼────────────────────────────────────────────────────────────┤
│mouse│Lien symbolique vers le fichier de périphérique de la souris│
└─────┴────────────────────────────────────────────────────────────┘

┌────┬───────────────────────────────────────────────┐
│null│tout ce qui est écrit vers ce fichier disparaît│
├────┼───────────────────────────────────────────────┤
│zero│fichier qui fabrique continuellement des zéros │
└────┴───────────────────────────────────────────────┘

D.1.1. Régler la souris

La souris peut être utilisée aussi bien dans une console Linux (avec gpm) qu'en
environnement X Window. Il suffit normalement d'installer le fichier gpm et le
serveur X. Les deux doivent utiliser /dev/input/mice comme périphérique. Le
protocole correct pour la souris est exps2 pour gpm et ExplorerPS/2 pour le
serveur X. Les fichiers de configuration sont respectivement /etc/gpm.conf et /
etc/X11/xorg.conf.

Pour faire fonctionner la souris, il faut charger certains modules du noyau.
Dans la plupart des cas, les modules corrects sont autodétectés mais certaines
souris anciennes ^[23] sur de vieux ordinateurs posent des problèmes. Voici les
modules du noyau nécessaires aux différents types de souris :

┌────────┬──────────────────────────────────────────────────┐
│ Module │                   Description                    │
├────────┼──────────────────────────────────────────────────┤
│psmouse │Souris PS/2 (devrait être détectée)               │
├────────┼──────────────────────────────────────────────────┤
│usbhid  │Souris USB (devrait être détectée)                │
├────────┼──────────────────────────────────────────────────┤
│sermouse│Souris de type série                              │
├────────┼──────────────────────────────────────────────────┤
│logibm  │Souris Bus connectée à l'adaptateur Logitech      │
├────────┼──────────────────────────────────────────────────┤
│inport  │Souris Bus connectée à des cartes ATI ou Microsoft│
└────────┴──────────────────────────────────────────────────┘

Pour charger le module d'un pilote souris, vous pouvez utiliser la commande 
modconf (paquet du même nom) et chercher dans la catégorie kernel/drivers/input
/mouse.

D.2. Espace disque nécessaire pour les tâches

Une installation standard pour l'architecture amd64, avec le noyau par défaut
et tous les paquets standard, demande 971 Mo. Une installation minimale, sans
la tâche Standard system, demande 769 Mo.

Important

Dans ces deux cas, l'espace disque réellement utilisé est calculé après la fin
de l'installation et tous les fichiers temporaires éliminés. Il ne prend pas en
compte l'espace utilisé par le système de fichiers, par exemple par les
journaux. Il est donc clair qu'il faut plus d'espace disque à la fois pendant
l'installation et en utilisation réelle du système.

Le tableau suivant montre les tailles rapportées par aptitude pour les tâches
affichées dans tasksel. Certaines tâches ont des éléments communs, et donc la
taille totale pour ces deux tâches peut être moindre que la somme des deux
tailles.

L'installateur installe par défaut l'environnement de bureau GNOME, mais
d'autres environnements sont possibles. Ils peuvent être sélectionnés soit en
utilisant une image spécifique, soit en indiquant l'environnement voulu pendant
l'installation. Veuillez consulter la Section 6.3.6.2, « Sélection et
installation des paquets ».

Pour déterminer la dimension d'une partition, vous devez ajouter les tailles
dans le tableau et la taille de l'installation de base. Ce que représente « 
Taille installée » va dans /usr et dans /lib ; et ce que représente « Taille à
charger » va (provisoirement) dans /var.

┌──────────────────┬───────────────┬──────────────────┬───────────────────────┐
│      Tâches      │    Taille     │     Taille à     │      Espace pour      │
│                  │Installée (Mo) │ télécharger (Mo) │  l’installation (Mo)  │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│Environnement de  │               │                  │                       │
│bureau :          │               │                  │                       │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│  • GNOME (défaut)│2790           │786               │3576                   │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│  • KDE Plasma    │4122           │1212              │5334                   │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│  • Xfce          │2187           │621               │2808                   │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│  • LXDE          │2271           │653               │2924                   │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│  • MATE          │2574           │711               │3285                   │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│  • Cinnamon      │4197           │1251              │5448                   │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│Serveur web       │44             │11                │55                     │
├──────────────────┼───────────────┼──────────────────┼───────────────────────┤
│Serveur SSH       │2              │0                 │2                      │
└──────────────────┴───────────────┴──────────────────┴───────────────────────┘

Si vous faites une installation dans une langue autre que l'anglais, tasksel
installera automatiquement une locale s'il en existe une pour votre langue.
Chaque langue nécessite un espace variable sur le disque. Vous devriez accorder
350 Mo pour le téléchargement et l'installation.

D.3. Installer Debian GNU/Linux à partir d'un système Unix/Linux

Cette partie explique comment installer Debian GNU/Linux à partir d'un système
Unix ou Linux existant, sans utiliser le système d'installation avec menus qui
est exposé dans la suite de ce manuel. Les utilisateurs qui changeaient leur
distribution Red Hat, Mandriva ou Suse pour Debian GNU/Linux réclamaient ce
guide d'installation. Dans cette partie, on suppose que le lecteur a acquis une
certaine familiarité avec les commandes *nix et qu'il sait parcourir un système
de fichiers. $ symbolisera une commande qui doit être saisie dans le système
actuel, alors que # fera référence à une commande qui doit être saisie dans le 
chroot Debian.

Une fois que vous aurez configuré le nouveau système Debian, vous pourrez y
installer les données des utilisateurs (s'il y en a), et continuer à
travailler. Debian GNU/Linux s'installe sans aucune interruption de service.
C'est également une façon intelligente de résoudre les problèmes d'équipement
qui, d'ordinaire, donnent du fil à retordre aux systèmes d'installation ou aux
systèmes d'amorçage.

Note

Cette procédure étant essentiellement « manuelle », sachez que la configuration
du système vous demandera beaucoup de temps. Elle vous demandera aussi plus de
connaissances de Debian et de Linux en général qu'une installation standard.
Cette procédure ne peut résulter en un système identique à un système installé
normalement. Elle ne donne que les premières étapes de la configuration d'un
système. D'autres étapes seront sans doute nécessaires.

D.3.1. Pour commencer

Avec votre outil habituel de partitionnement *nix, partitionnez le disque dur
et créez au moins un système de fichiers ainsi qu'une zone d'échange (swap).
Vous devez disposer d'au moins 769 Mo pour l'installation d'un système en mode
console et d'au moins 2271 Mo si vous avez l'intention d'installer X (et plus
si vous voulez installer un environnement de bureau comme GNOME ou KDE Plasma).

Pour créer un système de fichiers sur les partitions, par exemple, pour créer
un système de fichiers ext3 sur la partition /dev/sda6 (ce sera la partition
racine dans notre exemple), il suffit de faire :

# mke2fs -j /dev/sda6

Pour créer un système de fichier ext2, il suffit d'enlever le -j.

Initialisez et activez la zone d'échange (swap) (modifiez le numéro de la
partition en fonction de celui que vous souhaitez utiliser avec Debian) :

# mkswap /dev/sda5
# sync
# swapon /dev/sda5

Montez une partition sur /mnt/debinst (le point d'installation, qui deviendra
le système de fichier racine (/) sur votre nouveau système). Le point de
montage est totalement arbitraire, c'est de cette façon qu'on y fera référence
par la suite.

# mkdir /mnt/debinst
# mount /dev/sda6 /mnt/debinst

Note

Si vous voulez que certaines parties du système de fichiers (p. ex. /usr)
soient montées sur des partitions distinctes, vous devez créer et monter ces
répertoires vous-même avant de commencer l'étape suivante.

D.3.2. Installer debootstrap

L'outil utilisé par l'installateur Debian et reconnu comme outil officiel pour
installer un système Debian de base s'appelle debootstrap. Il utilise wget et 
ar, mais ne dépend que de /bin/sh et des outils UNIX/Linux élémentaires ^[24].
Installez wget et ar s'ils ne sont pas déjà installés sur votre système, puis
téléchargez et installez debootstrap.

Ou, vous pouvez utiliser la procédure qui suit pour l'installer vous-même.
Créez un répertoire pour y décompresser le .deb :

# mkdir work
# cd work

Le programme debootstrap se trouve dans l'archive Debian (assurez-vous d'avoir
sélectionné le fichier correspondant à votre architecture). Téléchargez le 
debootstrap .deb à partir de pool, copiez le paquet dans le répertoire de
travail, et décompressez les fichiers. Vous aurez besoin d'avoir les droits du
superutilisateur pour installer le binaire.

# ar -x debootstrap_0.X.X_all.deb
# cd /
# zcat /full-path-to-work/work/data.tar.gz | tar xv

D.3.3. Lancer debootstrap

Debootstrap peut télécharger les fichiers nécessaires directement depuis
l'archive debian. Vous pouvez remplacer toutes les références à
http.us.debian.org/debian dans les commandes ci-dessous, par un miroir de
l'archive Debian qui se trouve à proximité de chez vous, relativement au
réseau. Les miroirs sont listés sur http://www.debian.org/mirror/list.

Si vous possédez une image d'installation de Debian GNU/Linux bullseye, montée
sur /cdrom, vous pouvez remplacer l'URL http par l'URL d'un fichier : file:/
cdrom/debian/.

Dans la commande debootstrap remplacez ARCH par l'une des expressions
suivantes : amd64, arm64, armel, armhf, i386, mips64el, mipsel, ppc64el, s390x.

# /usr/sbin/debootstrap --arch ARCH bullseye \
     /mnt/debinst http://ftp.fr.debian.org/debian

Si l'architecture de la cible est différente de celle de l'hôte, vous devriez
ajouter l'option --foreign.

D.3.4. Configurer le système de base

Maintenant vous disposez d'un vrai système Debian, certes un peu élémentaire.
Lancez le programme chroot :

# LANG=C.UTF-8 chroot /mnt/debinst /bin/bash

Si l'architecture de la cible est différente de celle de l'hôte, vous devrez
d'abord y copier qemu-user-static :

# cp /usr/bin/qemu-ARCH-static /mnt/debinst/usr/bin
# LANG=C.UTF-8 chroot /mnt/debinst qemu-ARCH-static /bin/bash

Il est maintenant possible d'avoir à indiquer la définition du terminal pour
être compatible avec le système de base de Debian. Par exemple :

# export TERM=xterm-color

En fonction de sa valeur, vous devrez peut être installer le paquet
ncurses-term pour la prise en charge de TERM.

Si l'architecture de la cible est différente de celle de l'hôte, vous devrez
finir l'installation par :

/debootstrap/debootstrap --second-stage

D.3.4.1. Créer les fichiers des périphériques

Pour l'instant, /dev/ contient seulement des fichiers élémentaires. D'autres
fichiers seront nécessaires pour les prochaines étapes de l'installation. La
manière de les créer dépend du système sur lequel l'installation se fait ; elle
dépend aussi du noyau que vous utiliserez (modulaire ou pas) et du choix entre
fichiers dynamiques (en utilisant udev) ou fichiers statiques pour le nouveau
système.

Voici quelques options disponibles :

  • installer le paquet makedev et créer un ensemble standard de fichiers de
    périphériques statiques avec :

    # apt install makedev
    # mount none /proc -t proc
    # cd /dev
    # MAKEDEV generic

  • créer seulement quelques fichiers choisis avec la commande MAKEDEV ;

  • monter (option bind) le répertoire /dev du système hôte sur le répertoire /
    dev du système cible. Il faut remarquer que les scripts postinst de
    certains paquets peuvent essayer de créer des fichiers de périphériques ;
    cette option doit être employée avec précaution.

D.3.4.2. Monter les partitions

Vous devez créer /etc/fstab.

# editor /etc/fstab

Voici un exemple que vous pouvez modifier à votre convenance :

# /etc/fstab: static file system information.
#
# file system    mount point   type    options                  dump pass
/dev/XXX         /             ext3    defaults                 0    1
/dev/XXX         /boot         ext3    ro,nosuid,nodev          0    2

/dev/XXX         none          swap    sw                       0    0
proc             /proc         proc    defaults                 0    0

/dev/cdrom       /media/cdrom    iso9660 noauto,ro,user,exec      0    0

/dev/XXX         /tmp          ext3    rw,nosuid,nodev          0    2
/dev/XXX         /var          ext3    rw,nosuid,nodev          0    2
/dev/XXX         /usr          ext3    rw,nodev                 0    2
/dev/XXX         /home         ext3    rw,nosuid,nodev          0    2

Utilisez mount -a pour monter l'ensemble des systèmes de fichiers que vous avez
indiqué dans votre fichier /etc/fstab, ou, pour monter un à un chaque système
de fichiers, utilisez :

# mount /path  # par exemple :  mount /usr

Les systèmes Debian actuels montent les médias extractibles sous le répertoire
/media, mais conservent des liens symboliques de compatibilité sous la racine
/. Pour les créer :

# cd /media
# mkdir cdrom0
# ln -s cdrom0 cdrom
# cd /
# ln -s media/cdrom

Vous pouvez monter le système de fichiers proc plusieurs fois et à divers
endroits, cependant on choisit d'habitude /proc. Si vous n'utilisez pas mount
-a, assurez-vous d'avoir monté proc avant d'aller plus loin :

# mount -t proc proc /proc

La commande ls /proc affiche maintenant un répertoire non vide. Si cela échoue,
vous pouvez monter proc hors du chroot de cette manière :

# mount -t proc proc /mnt/debinst/proc

D.3.4.3. Configurer le fuseau horaire

La troisième ligne du fichier /etc/adjtime peut contenir « UTC » ou « LOCAL ».
Ce paramètre détermine si le système considère que l'horloge système est réglée
sur le temps UTC ou non. La commande suivante permet d'effectuer cette
opération.

# editor /etc/adjtime

Voici un exemple :

0.0 0 0.0
0
UTC

La commande suivante permet de modifier le fuseau horaire :

# dpkg-reconfigure tzdata

D.3.4.4. Configurer le réseau

Pour configurer le réseau, éditez les fichiers /etc/network/interfaces, /etc/
resolv.conf, etc/hostname et /etc/hosts.

# editor /etc/network/interfaces

Voici quelques exemples simples qui proviennent de /usr/share/doc/ifupdown/
examples :

######################################################################
# /etc/network/interfaces -- configuration file for ifup(8), ifdown(8)
# See the interfaces(5) manpage for information on what options are
# available.
######################################################################

# The loopback interface isn't really required any longer, but can be used
# if needed.
#
# auto lo
# iface lo inet loopback

# To use dhcp:
#
# auto eth0
# iface eth0 inet dhcp

# An example static IP setup: (network, broadcast and gateway are optional)
#
# auto eth0
# iface eth0 inet static
#     address 192.168.0.42
#     network 192.168.0.0
#     netmask 255.255.255.0
#     broadcast 192.168.0.255
#     gateway 192.168.0.1

Indiquez vos serveurs de noms et les directives search dans le fichier /etc/
resolv.conf :

# editor /etc/resolv.conf

Un fichier /etc/resolv.conf simple :

# search example.com
# nameserver 10.1.1.36
# nameserver 192.168.9.100

Indiquez le nom de votre système (de 2 à 63 caractères) :

# echo DebianHostName > /etc/hostname

Et un fichier /etc/hosts élémentaire, avec gestion de IPv6 :

127.0.0.1 localhost
127.0.1.1 DebianHostName

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

Si vous possédez plusieurs cartes réseau, faites en sorte d'indiquer par ordre
les modules que vous voulez charger dans le fichier /etc/modules. De cette
façon, lors du démarrage, chaque carte sera associée avec le nom d'interface
(eth0, eth1, etc.) que vous souhaitiez.

D.3.4.5. Configurer Apt

Debootstrap aura créé un fichier /etc/apt/sources.list élémentaire qui
permettra d'installer d'autres paquets. Cependant, vous pouvez ajouter d'autres
sources, par exemple les sources concernant les mises à jour de sécurité ou
celles des paquets source :

deb-src http://ftp.us.debian.org/debian bullseye main

deb http://security.debian.org/ bullseye-security main
deb-src http://security.debian.org/ bullseye-security main

N'oubliez pas de lancer apt update après avoir modifié le fichier /etc/apt/
sources.list.

D.3.4.6. Configurer les locales et le clavier

Pour configurer les paramètres locaux, pour l'utilisation d'une autre langue
que l'anglais, installez le paquet locales puis configurez-le. Il est conseillé
d'utiliser les locales UTF-8.

# apt install locales
# dpkg-reconfigure locales

Pour configurer le clavier (si besoin est) :

# apt install console-setup
# dpkg-reconfigure keyboard-configuration

Il faut noter que le clavier ne peut pas être configuré à l'intérieur du
chroot. Il sera configuré au prochain démarrage de la machine.

D.3.5. Installer un noyau

Si vous avez l'intention de démarrer ce système, vous aurez vraisemblablement
besoin d'un noyau Linux ainsi que d'un programme d'amorçage. Identifiez les
paquets contenant des noyaux avec :

# apt search linux-image

Installez alors le noyau de votre choix en utilisant son nom :

# apt install linux-image-arch-etc

D.3.6. Configurer le programme d'amorçage

Pour que votre système Debian GNU/Linux puisse démarrer, configurez le
programme d'amorçage pour qu'il charge le noyau installé avec votre nouvelle
partition racine. Debootstrap n'installe pas de programme d'amorçage mais vous
pouvez utiliser apt pour en installer un.

Consultez info grub pour les instructions de configuration du programme
d'amorçage. Si vous souhaitez conserver le système dont vous vous êtes servi
pour installer Debian, ajoutez simplement une entrée pour l'installation de
Debian dans le fichier grub.cfg de votre installation de grub2.

L'installation et la configuration de grub2 est aussi simple que ça :

# apt install grub-pc
# grub-install /dev/sda
# update-grub

La deuxième commande installe grub2 (ici, sur le MBR de sda). La dernière
commande crée un fichier /boot/grub/grub.cfg fonctionnel.

On suppose ici qu'un fichier /dev/sda a été créé. Il y a d'autres méthodes pour
installer grub2, mais elles sortent du cadre de cette annexe.

D.3.7. Accès distant : installer SSH et configurer l'accès

Si vous pouvez vous connecter au système par la console, vous pouvez sauter
cette section. Si par la suite le système doit être accessible par le réseau,
vous devez installer ssh et configurer l'accès.

# apt install ssh

La connexion du superutilisateur par mot de passe est désactivée par défaut.
Pour configurer l'accès SSH, vous devrez créer un mot de passe et réactiver
l'accès du superutilisateur par mot de passe.

# passwd
# editor /etc/ssh/sshd_config

Cette option est à activer :

PermitRootLogin yes

L'accès peut aussi être configuré en ajoutant une clé ssh au compte du
superutilisateur :

# mkdir /root/.ssh
# cat << EOF > /root/.ssh/authorized_keys
ssh-rsa ....
EOF

Enfin, l'accès peut être configuré en ajoutant un utilisateur normal et en
créant un mot de passe :

# adduser joe
# passwd joe

D.3.8. Touches finales

Comme signalé auparavant, le système sera très basique. Pour l'améliorer
sensiblement, il existe une méthode très simple pour installer les paquets dont
la priorité est « standard » :

# tasksel install standard

Bien sûr, vous pouvez toujours utiliser apt pour installer des paquets un à un.

Après l'installation il y aura beaucoup de paquets dans /var/cache/apt/archives
/. Vous pouvez libérer un peu d'espace avec :

# apt clean

D.4. Installer Debian GNU/Linux grâce au protocole PLIP (IP sur port parallèle)

Cette section explique comment installer Debian GNU/Linux sur un ordinateur,
sans carte Ethernet, mais qui est relié à une passerelle distante par un câble
appelé Null-Modem ou Null-Printer. La passerelle doit être connectée à un
réseau qui possède un miroir Debian (p. ex. Internet).

Dans cet exemple, nous allons configurer une connexion PLIP à une passerelle
qui est connectée à internet avec une connexion par téléphone (ppp0). Nous
utiliserons les adresses 192.168.0.1 et 192.168.0.2 pour les interfaces PLIP du
système cible et du système source. Ces adresses ne doivent pas être utilisées
par ailleurs.

La connexion PLIP configurée pendant l'installation sera disponible après le
réamorçage du système installé, voyez le Chapitre 7, Démarrer votre nouveau
système Debian.

Avant de commencer, vous devez vérifier la configuration du BIOS pour les ports
parallèles (adresses IO et IRQ) des deux systèmes (cible et source). Les
valeurs habituelles sont io=0x378, irq=7.

D.4.1. Prérequis

  • Une machine cible, appelée target, où Debian sera installée ;

  • un support d'installation, voyez la Section 2.4, « Les supports
    d'installation » ;

  • une autre machine connectée à internet, appelée source, qui fonctionnera
    comme passerelle ;

  • un câble Null-Modem DB-25, voyez le PLIP-Install-HOWTO pour des
    informations sur ce câble et sur la manière d'en fabriquer un.

D.4.2. Configuration du système source

Le script suivant montre comment configurer simplement la machine source en
tant que passerelle vers Internet avec ppp0.

#!/bin/sh

# Suppression des modules du noyau pour éviter des conflits
# et reconfiguration.
modprobe -r lp parport_pc
modprobe parport_pc io=0x378 irq=7
modprobe plip

# Configuration de l'interface plip (plip0 ici, voyez dmesg | grep plip)
ifconfig plip0 192.168.0.2 pointopoint 192.168.0.1 netmask 255.255.255.255 up

# Configuration de la passerelle
modprobe iptable_nat
iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE
echo 1 > /proc/sys/net/ipv4/ip_forward

D.4.3. Installation du système cible

Amorcez le support d'installation. L'installation doit se faire en mode expert.
Pour cela, saisissez expert à l'invite d'amorçage. Si vous avez besoin de
donner des paramètres pour le noyau, vous devez le faire aussi à ce moment. Par
exemple, si vous voulez démarrer l'installateur avec des valeurs pour les
options « io » et « irq » du module parport_pc, saisissez :

expert parport_pc.io=0x378 parport_pc.irq=7

Voici maintenant les réponses que vous devrez donner à différents moments de
l'installation.

 1. Chargement des composants de l'installateur à partir d'un support
    d'installation

    Sélectionnez l'option plip-modules dans la liste. Le pilote PLIP sera ainsi
    disponible pour le système d'installation.

 2. Détection du matériel réseau

      □ Si la machine cible possède une carte réseau, une liste des modules
        pour la carte détectée sera affichée. Si vous voulez que l'installateur
        utilise plip, vous devez désélectionner tous les modules affichés. Il
        est évident que si la machine ne possède pas de carte réseau, cette
        liste ne sera pas affichée.

      □ Puisqu'aucune carte réseau n'a été détectée ou sélectionnée,
        l'installateur vous demande de choisir un pilote réseau dans une liste.
        Choisissez le module plip.

 3. Configuration du réseau

      □ Configuration automatique du réseau avec DHCP : No

      □ Adresse IP : 192.168.0.1

      □ Adresse Point-to-Point : 192.168.0.2

      □ Adresses des serveurs de noms : vous pouvez mettre les adresses
        utilisées par le système source, voyez /etc/resolv.conf.

D.5. Installer Debian GNU/Linux avec PPP sur Ethernet (PPPoE)

PPP sur Ethernet (PPPoE) est un protocole très utilisé dans certains pays pour
établir des connexions de type ADSL ou câble à un fournisseur d'accès à
Internet. L'installateur ne permet pas une mise en place automatique de ce type
de connexion mais il est très facile de le faire soi-même.

Une connexion PPPoE établie pendant l'installation sera aussi disponible pour
le système installé après le redémarrage. Consultez le Chapitre 7, Démarrer
votre nouveau système Debian.

Pour pouvoir utiliser une connexion PPPoE pendant l'installation, vous devez
faire une installation avec l'une des images CD-ROM/DVD disponibles. Il n'est
pas possible d'utiliser une autre méthode d'installation, par exemple « netboot
 ».

Une installation avec PPPoE ressemble beaucoup aux autres types d'installation.
La suite du texte explique certaines différences.

  • Il faut amorcer l'installateur avec le paramètre modules=ppp-udeb ^[25].
    Ainsi le composant chargé de la mise en œuvre du protocole PPPoE (ppp-udeb)
    sera exécuté automatiquement.

  • Ensuite suivez les étapes habituelles de l'installateur (sélection de la
    langue, du pays et du clavier ; chargement de composants supplémentaires ^
    [26]).

  • L'étape suivante est la détection du matériel réseau pour identifier toutes
    les cartes Ethernet présentes.

  • Puis commence la mise en œuvre du protocole PPPoE. L'installateur examine
    toutes les interfaces Ethernet détectées pour trouver un concentrateur
    PPPoE (type de serveur qui gère les connexions PPPoE).

    Il est possible que le concentrateur ne soit pas trouvé du premier coup.
    Cela arrive parfois avec des réseaux lents ou surchargés ou avec des
    serveurs défectueux. La plupart du temps, le deuxième essai réussira. Pour
    réessayer, sélectionnez Configurer et lancer une connexion PPPoE dans le
    menu principal de l'installateur.

  • Une fois le concentrateur trouvé, l'utilisateur doit indiquer son
    identifiant et son mot de passe PPPoE.

  • L'installateur tente maintenant d'établir la connexion PPPoE. Si tout est
    correct, la connexion est établie et l'installateur peut récupérer des
    paquets sur internet. Si l'information donnée n'est pas correcte,
    l'installateur s'arrête. On peut retenter la configuration en sélectionnant
    l'entrée de menu Configurer et lancer une connexion PPPoE.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[23] Les souris de type série ont un connecteur à 9 trous en forme de D ; les
souris bus ont un connecteur rond à 8 tiges, qu'il ne faut pas confondre avec
le connecteur à 6 tiges d'une souris PS/2 ou avec le connecteur à 4 tiges d'une
souris ADB.

^[24] Ces programmes sont les utilitaires GNU (coreutils) et des commandes
comme sed, grep, tar et gzip.

^[25] Consultez la Section 5.1.7, « L'écran d'amorçage » pour savoir comment
passer un paramètre d'amorçage.

^[26] Le composant ppp-udeb est chargé à ce moment-là. Si vous faites une
installation en mode « expert », priorité « medium » ou « low », vous pouvez
choisir vous-même le composant au lieu de saisir un paramètre « modules » à
l'amorçage.

Annexe E. Administrivia

Table des matières

E.1. À propos de ce document
E.2. Pour contribuer à ce document
E.3. Principales contributions
E.4. Marques déposées

E.1. À propos de ce document

Ce manuel a été créé pour l'installateur de la distribution Sarge. Il est basé
sur le manuel de l'installateur de la distribution Woody, qui lui-même était
basé sur d'anciens manuels d'installation de Debian. Il est aussi basé sur le
manuel de la distribution Progeny, distribué sous GPL en 2003.

Ce document est écrit au format DocBook XML. Les textes produits sont créés par
différents programmes à partir des paquets docbook-xml et docbook-xsl.

Pour faciliter la maintenance de ce document, nous utilisons certaines
fonctionnalités XML, telles qu'entités et attributs de particularisation. Ils
jouent le même rôle que les variables et les conditions dans les langages de
programmation. La source XML de ce document contient des informations pour
chaque architecture -- les attributs de particularisation sont utilisés afin
d'isoler certaines parties du texte spécifiques à une architecture donnée.

Le centre névralgique de la traduction française de ce document, coordonnée par
Baptiste Jammet, se trouve sur la liste <debian-l10n-french@lists.debian.org>.
Philippe Batailler était l'ancien coordinateur et principal traducteur jusqu'en
2014.

E.2. Pour contribuer à ce document

Si vous avez des questions ou des suggestions à propos de ce document, vous
pouvez envoyer un rapport de bogue concernant le paquet installation-guide.
Voyez le paquet reportbug ou lisez la documentation en ligne disponible dans le
système de suivi des bogues. Ce serait bien si vous pouviez vérifier dans les
bogues ouverts à propos du manuel de l'installateur que votre problème n'a pas
déjà été signalé. Si c'est le cas, vous pouvez confirmer le bogue ou donner des
informations complémentaires à l'adresse <XXXX@bugs.debian.org>, où XXXX est le
numéro du bogue en question.

Encore mieux, procurez-vous une copie des sources docbook de ce document et
proposez des correctifs. Les sources docbook sont disponibles dans le
installation-guide project on salsa. Ne vous inquiétez pas si vous ne
connaissez pas bien docBook : une note rapide dans le répertoire du manuel vous
mettra sur la voie. DocBook est comme html, mais on s'intéresse au sens du
texte plutôt qu'à sa présentation. On peut envoyer des correctifs à la liste de
discussion debian-boot, voyez plus bas. Pour accéder aux sources par CVS,
consultez le fichier README dans le répertoire racine des sources.

Veuillez ne pas contacter les auteurs de ce document directement. Il existe une
liste de diffusion pour l'installateur Debian qui discute de ce document.
L'adresse de la liste de diffusion est <debian-boot@lists.debian.org>. Les
instructions pour s'abonner sont disponibles à la page d'abonnement aux listes
de diffusion Debian ; une copie de cette liste peut être consultée en ligne
dans les archives des listes de diffusion Debian.

E.3. Principales contributions

Bruce Perens, Sven Rudolph, Igor Grobman, James Treacy, et Adam Di Carlo sont
les premiers auteurs de ce texte. Sebastian Ley a écrit le Guide
d'installation.

Miroslav Kuře a documenté beaucoup des nouvelles fonctionnalités de
l'installateur de Sarge. Frans Pop fut le principal responsable du texte lors
des parutions des distributions Etch, Lenny et Squeeze.

Beaucoup, beaucoup d'utilisateurs et de développeurs Debian ont participé à ce
document. On doit mentionner particulièrement Michael Schmitz (pour m68k),
Frank Neumann (à l'origine du guide d'installation de Debian sur Amiga), Arto
Astala, Eric Delaunay et Ben Collins (SPARC information), Tapio Lehtonen et
Stéphane Bortzmeyer pour de nombreux textes. Nous remercions aussi Pascal Le
Bail pour ses informations sur la manière d'amorcer à partir des clés USB.

Des informations extrêmement utiles ont été piochées dans le HOWTO sur le
démarrage réseau de Jim Mintha (pas d'URL disponible), la FAQ Debian, la FAQ
Linux/m68k, la FAQ Linux pour processeurs SPARC, la FAQ Linux/Alpha, et
d'autres encore. Que les auteurs de ces sources d'informations riches et
librement accessibles soient remerciés.

La section de ce manuel « Installer Debian à partir d'un système Unix/Linux » (
Section D.3, « Installer Debian GNU/Linux à partir d'un système Unix/Linux »)
est partiellement reprise d'un document avec copyright Karsten M. Self.

La section sur l'installation avec plip (Section D.4, « Installer Debian GNU/
Linux grâce au protocole PLIP (IP sur port parallèle) ») est basée sur le
PLIP-Install-HOWTO de Gilles Lamiral.

E.4. Marques déposées

Les marques déposées citées dans ce document appartiennent à leurs
propriétaires.

Annexe F. GNU General Public License

Note

This is an unofficial translation of the GNU General Public License into
french. It was not published by the Free Software Foundation, and does not
legally state the distribution terms for software that uses the GNU GPL -- only
the original English text of the GNU GPL does that. However, we hope that this
translation will help french speakers understand the GNU GPL better.

Cette traduction est une traduction non officielle de la GNU General Public
License en français. Elle n'a pas été publiée par la Free Software Foundation,
et ne détermine pas les termes de distribution pour les logiciels qui utilisent
la GNU GPL, seul le texte anglais original de la GNU GPL détermine ces termes.
Cependant, nous espérons que cette traduction aidera les francophones à mieux
comprendre la GNU GPL.

Version 2, June 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc.
51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.

Tout le monde peut copier et distribuer des copies verbatim de ce document
mais il est interdit de le modifier.

Préambule

Les licences de la plupart des logiciels sont conçues pour vous enlever toute
liberté de les partager et de les modifier. A contrario, la Licence Publique
Générale est destinée à garantir votre liberté de partager et de modifier les
logiciels libres, et à assurer que ces logiciels soient libres pour tous leurs
utilisateurs. La présente Licence Publique Générale s'applique à la plupart des
logiciels de la Free Software Foundation, ainsi qu'à tout autre programme pour
lequel ses auteurs s'engagent à l'utiliser. (Certains autres logiciels de la
Free Software Foundation sont couverts par la GNU Lesser General Public License
à la place.) Vous pouvez aussi l'appliquer aux programmes qui sont les vôtres.

Quand nous parlons de logiciels libres, nous parlons de liberté, non de prix.
Nos licences publiques générales sont conçues pour vous donner l'assurance
d'être libres de distribuer des copies des logiciels libres (et de facturer ce
service, si vous le souhaitez), de recevoir le code source ou de pouvoir
l'obtenir si vous le souhaitez, de pouvoir modifier les logiciels ou en
utiliser des éléments dans de nouveaux programmes libres et de savoir que vous
pouvez le faire.

Pour protéger vos droits, il nous est nécessaire d'imposer des limitations qui
interdisent à quiconque de vous refuser ces droits ou de vous demander d'y
renoncer. Certaines responsabilités vous incombent en raison de ces limitations
si vous distribuez des copies de ces logiciels, ou si vous les modifiez.

Par exemple, si vous distribuez des copies d'un tel programme, à titre gratuit
ou contre une rémunération, vous devez accorder aux destinataires tous les
droits dont vous disposez. Vous devez vous assurer qu'eux aussi reçoivent ou
puissent disposer du code source. Et vous devez leur montrer les présentes
conditions afin qu'ils aient connaissance de leurs droits.

Nous protégeons vos droits en deux étapes : (1) nous sommes titulaires des
droits d'auteur du logiciel, et (2) nous vous délivrons cette licence, qui vous
donne l'autorisation légale de copier, distribuer et/ou modifier le logiciel.

En outre, pour la protection de chaque auteur ainsi que la nôtre, nous voulons
nous assurer que chacun comprenne que ce logiciel libre ne fait l'objet
d'aucune garantie. Si le logiciel est modifié par quelqu'un d'autre puis
transmis à des tiers, nous voulons que les destinataires soient mis au courant
que ce qu'ils ont reçu n'est pas le logiciel d'origine, de sorte que tout
problème introduit par d'autres ne puisse entacher la réputation de l'auteur
originel.

En définitive, un programme libre restera à la merci des brevets de logiciels.
Nous souhaitons éviter le risque que les redistributeurs d'un programme libre
fassent des demandes individuelles de licence de brevet, ceci ayant pour effet
de rendre le programme propriétaire. Pour éviter cela, nous établissons
clairement que toute licence de brevet doit être concédée de façon à ce que
l'usage en soit libre pour tous ou bien qu'aucune licence ne soit concédée.

Les termes exacts et les conditions de copie, distribution et modification sont
les suivants :

GNU GENERAL PUBLIC LICENSE

Conditions de copie, distribution et modification de la Licence Publique
Générale GNU.

0. La présente Licence s'applique à tout programme ou tout autre ouvrage
contenant un avis, apposé par le titulaire des droits d'auteur, stipulant qu'il
peut être distribué au titre des conditions de la présente Licence Publique
Générale. Ci-après, le « Programme » désigne l'un quelconque de ces programmes
ou ouvrages, et un « ouvrage fondé sur le Programme » désigne soit le
Programme, soit un ouvrage qui en dérive au titre des lois sur le droit
d'auteur : en d'autres termes, un ouvrage contenant le Programme ou une partie
de ce dernier, soit à l'identique, soit avec des modifications et/ou traduit
dans un autre langage (Ci-après, le terme « modification » implique, sans s'y
réduire, le terme traduction). Chaque concessionnaire sera désigné par « vous »
.

Les activités autres que la copie, la distribution et la modification ne sont
pas couvertes par la présente Licence ; elles sont hors de son champ
d'application. L'opération consistant à exécuter le Programme n'est soumise à
aucune limitation et les sorties du programme ne sont couvertes que si leur
contenu constitue un ouvrage fondé sur le Programme (indépendamment du fait
qu'il ait été réalisé par l'exécution du Programme). La validité de ce qui
précède dépend de ce que fait le Programme.

1. Vous pouvez copier et distribuer des copies à l'identique du code source du
Programme tel que vous l'avez reçu, sur n'importe quel support, du moment que
vous apposiez sur chaque copie, de manière ad hoc et parfaitement visible,
l'avis de droit d'auteur adéquat et une exonération de garantie ; que vous
gardiez intacts tous les avis faisant référence à la présente Licence et à
l'absence de toute garantie ; et que vous fournissiez à tout destinataire du
Programme autre que vous-même un exemplaire de la présente Licence en même
temps que le Programme.

Vous pouvez faire payer l'acte physique de transmission d'une copie, et vous
pouvez, à votre discrétion, proposer une garantie contre rémunération.

2. Vous pouvez modifier votre copie ou des copies du Programme ou n'importe
quelle partie de celui-ci, créant ainsi un ouvrage fondé sur le Programme, et
copier et distribuer de telles modifications ou ouvrage selon les termes de
l'Article 1 ci-dessus, à condition de vous conformer également à chacune des
obligations suivantes :

 a. Vous devez munir les fichiers modifiés d'avis bien visibles stipulant que
    vous avez modifié ces fichiers, ainsi que la date de chaque modification ;

 b. Vous devez prendre les dispositions nécessaires pour que tout ouvrage que
    vous distribuez ou publiez, et qui, en totalité ou en partie, contient ou
    est fondé sur le Programme -- ou une partie quelconque de ce dernier --
    soit concédé comme un tout, à titre gratuit, à n'importe quel tiers, au
    titre des conditions de la présente Licence.

 c. Si le programme modifié lit habituellement des instructions de façon
    interactive lorsqu'on l'exécute, vous devez, quand il commence son
    exécution pour ladite utilisation interactive de la manière la plus
    usuelle, faire en sorte qu'il imprime ou affiche une annonce comprenant un
    avis de droit d'auteur ad hoc, et un avis stipulant qu'il n'y a pas de
    garantie (ou bien indiquant que c'est vous qui fournissez la garantie), et
    que les utilisateurs peuvent redistribuer le programme en respectant les
    présentes obligations, et expliquant à l'utilisateur comment voir une copie
    de la présente Licence (Exception : si le Programme est lui-même interactif
    mais n'imprime pas habituellement une telle annonce, votre ouvrage fondé
    sur le Programme n'est pas obligé d'imprimer une annonce).

Ces obligations s'appliquent à l'ouvrage modifié pris comme un tout. Si des
éléments identifiables de cet ouvrage ne sont pas fondés sur le Programme et
peuvent raisonnablement être considérés comme des ouvrages indépendants
distincts en eux-mêmes, alors la présente Licence et ses conditions ne
s'appliquent pas à ces éléments lorsque vous les distribuez en tant qu'ouvrages
distincts. Mais lorsque vous distribuez ces mêmes éléments comme partie d'un
tout, lequel constitue un ouvrage fondé sur le Programme, la distribution de ce
tout doit être soumise aux conditions de la présente Licence, et les
autorisations qu'elle octroie aux autres concessionnaires s'étendent à
l'ensemble de l'ouvrage et par conséquent à chaque et toute partie
indifféremment de qui l'a écrite.

Par conséquent, l'objet du présent article n'est pas de revendiquer des droits
ou de contester vos droits sur un ouvrage entièrement écrit par vous ; son
objet est plutôt d'exercer le droit de contrôler la distribution d'ouvrages
dérivés ou d'ouvrages collectifs fondés sur le Programme.

De plus, la simple proximité du Programme avec un autre ouvrage qui n'est pas
fondé sur le Programme (ou un ouvrage fondé sur le Programme) sur une partition
d'un espace de stockage ou un support de distribution ne place pas cet autre
ouvrage dans le champ d'application de la présente Licence.

3. Vous pouvez copier et distribuer le Programme (ou un ouvrage fondé sur lui,
selon l'Article 2) sous forme de code objet ou d'exécutable, selon les termes
des Articles 1 et 2 ci-dessus, à condition que vous accomplissiez l'un des
points suivants :

 a. L'accompagner de l'intégralité du code source correspondant, sous une forme
    lisible par un ordinateur, lequel doit être distribué au titre des termes
    des Articles 1 et 2 ci-dessus, sur un support habituellement utilisé pour
    l'échange de logiciels ; ou,

 b. L'accompagner d'une proposition écrite, valable pendant au moins trois ans,
    de fournir à tout tiers, à un tarif qui ne soit pas supérieur à ce que vous
    coûte l'acte physique de réaliser une distribution source, une copie
    intégrale du code source correspondant sous une forme lisible par un
    ordinateur, qui sera distribuée au titre des termes des Articles 1 et 2
    ci-dessus, sur un support habituellement utilisé pour l'échange de
    logiciels ; ou,

 c. L'accompagner des informations reçues par vous concernant la proposition de
    distribution du code source correspondant. (Cette solution n'est autorisée
    que dans le cas d'une distribution non commerciale et seulement si vous
    avez reçu le programme sous forme de code objet ou d'exécutable accompagné
    d'une telle proposition -- en conformité avec le sous-Article b ci-dessus.)

Le code source d'un ouvrage désigne la forme favorite pour travailler à des
modifications de cet ouvrage. Pour un ouvrage exécutable, le code source
intégral désigne la totalité du code source de la totalité des modules qu'il
contient, ainsi que les éventuels fichiers de définition des interfaces qui y
sont associés, ainsi que les scripts utilisés pour contrôler la compilation et
l'installation de l'exécutable. Cependant, par exception spéciale, le code
source distribué n'est pas censé inclure quoi que ce soit de normalement
distribué (que ce soit sous forme source ou binaire) avec les composants
principaux (compilateur, noyau, et autre) du système d'exploitation sur lequel
l'exécutable tourne, à moins que ce composant lui-même n'accompagne
l'exécutable.

Si distribuer un exécutable ou un code objet consiste à offrir un accès
permettant leur copie depuis un endroit particulier, alors l'offre d'un accès
équivalent pour copier le code source depuis le même endroit compte comme une
distribution du code source -- même si les tiers ne sont pas contraints de
copier le source en même temps que le code objet.

4. Vous ne pouvez copier, modifier, concéder en sous-licence, ou distribuer le
Programme, sauf tel qu'expressément prévu par la présente Licence. Toute
tentative de copier, modifier, concéder en sous-licence, ou distribuer le
Programme d'une autre manière est réputée non valable, et met immédiatement fin
à vos droits au titre de la présente Licence. Toutefois, les tiers ayant reçu
de vous des copies, ou des droits, au titre de la présente Licence ne verront
pas leurs autorisations résiliées aussi longtemps que lesdits tiers se
conforment pleinement à elle.

5. Vous n'êtes pas obligé d'accepter la présente Licence étant donné que vous
ne l'avez pas signée. Cependant, rien d'autre ne vous accorde l'autorisation de
modifier ou distribuer le Programme ou les ouvrages fondés sur lui. Ces actions
sont interdites par la loi si vous n'acceptez pas la présente Licence. En
conséquence, en modifiant ou distribuant le Programme (ou un ouvrage quelconque
fondé sur le Programme), vous signifiez votre acceptation de la présente
Licence en le faisant, et de toutes ses conditions concernant la copie, la
distribution ou la modification du Programme ou d'ouvrages fondés sur lui.

6. Chaque fois que vous redistribuez le Programme (ou n'importe quel ouvrage
fondé sur le Programme), une licence est automatiquement concédée au
destinataire par le concédant originel de la licence, l'autorisant à copier,
distribuer ou modifier le Programme, sous réserve des présentes conditions.
Vous ne pouvez imposer une quelconque limitation supplémentaire à l'exercice
des droits octroyés au titre des présentes par le destinataire. Vous n'avez pas
la responsabilité d'imposer le respect de la présente Licence à des tiers.

7. Si, conséquemment à une décision de justice ou l'allégation d'une
transgression de brevet ou pour toute autre raison (non limitée à un problème
de brevet), des obligations vous sont imposées (que ce soit par jugement,
conciliation ou autre) qui contredisent les conditions de la présente Licence,
elles ne vous excusent pas des conditions de la présente Licence. Si vous ne
pouvez distribuer de manière à satisfaire simultanément vos obligations au
titre de la présente Licence et toute autre obligation pertinente, alors il en
découle que vous ne pouvez pas du tout distribuer le Programme. Par exemple, si
une licence de brevet ne permettait pas une redistribution sans redevance du
Programme par tous ceux qui reçoivent une copie directement ou indirectement
par votre intermédiaire, alors la seule façon pour vous de satisfaire à la fois
à la licence du brevet et à la présente Licence serait de vous abstenir
totalement de toute distribution du Programme.

Si une partie quelconque de cet article est tenue pour nulle ou inopposable
dans une circonstance particulière quelconque, l'intention est que le reste de
l'article s'applique. La totalité de la section s'appliquera dans toutes les
autres circonstances.

Cet article n'a pas pour but de vous induire à transgresser un quelconque
brevet ou d'autres revendications à un droit de propriété ou à contester la
validité de la moindre de ces revendications ; cet article a pour seul objectif
de protéger l'intégrité du système de distribution du logiciel libre, qui est
mis en œuvre par la pratique des licences publiques. De nombreuses personnes
ont fait de généreuses contributions au large spectre de logiciels distribués
par ce système en se fiant à l'application cohérente de ce système ; il
appartient à chaque auteur/donateur de décider si il ou elle veut distribuer du
logiciel par l'intermédiaire d'un quelconque autre système et un
concessionnaire ne peut imposer ce choix.

Cet article a pour but de rendre totalement limpide ce que l'on pense être une
conséquence du reste de la présente Licence.

8. Si la distribution et/ou l'utilisation du Programme est limitée dans
certains pays que ce soit par des brevets ou par des interfaces soumises au
droit d'auteur, le titulaire originel des droits d'auteur qui décide de couvrir
le Programme par la présente Licence peut ajouter une limitation géographique
de distribution explicite qui exclue ces pays afin que la distribution soit
permise seulement dans ou entre les pays qui ne sont pas ainsi exclus. Dans ce
cas, la présente Licence incorpore la limitation comme si elle était écrite
dans le corps de la présente Licence.

9. La Free Software Foundation peut, de temps à autre, publier des versions
révisées et/ou nouvelles de la Licence Publique Générale. De telles nouvelles
versions seront similaires à la présente version dans l'esprit mais pourront
différer dans le détail pour prendre en compte de nouvelles problématiques ou
inquiétudes. Chaque version possède un numéro de version la distinguant. Si le
Programme précise le numéro de version de la présente Licence qui s'y applique
et « une version ultérieure quelconque », vous avez le choix de suivre les
conditions de la présente version ou de toute autre version ultérieure publiée
par la Free Software Foundation. Si le Programme ne spécifie aucun numéro de
version de la présente Licence, vous pouvez choisir une version quelconque
publiée par la Free Software Foundation à quelque moment que ce soit.

10. Si vous souhaitez incorporer des parties du Programme dans d'autres
programmes libres dont les conditions de distribution sont différentes, écrivez
à l'auteur pour lui en demander l'autorisation. Pour les logiciels dont la Free
Software Foundation est titulaire des droits d'auteur, écrivez à la Free
Software Foundation ; nous faisons parfois des exceptions dans ce sens. Notre
décision sera guidée par le double objectif de préserver le statut libre de
tous les dérivés de nos logiciels libres et de promouvoir le partage et la
réutilisation des logiciels en général.

ABSENCE DE GARANTIE

11. COMME LA LICENCE DU PROGRAMME EST CONCÉDÉE A TITRE GRATUIT, AUCUNE GARANTIE
NE S'APPLIQUE AU PROGRAMME, DANS LES LIMITES AUTORISÉES PAR LA LOI APPLICABLE.
SAUF MENTION CONTRAIRE ÉCRITE, LES TITULAIRES DU DROIT D'AUTEUR ET/OU LES
AUTRES PARTIES FOURNISSENT LE PROGRAMME « EN L'ÉTAT », SANS AUCUNE GARANTIE DE
QUELQUE NATURE QUE CE SOIT, EXPRESSE OU IMPLICITE, Y COMPRIS, MAIS SANS Y ÊTRE
LIMITE, LES GARANTIES IMPLICITES DE COMMERCIABILITÉ ET DE LA CONFORMITÉ A UNE
UTILISATION PARTICULIÈRE. VOUS ASSUMEZ LA TOTALITÉ DES RISQUES LIÉS A LA
QUALITÉ ET AUX PERFORMANCES DU PROGRAMME. SI LE PROGRAMME SE RÉVÉLAIT
DÉFECTUEUX, LE COUT DE L'ENTRETIEN, DES RÉPARATIONS OU DES CORRECTIONS
NÉCESSAIRES VOUS INCOMBENT INTÉGRALEMENT.

12. EN AUCUN CAS, SAUF LORSQUE LA LOI APPLICABLE OU UNE CONVENTION ÉCRITE
L'EXIGE, UN TITULAIRE DE DROIT D'AUTEUR QUEL QU'IL SOIT, OU TOUTE PARTIE QUI
POURRAIT MODIFIER ET/OU REDISTRIBUER LE PROGRAMME COMME PERMIS CI-DESSUS, NE
POURRAIT ÊTRE TENU POUR RESPONSABLE A VOTRE EGARD DES DOMMAGES, INCLUANT LES
DOMMAGES GÉNÉRIQUES, SPÉCIFIQUES, SECONDAIRES OU CONSÉCUTIFS, RÉSULTANT DE
L'UTILISATION OU DE L'INCAPACITÉ D'UTILISER LE PROGRAMME (Y COMPRIS, MAIS SANS
Y ÊTRE LIMITE, LA PERTE DE DONNÉES, OU LE FAIT QUE DES DONNÉES SOIENT RENDUES
IMPRÉCISES, OU LES PERTES ÉPROUVÉES PAR VOUS OU PAR DES TIERS, OU LE FAIT QUE
LE PROGRAMME ÉCHOUE A INTEROPÉRER AVEC UN AUTRE PROGRAMME QUEL QU'IL SOIT) MÊME
SI LE DIT TITULAIRE DU DROIT D'AUTEUR OU LE PARTIE CONCERNÉE A ÉTÉ AVERTI DE
L'ÉVENTUALITÉ DE TELS DOMMAGES.

FIN DES CONDITIONS

Comment appliquer ces conditions à vos nouveaux programmes

Si vous développez un nouveau programme, et si vous voulez qu'il soit de la
plus grande utilité possible pour le public, le meilleur moyen d'y parvenir est
d'en faire un logiciel libre que chacun peut redistribuer et modifier au titre
des présentes conditions.

Pour ce faire, munissez le programme des avis qui suivent. Le plus sûr est de
les ajouter au début de chaque fichier source pour véhiculer le plus
efficacement possible l'absence de toute garantie ; chaque fichier devrait
aussi contenir au moins la ligne « copyright » et une indication de l'endroit
où se trouve l'avis complet.

une ligne donnant le nom du programme et une courte idée de ce qu'il fait.Copyright (C) [année] [nom de l'auteur.]

Ce programme est un logiciel libre ; vous pouvez le redistribuer et/ou le modifier au titre
des clauses de la Licence Publique Générale GNU, telle que publiée par la Free Software
Foundation ; soit la version 2 de la Licence, ou (à votre discrétion) une version ultérieure
quelconque. Ce programme est distribué dans l'espoir qu'il sera utile,
mais SANS AUCUNE GARANTIE ; sans même une garantie implicite de COMMERCIABILITÉ ou
DE CONFORMITÉ A UNE UTILISATION PARTICULIÈRE. Voir la Licence Publique Générale GNU pour plus
de détails. Vous devriez avoir reçu un exemplaire de la Licence Publique Générale GNU
avec ce programme ; si ce n'est pas le cas, écrivez à
la Free Software Foundation Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.

Ajoutez aussi des informations sur la manière de vous contacter par courrier
électronique et courrier postal.

Si le programme est interactif, faites en sorte qu'il affiche un court avis tel
que celui-ci lorsqu'il démarre en mode interactif :

Gnomovision version 69, Copyright (C) année nom de l'auteur
Gnomovision n'est accompagné d'ABSOLUMENT AUCUNE GARANTIE ; pour plus de détails tapez
show w. Ceci est un logiciel libre et vous êtes invité à le redistribuer en respectant
certaines obligations ; pour plus de détails tapez show c.

Les instructions hypothétiques « show w » et « show c » sont supposées montrer
les parties ad hoc de la Licence Publique Générale. Bien entendu, les
instructions que vous utilisez peuvent porter d'autres noms que « show w » et 
« show c » ; elles peuvent même être des clics de souris ou des éléments d'un
menu ou tout ce qui convient à votre programme.

Vous devriez aussi obtenir de votre employeur (si vous travaillez en tant que
développeur) ou de votre école, si c'est le cas, qu'il (ou elle) signe une « 
renonciation aux droits d'auteur » concernant le programme, si nécessaire.
Voici un exemple (changez les noms) :

oyodyne, Inc., déclare par la présente renoncer à toute prétention sur les droits d'auteur
du programme Gnomovision (qui fait des avances aux compilateurs) écrit par James Hacker.
signature de Ty Coon, 1er avril 1989 Ty Coon, President du Vice

La présente Licence Publique Générale n'autorise pas l'incorporation de votre
programme dans des programmes propriétaires. Si votre programme est une
bibliothèque de sous-programmes, vous pouvez considérer plus utile d'autoriser
l'édition de liens d'applications propriétaires avec la bibliothèque. Si c'est
ce que vous voulez faire, utilisez la GNU Lesser General Public License au lieu
de la présente Licence.

