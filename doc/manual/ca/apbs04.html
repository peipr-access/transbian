<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>B.4. Continguts del fitxer de configuració prèvia (per a bullseye)</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot">
<link rel="home" href="index.html" title="Guia d'instal·lació de Debian GNU/Linux">
<link rel="up" href="apb.html" title="Apèndix B. Automatització de la instal·lació fent servir una configuració prèvia">
<link rel="prev" href="apbs03.html" title="B.3. Preparar un fitxer de configuració prèvia">
<link rel="next" href="apbs05.html" title="B.5. Opcions avançades">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">B.4. Continguts del fitxer de configuració prèvia (per a bullseye)</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="apbs03.html"><img src="images/prev.png" alt="Anterior"></a> </td>
<th width="60%" align="center">Apèndix B. Automatització de la instal·lació fent servir una configuració prèvia</th>
<td width="20%" align="right"> <a accesskey="n" href="apbs05.html"><img src="images/next.png" alt="Següent"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="preseed-contents"></a>B.4. Continguts del fitxer de configuració prèvia (per a bullseye)</h2></div></div></div>
<p>Els fragments de configuració emprats a aquest apèndix també són a l'abast com a exemple de fitxer de configuració prèvia a <span class="phrase"><a class="ulink" href="../example-preseed.txt" target="_top">../example-preseed.txt</a></span>. </p>
<p>Tingueu en compte que aquest exemple es basa en una instal·lació per a una arquitectura Intel x86. Si l'arquitectura és diferent, alguns dels exemples (com la selecció del teclat i la instal·lació del carregador) poden no ser adients i hauran de substituir-se per paràmetres de configuració adequats a l'arquitectura en qüestió. </p>
<p>Els detalls del funcionament dels components de l'instal·lador Debian estan a la <a class="xref" href="ch06s03.html" title="6.3. Utilització dels elements individualment">Secció 6.3, «Utilització dels elements individualment»</a>. </p>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-l10n"></a>B.4.1. Localització</h3></div></div></div>
<p>En una instal·lació normal, les preguntes sobre la localització es fan primer, de manera que aquestes valors només es poden configurar prèviament mitjançant les mètodes dels paràmetres d'arrencada d'«initrd» o del nucli. El mode automàtic (<a class="xref" href="apbs02.html#preseed-auto" title="B.2.3. Mode auto">Secció B.2.3, «Mode auto»</a>) inclou la configuració de <code class="literal">auto-install/enable=true</code> (normalment mitjançant l'àlies <code class="literal">auto</code> de la configuració prèvia). Això retarda la presentació de les preguntes sobre localització, de manera que es poden configurar prèviament mitjançant qualsevol mètode. </p>
<p>Es pot fer servir el «locale» per especificar tant la llengua com el país; pot estar format per qualsevol combinació d'una llengua disponible al <code class="classname">debian-installer</code> i un país reconegut. Si la combinació no és un «locale» vàlid, l'instal·lador seleccionarà automàticament un «locale» vàlid amb l'idioma triat. Per especificar el «locale» com un paràmetre d'arrencada, empreu <strong class="userinput"><code>locale=<em class="replaceable"><code>ca_ES</code></em></code></strong>. </p>
<p>Tot i que aquest mètode és molt fàcil d'emprar, no permet la configuració prèvia de totes les combinacions possibles d'idioma, país i «locale»<a href="#ftn.idm3674" class="footnote" name="idm3674"><sup class="footnote">[22]</sup></a>. Per tant, podeu establir un configuració prèvia individual per a cada valor. També podeu especificar l'idioma i el país com a paràmetres d'arrencada. </p>
<div class="informalexample"><pre class="screen"># La configuració prèvia només del «locale» estableix idioma, país i «locale».
d-i debian-installer/locale string ca_ES

# També podeu configurar-los individualment per a major flexibilitat.
#d-i debian-installer/language string ca
#d-i debian-installer/country string ES
#d-i debian-installer/locale string ca_AD.UTF-8
# Podeu especificar altres «locales» a generar.
#d-i localechooser/supported-locales multiselect en_US.UTF-8, nl_NL.UTF-8
</pre></div>
<p>

</p>
<p>La configuració del teclat consisteix en la selecció del mapa de tecles i (per a teclats no llatins) una tecla per canviar entre el mapa de tecles no llati i el mapa de tecles US. Només les variants bàsiques estan disponibles en la instal·lació. Les variants avançades només estan disponibles en el sistema instal·lat, mitjançant l'ordre <span class="command"><strong>dpkg-reconfigure keyboard-configuration</strong></span>. </p>
<div class="informalexample"><pre class="screen"># Selecció del teclat.
d-i keyboard-configuration/xkb-keymap select es
# d-i keyboard-configuration/toggle select No toggling
</pre></div>
<p>

</p>
<p>Per a ometre la configuració prèvia del teclat, empreu <code class="classname">keymap</code> amb <strong class="userinput"><code>skip-config</code></strong>. Això farà que romanga actiu el mapa de teclat del nucli. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-network"></a>B.4.2. Configuració de la xarxa</h3></div></div></div>
<p>Sens dubte, la configuració prèvia de la xarxa no funcionarà si carregueu el fitxer de configuració des de la xarxa. Però va molt bé si esteu carregant-lo des d'un disc òptic o d'una memòria USB. Si ho feu des de la xarxa, podeu indicar-li al nucli els paràmetres d'arrencada de configuració de la xarxa. </p>
<p>Si necessiteu seleccionar una interfície en concret per tal d'arrencar per xarxa abans de carregar un fitxer de configuració prèvia des de la xarxa, useu un paràmetre d'arrencada com <strong class="userinput"><code>interface=<em class="replaceable"><code>eth1</code></em></code></strong>. </p>
<p>Malgrat que normalment la configuració prèvia de la xarxa no es possible quan s'està utilitzant una configuració prèvia (utilitzant <span class="quote">«<span class="quote">preseed/url</span>»</span>), en aquest cas podeu utilitzar el procediment per evitar-ho, per exemple si voleu configurar una adreça estàtica per a la interfície de xarxa. Aquest procediment és per forçar que la configuració de xarxa s'execute altra vegada després de haver carregat el fitxer de preconfiguració escrivint un guió <span class="quote">«<span class="quote">preseed/run</span>»</span> amb les ordres següents: </p>
<div class="informalexample"><pre class="screen">kill-all-dhcp; netcfg
</pre></div>
<p>

</p>
<p>Les variables de «debconf» següents són rellevants per a configuracions de xarxa. </p>
<div class="informalexample"><pre class="screen"># Inhabilita completament la configuració de la xarxa. Açò és útil per a
# instal·lacions de CD-ROM en dispositius sense connexió on les preguntes
# sobre la xarxa, els avisos i els temps d'espera resulten molests.
#d-i netcfg/enable boolean false

# Si és possible, el netcfg escollirà una interfície que tinga un enllaç.
# El següent evita que es mostre una llista si hi ha més d'una interfície.
d-i netcfg/choose_interface select auto

# Si voleu seleccionar una interfície concreta:
#d-i netcfg/choose_interface select eth1

# Per establir un temps d'espera d'enllaç diferent (el valor predeterminat és
# 3 segons). Els valors s'interpreten com a segons.
#d-i netcfg/link_wait_timeout string 10

# Si teniu un servidor dhcp lent i l'instal·lador finalitza l'espera, això
# us pot ser d'utilitat.
#d-i netcfg/dhcp_timeout string 60
#d-i netcfg/dhcpv6_timeout string 60

# Per defecte, la configuració de la xarxa es fa automàticament.
# Si preferiu configurar la xarxa a mà, tragueu-li el comentari a aquesta
# línia i la configuració de la xarxa estàtica que hi ha a continuació.
#d-i netcfg/disable_autoconfig boolean true

# Si voleu que el fitxer de configuració prèvia funcioni en sistemes amb i
# sense servidor dhcp, tragueu-li el comentari a aquestes línies i la
# configuració de la xarxa estàtica que hi ha a continuació.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Configuració de la xarxa estàtica.
#
# IPv4 example
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/confirm_static boolean true
#
# IPv6 example
#d-i netcfg/get_ipaddress string fc00::2
#d-i netcfg/get_netmask string ffff:ffff:ffff:ffff::
#d-i netcfg/get_gateway string fc00::1
#d-i netcfg/get_nameservers string fc00::1
#d-i netcfg/confirm_static boolean true

# Qualsevol nom d'ordinador principal i de domini assignats amb el dhcp tenen
# preferència sobre els valors indicats aquí. Tanmateix, establir aquests
# encara evitarà que es mostren qüestions fins i tot si els valors provenen
# del dhcp.
d-i netcfg/get_hostname string unassigned-hostname
d-i netcfg/get_domain string unassigned-domain

# Si voleu forçar un nom de màquina, independentment de qualsevol dels retornats
# pel servidor DHCP o l'entrada DNS inversa per a la IP, tragueu-li el comentari
# i ajustau la següent línia.
#d-i netcfg/hostname string somehost

# Per deshabilitar el molest diàleg sobre la clau WEP.
d-i netcfg/wireless_wep string
# El fastigós nom del servidor dhcp que alguns ISP empren com a contrasenya.
#d-i netcfg/dhcp_hostname string radish

# Si necessiteu microprogramari no lliure (non-free) per fer funcionar la
# xarxa o altres components, podeu configurar l'instal·lador perquè intenti
# carregar-lo sempre, sense preguntar-ho. O es pot canviar a «false» per
# desactivar la pregunta.
#d-i hw-detect/load_firmware boolean true
</pre></div>
<p>Fixeu-vos que <span class="command"><strong>netcfg</strong></span> determinarà automàticament la màscara de la xarxa si no heu configurat <code class="classname">netcfg/get_netmask</code> prèviament. En aquest cas, en instal·lacions automàtiques, s'ha de marcar la variable com a <code class="literal">seen</code>. De forma similar, <span class="command"><strong>netcfg</strong></span> triarà una adreça apropiada si no definiu <code class="classname">netcfg/get_gateway</code>. Excepcionalment podeu definir <code class="classname">netcfg/get_gateway</code> com a <span class="quote">«<span class="quote">none</span>»</span> per indicar que no s'hauria d'utilitzar cap passarel·la. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-network-console"></a>B.4.3. La consola de xarxa</h3></div></div></div>
<div class="informalexample"><pre class="screen"># Feu servir els paràmetres següents si voleu emprar el component
# «network-console» per a instal·lar remotament mitjançant SSH. Açò només té
# sentit si voleu continuar amb la instal·lació de forma manual.
#d-i anna/choose_modules string network-console
#d-i network-console/authorized_keys_url string http://10.0.0.1/openssh-key
#d-i network-console/password password r00tme
#d-i network-console/password-again password r00tme
</pre></div>
<p>Informació addicional relativa a la consola de xarxa la trobareu a <a class="xref" href="ch06s03.html#network-console" title="6.3.10. Instal·lació a través de la consola de xarxa">Secció 6.3.10, «Instal·lació a través de la consola de xarxa»</a>. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-mirror"></a>B.4.4. Configuració del servidor rèplica</h3></div></div></div>
<p>Segons el mètode d'instal·lació, un servidor rèplica es pot emprar per a descarregar components addicionals de l'instal·lador, per instal·lar el sistema base, i per a configurar el fitxer <code class="filename">/etc/apt/sources.list</code> del sistema instal·lat. </p>
<p>El paràmetre <code class="classname">mirror/suite</code> determina el conjunt de programes del sistema. </p>
<p>El paràmetre <code class="classname">mirror/udeb/suite</code> determina el conjunt de components addicionals que emprarà l'instal·lador. Això només és útil si els components es descarreguen realment des de la xarxa i han de correspondre amb el conjunt d'eines emprat per construir l'«initrd» per al mètode d'instal·lació emprat en la instal·lació. Normalment l'instal·lador escollirà automàticament el valor correcte i no hauria de ser necessari establir aquest paràmetre. </p>
<div class="informalexample"><pre class="screen"># Protocol del mirall:
# Si seleccioneu ftp, no cal definir la cadena mirror/country.
# Valor per defecte pel protocol del mirall: http.
#d-i mirror/protocol string ftp
d-i mirror/country string manual
d-i mirror/http/hostname string ftp.es.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Conjunt de programes que s'instal·larà.
#d-i mirror/suite string testing
# Conjunt de programes que s'emprarà per a carregar components de l'instal·lador
# (opcional).
#d-i mirror/udeb/suite string testing
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-account"></a>B.4.5. Configuració de comptes</h3></div></div></div>
<p>Es poden configurar prèviament el compte del superusuari i el nom i la contrasenya d'un usuari ordinari. Les contrasenyes es poden indicar bé de manera explícita o bé en forma de <span class="emphasis"><em>resums</em></span> MD5. </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Avís]" src="images/warning.png"></td>
<th align="left">Avís</th>
</tr>
<tr><td align="left" valign="top"><p>Sigueu conscients que la configuració prèvia de contrasenyes no és completament segura ja que qualsevol persona amb accés al fitxer de configuració prèvia les podrà saber. L'emmagatzematge de contrasenyes amb una funció resum es considera segura a menys que es faci servir un algorisme feble com DES o MD5, que permeten atacs per força bruta. Els algorismes de funció resum recomanats son SHA-256 i SHA512. </p></td></tr>
</table></div>
<div class="informalexample"><pre class="screen"># No generar el compte de superusuari (l'usuari normal haurà de ser capaç
# d'utilitzar «sudo»).
#d-i passwd/root-login boolean false
# De forma alternativa, per no generar el compte d'usuari normal.
#d-i passwd/make-user boolean false

# Contrasenya de superusuari, ben explícita
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# o bé xifrada fent servir una funció resum crypt(3).
#d-i passwd/root-password-crypted password [crypt(3) hash]

# Per generar un compte d'usuari normal.
#d-i passwd/user-fullname string Usuari de Debian
#d-i passwd/username string debian
# Contrasenya de l'usuari normal, bé explícita
#d-i passwd/user-password password insecure
#d-i passwd/user-password-again password insecure
# o bé xifrada fent servir un capolament crypt(3).
#d-i passwd/user-password-crypted password [crypt(3) hash]
# Genera el primer usuari amb el UID donat en comptes del predeterminat.
#d-i passwd/user-uid string 1010

# El compte d'usuari s'afegirà a algun dels grups estàndard inicials. Per
# a substituir-ho, utilitzeu açò.
#d-i passwd/user-default-groups string audio cdrom video
</pre></div>
<p>Les variables <code class="classname">passwd/root-password-crypted</code> i <code class="classname">passwd/user-password-crypted</code> també es poden configurar prèviament posant <span class="quote">«<span class="quote">!</span>»</span> com a valor. En aquest cas, el compte corresponent es deshabilitarà. Això pot ser convenient per al compte de superusuari en cas que, evidentment, s'haja establert un altre mètode per permetre les tasques d'administració o per entrar com a superusuari (per exemple fent servir l'autenticació de la clau SSH o el <span class="command"><strong>sudo</strong></span>). </p>
<p>La següent ordre (disponible al paquet <code class="classname">whois</code>) es pot fer servir per generar una contrasenya SHA-512 basada en la funció resum «crypt(3)»: </p>
<div class="informalexample"><pre class="screen">mkpasswd -m sha-512
</pre></div>
<p>

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-time"></a>B.4.6. Configuració del rellotge i del fus horari</h3></div></div></div>
<div class="informalexample"><pre class="screen"># Controla si el rellotge està o no fixat a UTC.
d-i clock-setup/utc boolean true

# Podeu donar-li qualsevol valor vàlid per $TZ; vegeu el contingut de
# /usr/share/zoneinfo/ per als valors vàlids.
d-i time/zone string US/Eastern

# Controla si s'utilitza NTP per posar en hora el rellotge a la instal·lació.
d-i clock-setup/ntp boolean true
# Quin servidor d'NTP s'utilitzarà. El que hi ha per defecte quasi sempre és bo.
#d-i clock-setup/ntp-server string ntp.example.com
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-partman"></a>B.4.7. Fer particions</h3></div></div></div>
<p>La configuració prèvia per fer particions de discs durs està limitada per les possibilitats oferides pel <code class="classname">partman-auto</code>. Podeu o bé partir l'espai lliure existent al disc o bé el disc sencer. La distribució del disc es pot determinar fent servir una recepta definida prèviament, una de personalitzada procedent d'un fitxer recepta, o una inclosa dins els fitxers de configuració prèvia. </p>
<p>Es poden generar configuracions prèvies amb RAID, LVM i xifrat, però no amb tota la flexibilitat possible de creació de particions que ofereix una instal·lació no preconfigurada. </p>
<p>Els exemples de sota només proporcionen informació bàsica de l'ús de receptes. Per a una informació detallada consulteu els fitxers <code class="filename">partman-auto-recipe.txt</code> i <code class="filename">partman-auto-raid-recipe.txt</code>, inclosos al paquet <code class="classname">debian-installer</code>. Tots dos fitxers també es troben disponibles al <a class="ulink" href="https://salsa.debian.org/installer-team/debian-installer/tree/master/doc/devel" target="_top">repositori de fonts de <code class="classname">debian-installer</code></a>. Adoneu-vos que la funcionalitat disponible pot canviar d'una versió a una altra. </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Avís]" src="images/warning.png"></td>
<th align="left">Avís</th>
</tr>
<tr><td align="left" valign="top"><p>La identificació dels discs depèn de l'ordre en què es carreguen llurs controladors. Si el sistema té més d'un disc, assegureu-vos que se seleccione el correcte abans d'utilitzar la configuració prèvia. </p></td></tr>
</table></div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="preseed-partman-example"></a>B.4.7.1. Exemple de particions</h4></div></div></div>
<div class="informalexample"><pre class="screen"># Si el sistema té espai lliure podeu fer la partició només d'aquest espai. 
# Això només passarà si «partman-auto/method» no està habilitat (a sota).
#d-i partman-auto/init_automatically_partition select biggest_free

# També podeu especificar el disc que es partirà. Si el sistema només té
# un disc, l'instal·lador l'emprarà per defecte, altrament cal que indiqueu
# el dispositiu en el format tradicional, no en el de «devfs» (per exemple,
# «/dev/sda» en lloc de «/dev/discs/disc0/disc»).
# Per exemple, per emprar el primer disc SCSI/SATA:
#d-i partman-auto/disk string /dev/sda
# Addicionalment, haureu d'especificar el mètode a utilitzar.
# Els mètodes disponibles actualment són:
# - regular: empra el tipus de partició típics de l'arquitectura
# - lvm:     empra LVM per a partir el disc
# - crypto:  empra LVM a dins d'una partició xifrada
d-i partman-auto/method string lvm

# Podeu definit la quantitat d'espai que s'usarà per al grup del volum 
# LVM. Pot ser o bé la mida amb la unitat (p.ex. 20 GB), un percentatge de
# l'espai lliure o la paraula clau 'max'.
d-i partman-auto-lvm/guided_size string max

# Si un dels discs que s'ha de partir automàticament conté una
# configuració LVM antiga, l'usuari rebrà un avís. Això es pot
# desactivar amb una configuració prèvia...
d-i partman-lvm/device_remove_lvm boolean true
# El mateix és aplicable a RAID per programari ja existent:
d-i partman-md/device_remove_md boolean true
# I el mateix per a la confirmació d'escriptura a particions «lvm».
d-i partman-lvm/confirm boolean true
d-i partman-lvm/confirm_nooverwrite boolean true

# Podeu triar un dels tres tipus de partició predefinits:
# - atomic: tots els fitxers en una partició
# - home:   partició «/home» separada
# - multi:  particions «/home», «/usr», «/var» i «/tmp» separades
d-i partman-auto/choose_recipe select atomic

# O indicar-ne una pròpia...
# Si podeu obtenir un fitxer de recepta per a l'entorn de l'instal·lador,
# podeu simplement apuntar-hi.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# Si no, podeu posar una recepta sencera en una línia (lògica). Aquest exemple
# genera una petita partició «/boot», un espai d'intercanvi adient, i empra la
# resta de l'espai per a la partició arrel:
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# El format complet de les receptes es troba documentat al fitxer
# «partman-auto-recipe.txt» inclós al paquet «debian-installer» i disponible
# al repositori de fonts de l'instal·lador. També s'hi documenta com
# especificar paràmetres com etiquetes per als sistemes de fitxers, noms
# per als grups de volum i quins dispositius incloure en un grup de volum.

## Particionar per a EFI
# Si el vostre sistema necessita una partició EFI podeu afegir quelcom semblant
# a això a la recepta anterior, com el primer element de la recepta:
#               538 538 1075 free                              \
#                      $iflabel{ gpt }                         \
#                      $reusemethod{ }                         \
#                      method{ efi }                           \
#                      format{ }                               \
#               .                                              \
#
# El fragment anterior és per a l'arquitectura amd64; els detalls poden ser 
# diferents en altres arquitectures. El paquet 'partman-auto' del repositori
# font del D-I pot tenir algun exemple a seguir.

# Això fa que el «partman» particioni automàticament sense demanar confirmació,
# amb la condició que haguéssiu dit d'utilitzar un dels mètodes de dalt.
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

# Forçar l'engegada UEFI (la 'compatibilitat BIOS' es perdrà). Per defecte: false.
#d-i partman-efi/non_efi_system boolean true
# Assegurar que la taula de particions és GPT - això és requerit per EFI
#d-i partman-partitioning/choose_label select gpt
#d-i partman-partitioning/default_label string gpt

# Quan s'habilita el xifrat de disc, ometi esborrar les particions per endavant.
#d-i partman-auto-crypto/erase_disks boolean false
</pre></div>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="preseed-partman-raid"></a>B.4.7.2. Fer particions amb RAID</h4></div></div></div>
<p>També podeu utilitzar la configuració prèvia per configurar les particions a una matriu RAID per programari. Els nivells de RAID suportats són 0, 1, 5, 6 i 10, creant matrius degradades i especificant els dispositius de reemplaçament. </p>
<p>Si esteu fent ús de RAID 1, podeu fer la configuració prèvia de «grub» per instal·lar tots els dispositius que s'utilitzen a la matriu; vegeu <a class="xref" href="apbs04.html#preseed-bootloader" title="B.4.11. Instal·lació del carregador d'arrencada">Secció B.4.11, «Instal·lació del carregador d'arrencada»</a>. </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Avís]" src="images/warning.png"></td>
<th align="left">Avís</th>
</tr>
<tr><td align="left" valign="top"><p>És molt fàcil equivocar-se en aquest tipus de partició automatitzada. A més es tracta d'una funcionalitat que no rep molta atenció per part dels desenvolupadors del <code class="classname">debian-installer</code>. La responsabilitat d'aconseguir les receptes correctes (de forma que tinguin sentit i no entren en conflicte) recau en l'usuari. Comproveu el fitxer <code class="filename">/var/log/syslog</code> si teniu algun problema. </p></td></tr>
</table></div>
<div class="informalexample"><pre class="screen"># A «method» se li hauria de donar el valor "raid".
#d-i partman-auto/method string raid
# Especifica quins discs s'han de partir. Tots acabaran amb la
# mateixa disposició, per tant tan sols funcionarà si els discs tenen
# la mateixa mida.
#d-i partman-auto/disk string /dev/sda /dev/sdb

# A continuació necessiteu especificar quines particions físiques
# s'utilitzaran.
#d-i partman-auto/expert_recipe string \
#      multiraid ::                                         \
#              1000 5000 4000 raid                          \
#                      $primary{ } method{ raid }           \
#              .                                            \
#              64 512 300% raid                             \
#                      method{ raid }                       \
#              .                                            \
#              500 10000 1000000000 raid                    \
#                      method{ raid }                       \
#              .

# Per acabar necessiteu especificar com s'utilitzaran les particions
# prèviament definides a la configuració del RAID. Recordeu d'utilitzar
# els números de partició correctes per particions lògiques. S'admeten
# els nivells RAID 0, 1, 5, 6 i 10, separant-ne els dispositius amb «#».
# Els paràmetres són:
# &lt;raidtype&gt; &lt;devcount&gt; &lt;sparecount&gt; &lt;fstype&gt; &lt;mountpoint&gt; \
#          &lt;devices&gt; &lt;sparedevices&gt;

#d-i partman-auto-raid/recipe string \
#    1 2 0 ext3 /                    \
#          /dev/sda1#/dev/sdb1       \
#    .                               \
#    1 2 0 swap -                    \
#          /dev/sda5#/dev/sdb5       \
#    .                               \
#    0 2 0 ext3 /home                \
#          /dev/sda6#/dev/sdb6       \
#    .

# Per a més informació vegeu el fitxer «partman-auto-raid-recipe.txt»
# inclós al paquet «debian-installer» i disponible al repositori de fonts
# de l'instal·lador.

# Açò fa que el «partman» particioni automàticament sense demanar confirmació.
d-i partman-md/confirm boolean true
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true
</pre></div>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="preseed-partman-mount-styles"></a>B.4.7.3. Com controlar el muntatge de les particions</h4></div></div></div>
<p>Normalment, els sistemes de fitxers es munten emprant un identificador universalment únic (UUID) com a clau, el que permet que siguen muntats correctament encara que canvien els seus noms de dispositiu. Els UUID són llargs i difícils de llegir, així que l'instal·lador vos permet muntar els sistemes de fitxers basant-se en noms de dispositiu tradicionals o en etiquetes que els assigneu. Si demaneu a l'instal·lador que munte per etiquetes, els sistemes de fitxers que no en tinguen seran muntats pel seu UUID. </p>
<p>Els dispositius amb noms estables, com els volums lògics LVM, continuaran emprant llurs noms tradicionals en lloc de l'UUID. </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Avís]" src="images/warning.png"></td>
<th align="left">Avís</th>
</tr>
<tr><td align="left" valign="top"><p>Els noms tradicionals de dispositiu poden canviar amb l'ordre en què el nucli descobreix els dispositius en arrencar, causant que es munte el sistema de fitxers que no toca. De forma similar, es possible que les etiquetes coincidesquen en connectar un disc nou o una unitat USB, i aleshores el comportament del vostre sistema en arrencar serà aleatori. </p></td></tr>
</table></div>
<div class="informalexample"><pre class="screen"># Per defecte es munta per UUID, però també podeu escollir «traditional»
# per a emprar noms tradicionals de dispositiu, o «label» per a provar amb
# les etiquetes dels sistemes de fitxers abans de recórrer a llurs UUID.
#d-i partman/mount_style select uuid
</pre></div>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-base-installer"></a>B.4.8. Instal·lació del sistema base</h3></div></div></div>
<p>No hi ha moltes coses que es puguin configurar prèviament en aquesta etapa de la instal·lació. Les úniques preguntes que hi ha fan referència a la instal·lació del nucli. </p>
<div class="informalexample"><pre class="screen"># Configura APT per a no instal·lar per defecte els paquets recomanats.
# L'ús d'aquesta opció pot resultar en un sistema incomplet i només ha de
# ser emprada per usuaris molt experimentats.
#d-i base-installer/install-recommends boolean false

# El (meta) paquet de la imatge del nucli a instal·lar; es pot utilitzar
# "none" si no es vol instal·lar cap nucli.
#d-i base-installer/kernel/image string linux-image-686
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-apt"></a>B.4.9. Configuració de l'«apt»</h3></div></div></div>
<p>La configuració del fitxer <code class="filename">/etc/apt/sources.list</code> i les opcions bàsiques de configuració estan completament automatitzades segons el mètode d'instal·lació emprat i les respostes a les preguntes prèvies. Opcionalment podeu afegir altres repositoris (locals). </p>
<div class="informalexample"><pre class="screen"># Choose, if you want to scan additional installation media
# (default: false).
d-i apt-setup/cdrom/set-first boolean false
# You can choose to install non-free and contrib software.
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Uncomment the following line, if you don't want to have the sources.list
# entry for a DVD/BD installation image active in the installed system
# (entries for netinst or CD images will be disabled anyway, regardless of
# this setting).
#d-i apt-setup/disable-cdrom-entries boolean true
# Uncomment this if you don't want to use a network mirror.
#d-i apt-setup/use_mirror boolean false
# Select which update services to use; define the mirrors to be used.
# Values shown below are the normal defaults.
#d-i apt-setup/services-select multiselect security, updates
#d-i apt-setup/security_host string security.debian.org

# Additional repositories, local[0-9] available
#d-i apt-setup/local0/repository string \
#       http://local.server/debian stable main
#d-i apt-setup/local0/comment string local server
# Enable deb-src lines
#d-i apt-setup/local0/source boolean true
# URL to the public key of the local repository; you must provide a key or
# apt will complain about the unauthenticated repository and so the
# sources.list line will be left commented out.
#d-i apt-setup/local0/key string http://local.server/key
# If the provided key file ends in ".asc" the key file needs to be an
# ASCII-armoured PGP key, if it ends in ".gpg" it needs to use the
# "GPG key public keyring" format, the "keybox database" format is
# currently not supported.

# By default the installer requires that repositories be authenticated
# using a known gpg key. This setting can be used to disable that
# authentication. Warning: Insecure, not recommended.
#d-i debian-installer/allow_unauthenticated boolean true

# Uncomment this to add multiarch configuration for i386
#d-i apt-setup/multiarch string i386

</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-pkgsel"></a>B.4.10. Selecció de paquets</h3></div></div></div>
<p>Podeu instal·lar qualsevol combinació de tasques que hi haja a l'abast. En aquest moment les tasques que hi ha són: </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p><strong class="userinput"><code>standard</code></strong> (eines estàndard) </p></li>
<li class="listitem"><p><strong class="userinput"><code>desktop</code></strong> (escriptori gràfic) </p></li>
<li class="listitem"><p><strong class="userinput"><code>gnome-desktop</code></strong> (escriptori Gnome) </p></li>
<li class="listitem"><p><strong class="userinput"><code>xfce-desktop</code></strong> (escriptori XFCE) </p></li>
<li class="listitem"><p><strong class="userinput"><code>kde-desktop</code></strong> (escriptori KDE Plasma) </p></li>
<li class="listitem"><p><strong class="userinput"><code>cinnamon-desktop</code></strong> (escriptori Cinnamon) </p></li>
<li class="listitem"><p><strong class="userinput"><code>mate-desktop</code></strong> (escriptori MATE) </p></li>
<li class="listitem"><p><strong class="userinput"><code>lxde-desktop</code></strong> (escriptori LXDE) </p></li>
<li class="listitem"><p><strong class="userinput"><code>web-server</code></strong> (servidor web) </p></li>
<li class="listitem"><p><strong class="userinput"><code>ssh-server</code></strong> (SSH server) </p></li>
</ul></div>
<p>Podeu també no instal·lar cap tasca i forçar la instal·lació d'un conjunt de paquets d'alguna altra manera. És recomanable incloure sempre la tasca <strong class="userinput"><code>standard</code></strong>. </p>
<p>O en el cas que no vulgueu que es mostri el diàleg del tasksel, afegiu <code class="classname">pkgsel/run_tasksel</code> al «preseed» (en aquest cas, no s'instal·larà cap paquet via tasksel). </p>
<p>Si voleu instal·lar alguns paquets de forma individual a més a més dels instal·lats per tasques, podeu utilitzar el paràmetre <code class="classname">pkgsel/include</code>. El valor d'aquest paràmetre pot ser una llista de paquets separats o bé per comes o bé per espais, que el podeu utilitzar de forma senzilla a la línia d'ordres del nucli. </p>
<div class="informalexample"><pre class="screen">#tasksel tasksel/first multiselect standard, web-server, kde-desktop

# O opteu perquè no es mostri el diàleg del tasksel (i que no 
# s'instal·li cap paquet):
#d-i pkgsel/run_tasksel boolean false

# Paquets addicionals per instal·lar individualment
#d-i pkgsel/include string openssh-server build-essential
# Actualització dels paquets després del debootstrap.
# Valors permesos: none, safe-upgrade, full-upgrade
#d-i pkgsel/upgrade select none

# Podeu triar si el vostre sistema enviarà informes sobre el programari
# que heu instal·lat, i els programes que feu servir. Per defecte no
# s'envia res, però fer-ho ajuda al projecte a determinar quins programes
# són els més populars i que s'haurien d'incloure al primer CD/DVD.
#popularity-contest popularity-contest/participate boolean false
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-bootloader"></a>B.4.11. Instal·lació del carregador d'arrencada</h3></div></div></div>
<div class="informalexample"><pre class="screen"><span class="phrase"># El Grub és el carregador predeterminat (per a x86). </span>

# Això, que és força segur de fer, fa que el «grub» s'instal·li automàticament a
# la partició UEFI/sector d'arrencada si no es detecta cap altre sistema
# operatiu a la màquina.
d-i grub-installer/only_debian boolean true

# Aquesta fa que «grub-installer» instal·li a la partició UEFI/sector
# d'arrencada, si també troba algun altre SO, que és menys segur, ja que
# podria no ser capaç d'arrencar l'altre SO.
d-i grub-installer/with_other_os boolean true

# Donada la notable intencionalitat de les memòries USB, la localització de
# la unitat principal no es pot determinar amb seguretat en general, per això
# cal especificar el següent:
#d-i grub-installer/bootdev  string /dev/sda
# Per instal·lar en el primer dispositiu (assumint que no és una memòria USB):
#d-i grub-installer/bootdev  string default

# Com alternativa, si voleu instal·lar-lo a un lloc diferent de la partició
# UEFI/sector d'arrencada, elimineu el comentari i editeu aquestes línies:
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
#d-i grub-installer/bootdev  string (hd0,1)
# Per instal·lar el «grub» a més d'un disc:
#d-i grub-installer/bootdev  string (hd0,1) (hd1,1) (hd2,1)

# Contrasenya opcional pel «grub», en text pla
#d-i grub-installer/password password r00tme
#d-i grub-installer/password-again password r00tme
# o utilitzant xifrat amb una funció resum MD5, vegeu «grub-md5-crypt(8)».
#d-i grub-installer/password-crypted password [MD5 hash]

# Empreu l'opció següent per a afegir paràmetres d'arrencada addicionals
# per al sistema instal·lat (si l'instal·lador del carregador els admet).
# Nota: s'hi afegiran automàticament les opcions passades a l'instal·lador.
#d-i debian-installer/add-kernel-opts string nousb
</pre></div>
<p>Un resum MD5 per a una contrasenya de <code class="classname">grub</code> es pot generar utilitzant <span class="command"><strong>grub-md5-crypt</strong></span>, o utilitzant l'exemple que hi ha a <a class="xref" href="apbs04.html#preseed-account" title="B.4.5. Configuració de comptes">Secció B.4.5, «Configuració de comptes»</a>. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-finish"></a>B.4.12. Finalització de la instal·lació</h3></div></div></div>
<div class="informalexample"><pre class="screen"># Durant la instal·lació des de consola sèrie, les consoles virtuals habituals
# (VT1-VT6) normalment queden inhabilitades a «/etc/inittab». Descomenteu la
# línia següent per evitar-ho.
#d-i finish-install/keep-consoles boolean true

# Evita el darrer missatge de la instal·lació que apareix indicant-ne l'estat
# complet.
d-i finish-install/reboot_in_progress note

# Això evita que l'instal·lador expulse el CD quan es torna a arrencar, la
# qual cosa és útil en algunes situacions.
#d-i cdrom-detect/eject boolean false

# Açò farà que l'instal·lador aturi la màquina quan acabe, però que no es
# reinicie al sistema instal·lat.
#d-i debian-installer/exit/halt boolean true
# Això apagarà la màquina del tot en comptes de només aturar-la.
#d-i debian-installer/exit/poweroff boolean true
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-other"></a>B.4.13. Configuració prèvia d'altres paquets</h3></div></div></div>
<div class="informalexample"><pre class="screen"># Segons el programari instal·lat, o si les coses van malament durant el
# procés d'instal·lació, és possible rebre preguntes sobre altres qüestions.
# També podeu fer-ne una configuració prèvia. Per obtenir una llista de
# totes les preguntes que es poden fer durant la instal·lació, feu una
# instal·lació, i després executeu aquestes ordres:
#   debconf-get-selections --installer &gt; file
#   debconf-get-selections &gt;&gt; file
</pre></div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div id="ftn.idm3674" class="footnote"><p><a href="#idm3674" class="para"><sup class="para">[22] </sup></a>Per exemple, configurar prèviament <code class="literal">locale</code> a <strong class="userinput"><code>ca_ES</code></strong> convertiria <code class="literal">ca_ES.UTF-8</code> en el «locale» per defecte del sistema instal·lat. Si per exemple preferiu <code class="literal">ca_AD.UTF-8</code> al seu lloc, haureu d'establir una configuració prèvia individual per a cada valor.</p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="apbs03.html"><img src="images/prev.png" alt="Anterior"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="apb.html"><img src="images/up.png" alt="Pujar"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="apbs05.html"><img src="images/next.png" alt="Següent"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">B.3. Preparar un fitxer de configuració prèvia </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Inici"></a></td>
<td width="40%" align="right" valign="top"> B.5. Opcions avançades</td>
</tr>
</table>
</div>
</body>
</html>
